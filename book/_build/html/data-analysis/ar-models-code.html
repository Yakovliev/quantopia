
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Identifying the Order ‘p’: Using Statistical Tools &#8212; Quantopia&#39;:&#39; Physics, Python and Pi</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'data-analysis/ar-models-code';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Quantopia':' Physics, Python and Pi - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Quantopia':' Physics, Python and Pi - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Quantopia: Physics, Python, and Pi (Alpha Version)
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">MATH</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../math/gradient-operator.html">Gradient</a></li>
<li class="toctree-l1"><a class="reference internal" href="../math/gradient-directional-derivative.html">Directional Derivative</a></li>
<li class="toctree-l1"><a class="reference internal" href="../math/divergence.html">Divergence</a></li>
<li class="toctree-l1"><a class="reference internal" href="../math/fourier-transform-01.html">Fourier Transform</a></li>
<li class="toctree-l1"><a class="reference internal" href="../math/uncertainties-introduction.html">Experimental Errors and Significant Figures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../math/least-squares-regression.html">Least Squares Regression, RSS, RMSE, R-squared</a></li>
<li class="toctree-l1"><a class="reference internal" href="../math/least-squares-regression-code.html">Least Squares Regression - Code Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../math/ordinary-least-squares.html">Ordinary Least Squares (OLS) Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="../math/ordinary-least-squares-code.html">Ordinary Least Squares (OLS) Regression - Code Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../math/variance-covariance.html">Variance and Covariance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../math/variance-covariance-code.html">Variance and Covariance - Code Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../math/correlation-coefficients.html">Correlation Coefficients</a></li>
<li class="toctree-l1"><a class="reference internal" href="../math/correlation-coefficients-code.html">Correlation Coefficients - Code Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../math/weighted-least-squares.html">Weighted Least Squares</a></li>
<li class="toctree-l1"><a class="reference internal" href="../math/weighted-least-squares-code-1.html">WLS - Code Examples Part 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../math/weighted-least-squares-code-2.html">WLS - Code Examples Part 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../math/goodness-of-fit-and-chi-squared.html">Goodness of Fit and Chi-Squared Statistic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../math/aic-and-bic.html">Akaike Information Criterion (AIC) and Bayesian Information Criterion (BIC)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../math/weighted-least-squares-code-3.html">WLS - Code Examples Part 3</a></li>
<li class="toctree-l1"><a class="reference internal" href="../math/orthogonal-distance-regression.html">Orthogonal Distance Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="../math/odr-code.html">ODR - Code Examples</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">PHYSICS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../physics/continuity-equation-01.html">The Continuity Equation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../physics/continuity-equation-02.html">The Continuity Equation: One-Dimensional Advection of a Density Profile</a></li>
<li class="toctree-l1"><a class="reference internal" href="../physics/ensemble.html">Statistical Ensembles and Liouville’s Theorem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../physics/microcanonical-ensemble.html">Microcanonical Ensemble</a></li>
<li class="toctree-l1"><a class="reference internal" href="../physics/inertial_vs_gravitational_mass.html">Mass: Inertial vs. Gravitational</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">DATA ANALYSIS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="rate-of-return-metrics.html">Advanced Rate of Return Metrics (IRR, XIRR, MIRR, XMIRR, PV, FV, NPV, XNPV)</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/Yakovliev/quantopia/blob/main/book/data-analysis/ar-models-code.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/Yakovliev/quantopia" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/Yakovliev/quantopia/issues/new?title=Issue%20on%20page%20%2Fdata-analysis/ar-models-code.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/data-analysis/ar-models-code.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Identifying the Order ‘p’: Using Statistical Tools</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Identifying the Order ‘p’: Using Statistical Tools</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-autocorrelation-function-acf">The Autocorrelation Function (ACF)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-partial-autocorrelation-function-pacf-the-key-identifier">The Partial Autocorrelation Function (PACF): The Key Identifier</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#putting-it-all-together-a-practical-python-example">Putting It All Together: A Practical Python Example</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-generating-synthetic-ar-2-data">Step 1: Generating Synthetic AR(2) Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-visualizing-the-data">Step 2: Visualizing the Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-analyzing-acf-and-pacf-plots">Step 3: Analyzing ACF and PACF Plots</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-4-fitting-the-ar-model-with-statsmodels">Step 4: Fitting the AR Model with <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code></a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="identifying-the-order-p-using-statistical-tools">
<h1>Identifying the Order ‘p’: Using Statistical Tools<a class="headerlink" href="#identifying-the-order-p-using-statistical-tools" title="Link to this heading">#</a></h1>
<p>We now know what an AR(p) model is, but a critical question remains: <strong>How do we choose the order <code class="docutils literal notranslate"><span class="pre">p</span></code>?</strong> Do we look back 1 step, 5 steps, 10 steps?</p>
<p>Simply guessing is not a good strategy. Instead, we use statistical tools that analyze the correlation structure of the time series. The two most important tools are the Autocorrelation Function (ACF) and the Partial Autocorrelation Function (PACF).</p>
<section id="the-autocorrelation-function-acf">
<h2>The Autocorrelation Function (ACF)<a class="headerlink" href="#the-autocorrelation-function-acf" title="Link to this heading">#</a></h2>
<p>The ACF measures the correlation between a time series and its lagged versions. The ACF at lag <span class="math notranslate nohighlight">\(k\)</span> is the correlation between <span class="math notranslate nohighlight">\(Y_t\)</span> and <span class="math notranslate nohighlight">\(Y_{t-k}\)</span>.</p>
<p>For an AR(p) process, the ACF will show a <strong>gradual decay</strong>. Why? Because <span class="math notranslate nohighlight">\(Y_t\)</span> is directly influenced by <span class="math notranslate nohighlight">\(Y_{t-1}\)</span>, which is influenced by <span class="math notranslate nohighlight">\(Y_{t-2}\)</span>, and so on. This creates an indirect chain of correlations that fades out slowly. For example, in an AR(1) model, <span class="math notranslate nohighlight">\(\text{Corr}(Y_t, Y_{t-k}) = \phi_1^k\)</span>. Since <span class="math notranslate nohighlight">\(|\phi_1|&lt;1\)</span>, this correlation decays exponentially to zero as <span class="math notranslate nohighlight">\(k\)</span> increases.</p>
<p>While the ACF is useful, its slow decay makes it hard to pinpoint the exact order <code class="docutils literal notranslate"><span class="pre">p</span></code>. This is where the PACF comes in.</p>
</section>
<section id="the-partial-autocorrelation-function-pacf-the-key-identifier">
<h2>The Partial Autocorrelation Function (PACF): The Key Identifier<a class="headerlink" href="#the-partial-autocorrelation-function-pacf-the-key-identifier" title="Link to this heading">#</a></h2>
<p>The PACF gives us the <strong>direct relationship</strong> between <span class="math notranslate nohighlight">\(Y_t\)</span> and <span class="math notranslate nohighlight">\(Y_{t-k}\)</span>, after removing the influence of the intermediate lags (<span class="math notranslate nohighlight">\(Y_{t-1}, Y_{t-2}, \dots, Y_{t-k+1}\)</span>).</p>
<p><strong>Analogy:</strong> Imagine we want to measure the influence of your grandparents’ genetics on you.</p>
<ul class="simple">
<li><p>The <strong>ACF</strong> is like measuring the total similarity, which includes the genes passed through your parents.</p></li>
<li><p>The <strong>PACF</strong> is like measuring the <em>direct</em> genetic influence of your grandparents, after statistically removing the part that already came through your parents.</p></li>
</ul>
<p>This ability to isolate the direct effect is exactly what we need. For an <strong>AR(p) model</strong>, the PACF has a very distinct signature:</p>
<blockquote>
<div><p>For a pure AR(p) process, the PACF will be statistically significant for the first <code class="docutils literal notranslate"><span class="pre">p</span></code> lags and then will <strong>cut off sharply</strong> to zero for all subsequent lags.</p>
</div></blockquote>
<p>This is because, by definition, an AR(p) model says that <span class="math notranslate nohighlight">\(Y_t\)</span> is directly influenced only by its first <code class="docutils literal notranslate"><span class="pre">p</span></code> lags. The influence of <span class="math notranslate nohighlight">\(Y_{t-p-1}\)</span> on <span class="math notranslate nohighlight">\(Y_t\)</span> is already fully captured through <span class="math notranslate nohighlight">\(Y_{t-1}, \dots, Y_{t-p}\)</span>.</p>
<p>Therefore, to identify the order <code class="docutils literal notranslate"><span class="pre">p</span></code>, we will generate a PACF plot and look for the lag at which it cuts off.</p>
</section>
</section>
<section id="putting-it-all-together-a-practical-python-example">
<h1>Putting It All Together: A Practical Python Example<a class="headerlink" href="#putting-it-all-together-a-practical-python-example" title="Link to this heading">#</a></h1>
<p>Let’s make these concepts concrete with Python. We will use the <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code> library, a powerhouse for statistical modeling in Python, and <code class="docutils literal notranslate"><span class="pre">numpy</span></code> for data generation.</p>
<p>First, let’s ensure we have the necessary libraries installed.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>numpy<span class="w"> </span>pandas<span class="w"> </span>matplotlib<span class="w"> </span>statsmodels
</pre></div>
</div>
<section id="step-1-generating-synthetic-ar-2-data">
<h2>Step 1: Generating Synthetic AR(2) Data<a class="headerlink" href="#step-1-generating-synthetic-ar-2-data" title="Link to this heading">#</a></h2>
<p>The best way to learn is to work with data where we know the true underlying process. Let’s create a synthetic AR(2) process. Our model will be:</p>
<div class="math notranslate nohighlight">
\[Y_t = 0.6 Y_{t-1} + 0.3 Y_{t-2} + \epsilon_t\]</div>
<p>Here, the true order is <span class="math notranslate nohighlight">\(p=2\)</span>, with <span class="math notranslate nohighlight">\(\phi_1 = 0.6\)</span> and <span class="math notranslate nohighlight">\(\phi_2 = 0.3\)</span>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.graphics.tsaplots</span><span class="w"> </span><span class="kn">import</span> <span class="n">plot_acf</span><span class="p">,</span> <span class="n">plot_pacf</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.tsa.arima_process</span><span class="w"> </span><span class="kn">import</span> <span class="n">ArmaProcess</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.tsa.ar_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">AutoReg</span>

<span class="c1"># Set a seed for reproducibility</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Define the AR(2) process coefficients</span>
<span class="c1"># The first element is for the AR(0) term (always 1)</span>
<span class="c1"># The next elements are the phi coefficients with a negative sign</span>
<span class="n">ar_coeffs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">]</span>
<span class="c1"># The MA coefficients are [1] as it&#39;s a pure AR process</span>
<span class="n">ma_coeffs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># Create the ArmaProcess</span>
<span class="n">ar_process</span> <span class="o">=</span> <span class="n">ArmaProcess</span><span class="p">(</span><span class="n">ar_coeffs</span><span class="p">,</span> <span class="n">ma_coeffs</span><span class="p">)</span>

<span class="c1"># Generate 500 data points from the process</span>
<span class="n">n_samples</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">ar_process</span><span class="o">.</span><span class="n">generate_sample</span><span class="p">(</span><span class="n">nsample</span><span class="o">=</span><span class="n">n_samples</span><span class="p">)</span>

<span class="c1"># Create a pandas Series for easier handling</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Synthetic AR(2) data generated.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="step-2-visualizing-the-data">
<h2>Step 2: Visualizing the Data<a class="headerlink" href="#step-2-visualizing-the-data" title="Link to this heading">#</a></h2>
<p>It’s always a good practice to plot the time series first to get a feel for its behavior.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the generated time series</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Synthetic AR(2) Time Series&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Value&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>You should see a series that fluctuates around a mean of zero, which is characteristic of a stationary process.</p>
</section>
<section id="step-3-analyzing-acf-and-pacf-plots">
<h2>Step 3: Analyzing ACF and PACF Plots<a class="headerlink" href="#step-3-analyzing-acf-and-pacf-plots" title="Link to this heading">#</a></h2>
<p>Now, let’s use the ACF and PACF plots to see if we can correctly identify the order <span class="math notranslate nohighlight">\(p=2\)</span>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a figure with two subplots</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="c1"># Plot the ACF</span>
<span class="n">plot_acf</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Autocorrelation Function (ACF)&#39;</span><span class="p">)</span>

<span class="c1"># Plot the PACF</span>
<span class="n">plot_pacf</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Partial Autocorrelation Function (PACF)&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>When you run this code, you will see two plots:</p>
<ol class="arabic simple">
<li><p><strong>ACF Plot</strong>: You will observe that the correlations start high and <strong>decay gradually</strong>. This tells us that an AR model is likely appropriate. The pattern is a mix of exponential decay and sine-wave, which is common for AR(p) processes where <span class="math notranslate nohighlight">\(p&gt;1\)</span>.</p></li>
<li><p><strong>PACF Plot</strong>: Here is the key! You will see two significant spikes at lag 1 and lag 2. After lag 2, the correlations <strong>cut off sharply</strong> and fall within the blue shaded area (the confidence interval). This is the classic signature of an AR(2) process.</p></li>
</ol>
<p>The PACF plot clearly tells us that we should choose <span class="math notranslate nohighlight">\(p=2\)</span>.</p>
</section>
<section id="step-4-fitting-the-ar-model-with-statsmodels">
<h2>Step 4: Fitting the AR Model with <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code><a class="headerlink" href="#step-4-fitting-the-ar-model-with-statsmodels" title="Link to this heading">#</a></h2>
<p>Now that we have identified the order, we can fit an AR(2) model to our data using <code class="docutils literal notranslate"><span class="pre">statsmodels.tsa.ar_model.AutoReg</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fit an AR(2) model to the data</span>
<span class="c1"># We specify the data &#39;ts&#39; and the number of lags &#39;lags=2&#39;</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">AutoReg</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ar_results</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="c1"># Print the model summary</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ar_results</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
<p>The summary output is rich with information, but let’s focus on the coefficients table:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">==============================================================================</span>
                 <span class="n">coef</span>    <span class="n">std</span> <span class="n">err</span>          <span class="n">z</span>      <span class="n">P</span><span class="o">&gt;|</span><span class="n">z</span><span class="o">|</span>      <span class="p">[</span><span class="mf">0.025</span>      <span class="mf">0.975</span><span class="p">]</span>
<span class="o">------------------------------------------------------------------------------</span>
<span class="n">intercept</span>     <span class="o">-</span><span class="mf">0.0157</span>      <span class="mf">0.043</span>     <span class="o">-</span><span class="mf">0.364</span>      <span class="mf">0.716</span>      <span class="o">-</span><span class="mf">0.100</span>       <span class="mf">0.069</span>
<span class="n">y</span><span class="o">.</span><span class="n">L1</span>           <span class="mf">0.5843</span>      <span class="mf">0.044</span>     <span class="mf">13.299</span>      <span class="mf">0.000</span>       <span class="mf">0.498</span>       <span class="mf">0.670</span>
<span class="n">y</span><span class="o">.</span><span class="n">L2</span>           <span class="mf">0.2783</span>      <span class="mf">0.044</span>      <span class="mf">6.321</span>      <span class="mf">0.000</span>       <span class="mf">0.192</span>       <span class="mf">0.365</span>
</pre></div>
</div>
<p>Let’s interpret this:</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">coef</span></code> column shows the estimated values for our parameters.</p></li>
<li><p>The coefficient for <code class="docutils literal notranslate"><span class="pre">y.L1</span></code> (which is <span class="math notranslate nohighlight">\(\hat{\phi}_1\)</span>) is <code class="docutils literal notranslate"><span class="pre">0.5843</span></code>. This is very close to our true value of <code class="docutils literal notranslate"><span class="pre">0.6</span></code>.</p></li>
<li><p>The coefficient for <code class="docutils literal notranslate"><span class="pre">y.L2</span></code> (which is <span class="math notranslate nohighlight">\(\hat{\phi}_2\)</span>) is <code class="docutils literal notranslate"><span class="pre">0.2783</span></code>. This is very close to our true value of <code class="docutils literal notranslate"><span class="pre">0.3</span></code>.</p></li>
<li><p>The p-values (<code class="docutils literal notranslate"><span class="pre">P&gt;|z|</span></code>) for both coefficients are <code class="docutils literal notranslate"><span class="pre">0.000</span></code>, meaning they are statistically highly significant.</p></li>
</ul>
<p>Our statistical tools successfully identified the correct model structure, and the <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code> library accurately estimated the underlying parameters.</p>
<hr class="docutils" />
</section>
</section>
<section id="conclusion">
<h1>Conclusion<a class="headerlink" href="#conclusion" title="Link to this heading">#</a></h1>
<p>We have taken a deep dive into the Autoregressive model. We started with the simple intuition that the past can predict the future and formalized this into the AR(p) equation. We established that for this model to be meaningful, the time series must be <strong>stationary</strong>, a condition ensuring that the underlying process is stable over time.</p>
<p>Most importantly, we learned a practical, data-driven method for selecting the model’s key parameter, the order <code class="docutils literal notranslate"><span class="pre">p</span></code>. By analyzing the <strong>Partial Autocorrelation Function (PACF)</strong> and looking for a sharp cutoff, we can confidently determine how many steps into the past our model needs to look.</p>
<p>Finally, we walked through a complete example in Python, from generating data to identifying the model order and fitting it with <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code>. This workflow is fundamental to time series analysis and serves as a building block for more complex models like the Moving Average (MA) and ARMA models, which we may explore next.</p>
<p><a class="reference external" href="https://machinelearningmastery.com/time-series-forecasting-methods-in-python-cheat-sheet/">https://machinelearningmastery.com/time-series-forecasting-methods-in-python-cheat-sheet/</a>
<a class="reference external" href="https://www.kaggle.com/code/prashant111/complete-guide-on-time-series-analysis-in-python">https://www.kaggle.com/code/prashant111/complete-guide-on-time-series-analysis-in-python</a>
<a class="reference external" href="https://en.wikipedia.org/wiki/Autoregressive_model">https://en.wikipedia.org/wiki/Autoregressive_model</a></p>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./data-analysis"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Identifying the Order ‘p’: Using Statistical Tools</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-autocorrelation-function-acf">The Autocorrelation Function (ACF)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-partial-autocorrelation-function-pacf-the-key-identifier">The Partial Autocorrelation Function (PACF): The Key Identifier</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#putting-it-all-together-a-practical-python-example">Putting It All Together: A Practical Python Example</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-generating-synthetic-ar-2-data">Step 1: Generating Synthetic AR(2) Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-visualizing-the-data">Step 2: Visualizing the Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-analyzing-acf-and-pacf-plots">Step 3: Analyzing ACF and PACF Plots</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-4-fitting-the-ar-model-with-statsmodels">Step 4: Fitting the AR Model with <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code></a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Vladyslav Yakovliev (Ukraine)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>