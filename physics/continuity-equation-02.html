
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>The Continuity Equation: One-Dimensional Advection of a Density Profile &#8212; Quantopia&#39;:&#39; Physics, Python and Pi</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'physics/continuity-equation-02';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Statistical Ensembles and Liouville’s Theorem" href="ensemble.html" />
    <link rel="prev" title="The Continuity Equation" href="continuity-equation-01.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Quantopia':' Physics, Python and Pi - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Quantopia':' Physics, Python and Pi - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Quantopia: Physics, Python, and Pi (Alpha Version)
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">MATH</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../math/01_basics/gradient-operator.html">Gradient</a></li>
<li class="toctree-l1"><a class="reference internal" href="../math/01_basics/gradient-directional-derivative.html">Directional Derivative</a></li>
<li class="toctree-l1"><a class="reference internal" href="../math/01_basics/divergence.html">Divergence</a></li>
<li class="toctree-l1"><a class="reference internal" href="../math/01_basics/fourier-transform-01.html">Fourier Transform</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">PHYSICS</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="continuity-equation-01.html">The Continuity Equation</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">The Continuity Equation: One-Dimensional Advection of a Density Profile</a></li>
<li class="toctree-l1"><a class="reference internal" href="ensemble.html">Statistical Ensembles and Liouville’s Theorem</a></li>
<li class="toctree-l1"><a class="reference internal" href="microcanonical-ensemble.html">Microcanonical Ensemble</a></li>
<li class="toctree-l1"><a class="reference internal" href="fokker-planck-equation-example.html">Fokker-Planck Equation - Example Analysis (preview)</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">DATA SCIENCE AND MACHINE LEARNING</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../data-science/knn-algorithm.html">K-Nearest Neighbors (KNN) Algorithm (preview)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data-science/naive-bayes.html">Naive Bayes Method (preview)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data-science/logistic-regression.html">Logistic Regression (preview)</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/Yakovliev/quantopia/blob/main/book/physics/continuity-equation-02.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/Yakovliev/quantopia" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/Yakovliev/quantopia/issues/new?title=Issue%20on%20page%20%2Fphysics/continuity-equation-02.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/physics/continuity-equation-02.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>The Continuity Equation: One-Dimensional Advection of a Density Profile</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-shape-of-the-function-remains-unchanged-as-it-propagates">The shape of the function remains unchanged as it propagates</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#understanding-the-advection-example">Understanding the Advection Example</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#solutions-to-mitigate-numerical-diffusion">Solutions to Mitigate Numerical Diffusion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementing-a-higher-order-scheme-lax-wendroff-method">Implementing a Higher-Order Scheme: Lax-Wendroff Method</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary-of-the-shape-preservation-in-the-advection-equation">Summary of the Shape Preservation in the Advection Equation</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="the-continuity-equation-one-dimensional-advection-of-a-density-profile">
<h1>The Continuity Equation: One-Dimensional Advection of a Density Profile<a class="headerlink" href="#the-continuity-equation-one-dimensional-advection-of-a-density-profile" title="Link to this heading">#</a></h1>
<p><strong>Physical Scenario</strong></p>
<p>Imagine a pollutant being introduced into a river flowing at a constant speed <span class="math notranslate nohighlight">\(u\)</span>. The pollutant’s concentration <span class="math notranslate nohighlight">\(\rho(x, t)\)</span> varies along the length of the river <span class="math notranslate nohighlight">\(x\)</span> and changes over time <span class="math notranslate nohighlight">\(t\)</span> due to the flow of water.</p>
<p><strong>Mathematical Model</strong></p>
<p>The one-dimensional continuity equation for this scenario is:</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial \rho}{\partial t} + \frac{\partial J}{\partial x} = 0
\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\rho(x, t)\)</span>: Density (concentration) of the pollutant.</p></li>
<li><p><span class="math notranslate nohighlight">\(J(x, t)\)</span>: Flux of the pollutant.</p></li>
</ul>
<p>Assuming the flux <span class="math notranslate nohighlight">\(J\)</span> is proportional to the density and the constant velocity <span class="math notranslate nohighlight">\(u\)</span>:</p>
<div class="math notranslate nohighlight">
\[
J = \rho u
\]</div>
<p>Substituting <span class="math notranslate nohighlight">\(J\)</span> into the continuity equation:</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial \rho}{\partial t} + \frac{\partial (\rho u)}{\partial x} = 0
\]</div>
<p>We consider the case when <span class="math notranslate nohighlight">\(u\)</span> is constant:</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial \rho}{\partial t} + u \frac{\partial \rho}{\partial x} = 0
\]</div>
<p>This is the <strong>advection equation</strong>, which describes how the density profile propagates over time due to the flow.</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Advection">https://en.wikipedia.org/wiki/Advection</a></p>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">plotly.graph_objects</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">go</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">plotly.subplots</span><span class="w"> </span><span class="kn">import</span> <span class="n">make_subplots</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Parameters</span>
<span class="n">L</span> <span class="o">=</span> <span class="mf">10.0</span>          <span class="c1"># Length of the river (meters)</span>
<span class="n">T</span> <span class="o">=</span> <span class="mf">5.0</span>           <span class="c1"># Total simulation time (seconds)</span>
<span class="n">u</span> <span class="o">=</span> <span class="mf">1.0</span>           <span class="c1"># Flow velocity (m/s)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Spatial and temporal discretization</span>
<span class="n">nx</span> <span class="o">=</span> <span class="mi">200</span>          <span class="c1"># Number of spatial points</span>
<span class="n">nt</span> <span class="o">=</span> <span class="mi">200</span>          <span class="c1"># Number of time steps</span>
<span class="n">dx</span> <span class="o">=</span> <span class="n">L</span> <span class="o">/</span> <span class="p">(</span><span class="n">nx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">dt</span> <span class="o">=</span> <span class="n">T</span> <span class="o">/</span> <span class="p">(</span><span class="n">nt</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">nx</span><span class="p">)</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">nt</span><span class="p">)</span>

<span class="c1"># CFL condition for stability</span>
<span class="n">CFL</span> <span class="o">=</span> <span class="n">u</span> <span class="o">*</span> <span class="n">dt</span> <span class="o">/</span> <span class="n">dx</span>
<span class="k">if</span> <span class="n">CFL</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning: CFL condition not met. The simulation may be unstable.&quot;</span><span class="p">)</span>

<span class="c1"># Initial density profile (Gaussian distribution)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">initial_density</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="n">L</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mf">0.1</span><span class="p">)</span>

<span class="n">rho</span> <span class="o">=</span> <span class="n">initial_density</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>In mathematics, the convergence condition by Courant–Friedrichs–Lewy (CFL) is a necessary condition for convergence while solving certain partial differential equations (usually hyperbolic PDEs) numerically. It arises in the numerical analysis of explicit time integration schemes, when these are used for the numerical solution. As a consequence, the time step must be less than a certain upper bound, given a fixed spatial increment, in many explicit time-marching computer simulations; otherwise, the simulation produces incorrect or unstable results. The condition is named after Richard Courant, Kurt Friedrichs, and Hans Lewy who described it in their 1928 paper.[1]</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Courant%E2%80%93Friedrichs%E2%80%93Lewy_condition">https://en.wikipedia.org/wiki/Courant–Friedrichs–Lewy_condition</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initial Pollutant Concentration</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

<span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="n">rho</span><span class="p">,</span>
    <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Initial Density&#39;</span>
<span class="p">))</span>

<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Initial Pollutant Concentration&#39;</span><span class="p">,</span>
    <span class="n">xaxis_title</span><span class="o">=</span><span class="s1">&#39;Position along the River (m)&#39;</span><span class="p">,</span>
    <span class="n">yaxis_title</span><span class="o">=</span><span class="s1">&#39;Pollutant Concentration&#39;</span><span class="p">,</span>
    <span class="n">autosize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="mi">500</span>
<span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Store density profiles at selected time steps for visualization</span>
<span class="n">rho_history</span> <span class="o">=</span> <span class="p">[</span><span class="n">rho</span><span class="o">.</span><span class="n">copy</span><span class="p">()]</span>
<span class="n">time_steps</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># Finite Difference Scheme (Upwind method)</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nt</span><span class="p">):</span>
    <span class="n">rho_new</span> <span class="o">=</span> <span class="n">rho</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nx</span><span class="p">):</span>
        <span class="n">rho_new</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">rho</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">CFL</span> <span class="o">*</span> <span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">rho</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">rho</span> <span class="o">=</span> <span class="n">rho_new</span>

    <span class="c1"># Store data every 20 time steps</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">20</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">rho_history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rho</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        <span class="n">time_steps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">n</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Upwind method</strong> overview:</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Upwind_scheme">https://en.wikipedia.org/wiki/Upwind_scheme</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualization using Plotly</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">rho_snapshot</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">rho_history</span><span class="p">):</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="n">rho_snapshot</span><span class="p">,</span>
        <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;t = </span><span class="si">{</span><span class="n">time_steps</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> s&#39;</span>
    <span class="p">))</span>

<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Advection of Pollutant Concentration Over Time&#39;</span><span class="p">,</span>
    <span class="n">xaxis_title</span><span class="o">=</span><span class="s1">&#39;Position along the River (m)&#39;</span><span class="p">,</span>
    <span class="n">yaxis_title</span><span class="o">=</span><span class="s1">&#39;Pollutant Concentration&#39;</span><span class="p">,</span>
    <span class="n">legend_title</span><span class="o">=</span><span class="s1">&#39;Time Steps&#39;</span><span class="p">,</span>
    <span class="n">autosize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="mi">500</span>
<span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>**IMPORTANT: This result is not correct! **</p>
<p><strong>It is affected by the numerical diffusion. In general, the shape of the figure should not be changed in this specific example.</strong></p>
<p>The discrepancy arises from the numerical method used to solve the advection equation. Specifically, the Upwind Finite Difference Method is a first-order scheme, which inherently introduces numerical diffusion.</p>
<p><strong>Numerical Diffusion Explained</strong></p>
<ul class="simple">
<li><p>First-Order Accuracy: The Upwind scheme approximates derivatives using first-order differences, which are less accurate compared to higher-order methods.</p></li>
<li><p>Artificial Spreading: This lower accuracy causes the numerical solution to diffuse the concentration profile artificially, leading to a loss of sharpness in gradients. As a result:</p>
<ul>
<li><p>Peak Concentration: Decreases because the high-density region spreads out.</p></li>
<li><p>Width: Increases as the pollutant disperses over a larger area.</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Numerical_diffusion">https://en.wikipedia.org/wiki/Numerical_diffusion</a></p></li>
</ul>
<p>We used the following parameters:</p>
<p>nx = 200 (Number of spatial points)</p>
<p>nt = 200 (Number of time steps)</p>
<p>Let’s increast nx and nt, recalculate the solution, and compare new graphical representation with a new one.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Spatial and temporal discretization</span>
<span class="n">nx</span> <span class="o">=</span> <span class="mi">1000</span>          <span class="c1"># Number of spatial points</span>
<span class="n">nt</span> <span class="o">=</span> <span class="mi">1000</span>          <span class="c1"># Number of time steps</span>
<span class="n">dx</span> <span class="o">=</span> <span class="n">L</span> <span class="o">/</span> <span class="p">(</span><span class="n">nx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">dt</span> <span class="o">=</span> <span class="n">T</span> <span class="o">/</span> <span class="p">(</span><span class="n">nt</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">nx</span><span class="p">)</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">nt</span><span class="p">)</span>

<span class="c1"># CFL condition for stability</span>
<span class="n">CFL</span> <span class="o">=</span> <span class="n">u</span> <span class="o">*</span> <span class="n">dt</span> <span class="o">/</span> <span class="n">dx</span>
<span class="k">if</span> <span class="n">CFL</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning: CFL condition not met. The simulation may be unstable.&quot;</span><span class="p">)</span>

<span class="n">rho</span> <span class="o">=</span> <span class="n">initial_density</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Store density profiles at selected time steps for visualization</span>
<span class="n">rho_history</span> <span class="o">=</span> <span class="p">[</span><span class="n">rho</span><span class="o">.</span><span class="n">copy</span><span class="p">()]</span>
<span class="n">time_steps</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># Finite Difference Scheme (Upwind method)</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nt</span><span class="p">):</span>
    <span class="n">rho_new</span> <span class="o">=</span> <span class="n">rho</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nx</span><span class="p">):</span>
        <span class="n">rho_new</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">rho</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">CFL</span> <span class="o">*</span> <span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">rho</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">rho</span> <span class="o">=</span> <span class="n">rho_new</span>

    <span class="c1"># Store data every 100 time steps</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">100</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">rho_history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rho</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        <span class="n">time_steps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">n</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualization using Plotly</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">rho_snapshot</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">rho_history</span><span class="p">):</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="n">rho_snapshot</span><span class="p">,</span>
        <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;t = </span><span class="si">{</span><span class="n">time_steps</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> s&#39;</span>
    <span class="p">))</span>

<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Advection of Pollutant Concentration Over Time&#39;</span><span class="p">,</span>
    <span class="n">xaxis_title</span><span class="o">=</span><span class="s1">&#39;Position along the River (m)&#39;</span><span class="p">,</span>
    <span class="n">yaxis_title</span><span class="o">=</span><span class="s1">&#39;Pollutant Concentration&#39;</span><span class="p">,</span>
    <span class="n">legend_title</span><span class="o">=</span><span class="s1">&#39;Time Steps&#39;</span><span class="p">,</span>
    <span class="n">autosize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="mi">500</span>
<span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p><strong>More accurate result</strong></p>
<p>nx = 1000 (Number of spatial points)</p>
<p>nt = 1000 (Number of time steps)</p>
<p>However, even for this result we can see that the shape of the original Gaussian is changed over time.</p>
<p><strong>Let’s review the general theory and understand why the shape should not be changed, and then we will revisit our numerical approach to decrease the numerical diffusion.</strong></p>
<hr class="docutils" />
<section id="the-shape-of-the-function-remains-unchanged-as-it-propagates">
<h2>The shape of the function remains unchanged as it propagates<a class="headerlink" href="#the-shape-of-the-function-remains-unchanged-as-it-propagates" title="Link to this heading">#</a></h2>
<p>Let’s delve into how substituting a function of the form <span class="math notranslate nohighlight">\( \rho(x - ut) \)</span> into the <strong>advection equation</strong> demonstrates that the shape of the function remains unchanged as it propagates. This is a fundamental property of solutions to the advection equation, often interpreted as <strong>traveling wave solutions</strong>.</p>
<p><strong>1. The Advection Equation Recap</strong></p>
<p>The <strong>linear advection equation</strong> with constant speed <span class="math notranslate nohighlight">\( u \)</span> in one spatial dimension is given by:</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial \rho}{\partial t} + u \frac{\partial \rho}{\partial x} = 0
\]</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\( \rho = \rho(x, t) \)</span> is the transported quantity (e.g., concentration, temperature),</p></li>
<li><p><span class="math notranslate nohighlight">\( u \)</span> is the constant advection (transport) speed,</p></li>
<li><p><span class="math notranslate nohighlight">\( x \)</span> is the spatial coordinate,</p></li>
<li><p><span class="math notranslate nohighlight">\( t \)</span> is time.</p></li>
</ul>
<p><strong>2. Proposing a Traveling Wave Solution</strong></p>
<p>We propose a solution of the form:</p>
<div class="math notranslate nohighlight">
\[
\rho(x, t) = f(\xi) \quad \text{where} \quad \xi = x - ut
\]</div>
<p>Here, <span class="math notranslate nohighlight">\( f \)</span> is an arbitrary differentiable function representing the shape of the wave, and <span class="math notranslate nohighlight">\( \xi \)</span> is a <strong>moving coordinate</strong> that shifts with speed <span class="math notranslate nohighlight">\( u \)</span>.</p>
<p><strong>Interpretation:</strong></p>
<ul class="simple">
<li><p><strong><span class="math notranslate nohighlight">\( f(\xi) \)</span>:</strong> Represents the wave’s shape.</p></li>
<li><p><strong><span class="math notranslate nohighlight">\( \xi = x - ut \)</span>:</strong> As time <span class="math notranslate nohighlight">\( t \)</span> increases, <span class="math notranslate nohighlight">\( \xi \)</span> adjusts so that the wave maintains its shape while moving in the positive <span class="math notranslate nohighlight">\( x \)</span>-direction at speed <span class="math notranslate nohighlight">\( u \)</span>.</p></li>
</ul>
<p><strong>3. Substituting <span class="math notranslate nohighlight">\( \rho(x, t) = f(x - ut) \)</span> into the Advection Equation</strong></p>
<p>Let’s verify that this proposed solution satisfies the advection equation.</p>
<p><strong>Step 1: Compute Partial Derivatives</strong></p>
<ol class="arabic simple">
<li><p><strong>Partial derivative with respect to time <span class="math notranslate nohighlight">\( t \)</span>:</strong></p></li>
</ol>
<div class="math notranslate nohighlight">
\[
\frac{\partial \rho}{\partial t} = \frac{d f}{d \xi} \cdot \frac{\partial \xi}{\partial t} = f'(\xi) \cdot (-u) = -u f'(\xi)
\]</div>
<ol class="arabic simple" start="2">
<li><p><strong>Partial derivative with respect to space <span class="math notranslate nohighlight">\( x \)</span>:</strong></p></li>
</ol>
<div class="math notranslate nohighlight">
\[
\frac{\partial \rho}{\partial x} = \frac{d f}{d \xi} \cdot \frac{\partial \xi}{\partial x} = f'(\xi) \cdot 1 = f'(\xi)
\]</div>
<p><em>Here, <span class="math notranslate nohighlight">\( f'(\xi) \)</span> denotes the derivative of <span class="math notranslate nohighlight">\( f \)</span> with respect to its argument <span class="math notranslate nohighlight">\( \xi \)</span>.</em></p>
<p><strong>Step 2: Substitute into the Advection Equation</strong></p>
<div class="math notranslate nohighlight">
\[
\frac{\partial \rho}{\partial t} + u \frac{\partial \rho}{\partial x} = -u f'(\xi) + u f'(\xi) = 0
\]</div>
<p><strong>Conclusion:</strong></p>
<p>The left-hand side of the advection equation simplifies to zero, which satisfies the equation identically. Therefore, <span class="math notranslate nohighlight">\( \rho(x, t) = f(x - ut) \)</span> is indeed a solution to the advection equation.</p>
<p><strong>4. Implications of the Solution</strong></p>
<p><strong>a. Shape Preservation</strong></p>
<p>Since <span class="math notranslate nohighlight">\( f(\xi) \)</span> remains unchanged as <span class="math notranslate nohighlight">\( \xi = x - ut \)</span> varies, the <strong>shape of the wave</strong> <span class="math notranslate nohighlight">\( f \)</span> is preserved over time. The entire profile <span class="math notranslate nohighlight">\( f \)</span> simply translates along the <span class="math notranslate nohighlight">\( x \)</span>-axis without distortion.</p>
<p><strong>b. Wave Propagation</strong></p>
<p>The solution represents a <strong>traveling wave</strong> moving in the positive <span class="math notranslate nohighlight">\( x \)</span>-direction with speed <span class="math notranslate nohighlight">\( u \)</span>. If <span class="math notranslate nohighlight">\( u \)</span> is negative, the wave travels in the negative <span class="math notranslate nohighlight">\( x \)</span>-direction, and the solution can be written as <span class="math notranslate nohighlight">\( \rho(x, t) = f(x + |u|t) \)</span>.</p>
<p><strong>c. Superposition Principle</strong></p>
<p>Given the linearity of the advection equation, any linear combination of traveling wave solutions is also a solution. For example:</p>
<div class="math notranslate nohighlight">
\[
\rho(x, t) = f(x - ut) + g(x + ut)
\]</div>
<p>where <span class="math notranslate nohighlight">\( f \)</span> and <span class="math notranslate nohighlight">\( g \)</span> are arbitrary differentiable functions, represents waves traveling in opposite directions.</p>
<p><strong>5. Visual Illustration</strong></p>
<p>Imagine a <strong>pulse</strong> or <strong>wave packet</strong> described by <span class="math notranslate nohighlight">\( f(\xi) \)</span>:</p>
<ul class="simple">
<li><p><strong>Initial Condition at <span class="math notranslate nohighlight">\( t = 0 \)</span>:</strong> <span class="math notranslate nohighlight">\( \rho(x, 0) = f(x) \)</span></p></li>
<li><p><strong>At <span class="math notranslate nohighlight">\( t = t_0 \)</span>:</strong> <span class="math notranslate nohighlight">\( \rho(x, t_0) = f(x - ut_0) \)</span></p></li>
</ul>
<p>This shows that the entire profile of <span class="math notranslate nohighlight">\( f \)</span> has shifted to the right by <span class="math notranslate nohighlight">\( u t_0 \)</span> units without any change in its shape or amplitude.</p>
<p><strong>6. Generalizations and Extensions</strong></p>
<p>While <span class="math notranslate nohighlight">\( \rho(x - ut) \)</span> is a simple traveling wave solution, more complex solutions can involve superpositions, discontinuities (shock waves), or even multi-dimensional traveling waves, depending on the context and the nature of the function <span class="math notranslate nohighlight">\( f \)</span>.</p>
<p><strong>Nonlinear Advection:</strong>
In nonlinear advection equations, where the speed <span class="math notranslate nohighlight">\( u \)</span> may depend on <span class="math notranslate nohighlight">\( \rho \)</span> itself (e.g., <span class="math notranslate nohighlight">\( \frac{\partial \rho}{\partial t} + u(\rho) \frac{\partial \rho}{\partial x} = 0 \)</span>), the solutions can exhibit more complex behaviors like wave steepening and shock formation.</p>
<p><strong>7. Conclusion</strong></p>
<p>By substituting a function of the form <span class="math notranslate nohighlight">\( \rho(x - ut) \)</span> into the linear advection equation with constant speed <span class="math notranslate nohighlight">\( u \)</span>, we demonstrate that:</p>
<ol class="arabic simple">
<li><p><strong>The proposed function satisfies the equation identically.</strong></p></li>
<li><p><strong>The shape of the function <span class="math notranslate nohighlight">\( f \)</span> is preserved over time.</strong></p></li>
<li><p><strong>The solution represents a traveling wave moving at speed <span class="math notranslate nohighlight">\( u \)</span> without distortion.</strong></p></li>
</ol>
<p>This fundamental property makes the advection equation a powerful model for understanding transport phenomena where the shape of the moving quantity remains unchanged as it propagates through space.</p>
<hr class="docutils" />
</section>
<section id="understanding-the-advection-example">
<h2>Understanding the Advection Example<a class="headerlink" href="#understanding-the-advection-example" title="Link to this heading">#</a></h2>
<p>In the current example, we model how the concentration (or density) of a pollutant in a river evolves over time. The pollutant is transported by the river’s flow at a constant velocity. This process is described by the <strong>advection equation</strong>, a simplified form of the continuity equation.</p>
<hr class="docutils" />
<p><strong>Physical Scenario</strong></p>
<ul class="simple">
<li><p><strong>Pollutant in a River</strong>: Imagine a pollutant introduced into a river flowing at a constant velocity <span class="math notranslate nohighlight">\(u\)</span>.</p></li>
<li><p><strong>One-Dimensional Flow</strong>: We model the river as a one-dimensional domain along the <span class="math notranslate nohighlight">\(x\)</span>-axis.</p></li>
<li><p><strong>Density Function</strong>: The pollutant concentration is represented by <span class="math notranslate nohighlight">\(\rho(x, t)\)</span>, which depends on position <span class="math notranslate nohighlight">\(x\)</span> and time <span class="math notranslate nohighlight">\(t\)</span>.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Key Assumptions</strong></p>
<ul class="simple">
<li><p><strong>No Sources or Sinks</strong>: There’s no addition or removal of pollutant within the river.</p></li>
<li><p><strong>No Diffusion or Dispersion</strong>: The pollutant does not spread out due to molecular diffusion or turbulent mixing.</p></li>
<li><p><strong>Constant Flow Velocity</strong>: The river flows at a steady speed <span class="math notranslate nohighlight">\(u\)</span>, and this velocity does not change over time or position.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Connection to the Differential Equation</strong></p>
<p><strong>The Advection Equation</strong></p>
<p>The continuity equation simplifies to the <strong>advection equation</strong> under the given assumptions:</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial \rho}{\partial t} + u \frac{\partial \rho}{\partial x} = 0
\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\frac{\partial \rho}{\partial t}\)</span>: The rate of change of pollutant concentration at a fixed point in space.</p></li>
<li><p><span class="math notranslate nohighlight">\(u \frac{\partial \rho}{\partial x}\)</span>: The rate at which pollutant concentration is transported by the flow.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Physical Interpretation</strong></p>
<ul class="simple">
<li><p>The advection equation states that the change in concentration at a point over time is due to the movement of concentration gradients by the flow.</p></li>
<li><p>If there is a higher concentration upstream (<span class="math notranslate nohighlight">\(x - \Delta x\)</span>) compared to downstream (<span class="math notranslate nohighlight">\(x\)</span>), the pollutant will be carried to <span class="math notranslate nohighlight">\(x\)</span>, increasing the concentration there.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Analytical Solution</strong></p>
<p><strong>Method of Characteristics</strong></p>
<p>The advection equation is a first-order linear partial differential equation that can be solved using the method of characteristics.</p>
<p><strong>General Solution</strong>:</p>
<div class="math notranslate nohighlight">
\[
\rho(x, t) = f(x - u t)
\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(f\)</span>: The initial concentration profile at time <span class="math notranslate nohighlight">\(t = 0\)</span>.</p></li>
<li><p><strong>Interpretation</strong>: The initial profile moves to the right (downstream) without changing shape at a constant speed <span class="math notranslate nohighlight">\(u\)</span>.</p></li>
</ul>
<p><strong>Verification</strong></p>
<p>To verify that <span class="math notranslate nohighlight">\(\rho(x, t) = f(x - u t)\)</span> is a solution:</p>
<ol class="arabic">
<li><p><strong>Compute Time Derivative</strong>:</p>
<div class="math notranslate nohighlight">
\[
   \frac{\partial \rho}{\partial t} = \frac{d f}{d (x - u t)} \cdot (-u) = -u f'(x - u t)
   \]</div>
</li>
<li><p><strong>Compute Spatial Derivative</strong>:</p>
<div class="math notranslate nohighlight">
\[
   \frac{\partial \rho}{\partial x} = \frac{d f}{d (x - u t)} \cdot 1 = f'(x - u t)
   \]</div>
</li>
<li><p><strong>Substitute into the Advection Equation</strong>:</p>
<div class="math notranslate nohighlight">
\[
   \frac{\partial \rho}{\partial t} + u \frac{\partial \rho}{\partial x} = (-u f') + u (f') = 0
   \]</div>
</li>
</ol>
<ul class="simple">
<li><p><strong>Conclusion</strong>: The expression satisfies the advection equation.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Understanding the Graph</strong></p>
<p><strong>Movement of the Density Profile</strong></p>
<ul class="simple">
<li><p><strong>Initial Profile</strong>: At <span class="math notranslate nohighlight">\(t = 0\)</span>, the concentration is a Gaussian centered at <span class="math notranslate nohighlight">\(x = x_0\)</span>.</p></li>
<li><p><strong>Evolution Over Time</strong>: As time progresses, the entire Gaussian profile shifts to the right without changing shape.</p></li>
<li><p><strong>Constant Speed</strong>: The profile moves at speed <span class="math notranslate nohighlight">\(u\)</span>, consistent with the solution <span class="math notranslate nohighlight">\(\rho(x, t) = f(x - u t)\)</span>.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Connection to the Differential Equation</strong></p>
<ul class="simple">
<li><p><strong>Advection-Driven Transport</strong>: The advection equation predicts that the concentration at a point <span class="math notranslate nohighlight">\(x\)</span> at time <span class="math notranslate nohighlight">\(t\)</span> is the same as the initial concentration at <span class="math notranslate nohighlight">\(x - u t\)</span>.</p></li>
<li><p><strong>Shape Preservation</strong>: Since there are no terms in the equation accounting for diffusion, the shape remains unchanged.</p></li>
<li><p><strong>Mass Conservation</strong>: The area under the concentration curve remains constant, indicating that the total amount of pollutant is conserved.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Numerical Simulation</strong></p>
<p><strong>Finite Difference Method</strong></p>
<ul class="simple">
<li><p><strong>Discretization</strong>: Space and time are discretized into small intervals (<span class="math notranslate nohighlight">\(\Delta x\)</span> and <span class="math notranslate nohighlight">\(\Delta t\)</span>).</p></li>
<li><p><strong>Upwind Scheme</strong>: An explicit method suitable for solving hyperbolic PDEs like the advection equation.</p></li>
</ul>
<p><strong>Update Formula</strong>:</p>
<div class="math notranslate nohighlight">
\[
\rho_i^{n+1} = \rho_i^n - \frac{u \Delta t}{\Delta x} (\rho_i^n - \rho_{i-1}^n)
\]</div>
<ul>
<li><p><span class="math notranslate nohighlight">\(\rho_i^n\)</span>: Concentration at position <span class="math notranslate nohighlight">\(x_i\)</span> and time <span class="math notranslate nohighlight">\(t_n\)</span>.</p></li>
<li><p><strong>Courant Number (CFL)</strong>:</p>
<div class="math notranslate nohighlight">
\[
  \text{CFL} = \frac{u \Delta t}{\Delta x}
  \]</div>
<ul class="simple">
<li><p>Must satisfy <span class="math notranslate nohighlight">\(\text{CFL} \leq 1\)</span> for numerical stability.</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Upwind_scheme">https://en.wikipedia.org/wiki/Upwind_scheme</a></p></li>
</ul>
<hr class="docutils" />
<p><strong>How It Solves the Advection Equation</strong></p>
<ul>
<li><p><strong>Approximation of Derivatives</strong>:</p>
<ul>
<li><p><strong>Temporal Derivative</strong>:</p>
<div class="math notranslate nohighlight">
\[
    \frac{\partial \rho}{\partial t} \approx \frac{\rho_i^{n+1} - \rho_i^n}{\Delta t}
    \]</div>
</li>
<li><p><strong>Spatial Derivative</strong>:</p>
<div class="math notranslate nohighlight">
\[
    \frac{\partial \rho}{\partial x} \approx \frac{\rho_i^n - \rho_{i-1}^n}{\Delta x}
    \]</div>
</li>
</ul>
</li>
<li><p><strong>Substituting into the Advection Equation</strong>:</p>
<div class="math notranslate nohighlight">
\[
  \frac{\rho_i^{n+1} - \rho_i^n}{\Delta t} + u \frac{\rho_i^n - \rho_{i-1}^n}{\Delta x} = 0
  \]</div>
</li>
<li><p><strong>Rearranging</strong>:</p>
<div class="math notranslate nohighlight">
\[
  \rho_i^{n+1} = \rho_i^n - \text{CFL} (\rho_i^n - \rho_{i-1}^n)
  \]</div>
</li>
<li><p><strong>Interpretation</strong>:</p>
<ul class="simple">
<li><p>The new concentration at <span class="math notranslate nohighlight">\(x_i\)</span> depends on its current value and the difference between its value and that at the upstream point <span class="math notranslate nohighlight">\(x_{i-1}\)</span>.</p></li>
<li><p>This captures the upstream influence, consistent with the direction of advection.</p></li>
</ul>
</li>
</ul>
<hr class="docutils" />
<p><strong>Visualization</strong></p>
<ul class="simple">
<li><p><strong>Profiles Over Time</strong>: The simulation records the concentration profile at various time steps.</p></li>
<li><p><strong>Graph Movement</strong>: The plotted profiles show the initial Gaussian shifting to the right over time.</p></li>
<li><p><strong>Consistency with Theory</strong>: The numerical results align with the analytical solution of the advection equation.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Connecting Differential Equation and Graph</strong></p>
<p><strong>Role of the Differential Equation</strong></p>
<ul class="simple">
<li><p><strong>Predicts Behavior</strong>: The advection equation dictates how the concentration changes in both space and time.</p></li>
<li><p><strong>Shape and Movement</strong>: It predicts that the shape of the concentration profile remains constant while moving at speed <span class="math notranslate nohighlight">\(u\)</span>.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Numerical Simulation as an Approximation</strong></p>
<ul class="simple">
<li><p><strong>Discretization Errors</strong>: While the finite difference method approximates derivatives, small errors can accumulate.</p></li>
<li><p><strong>CFL Condition</strong>: Ensures stability and accuracy of the simulation.</p></li>
<li><p><strong>Visualization of Solutions</strong>: The simulation provides a visual representation of the mathematical solution.</p></li>
</ul>
<hr class="docutils" />
</section>
<section id="solutions-to-mitigate-numerical-diffusion">
<h2>Solutions to Mitigate Numerical Diffusion<a class="headerlink" href="#solutions-to-mitigate-numerical-diffusion" title="Link to this heading">#</a></h2>
<p>To better preserve the Gaussian shape in the simulation, consider the following approaches:</p>
<ol class="arabic simple">
<li><p><strong>Higher-Order Numerical Schemes</strong></p>
<ul class="simple">
<li><p><strong>Lax-Wendroff Method</strong>: A second-order accurate scheme that reduces numerical diffusion.</p></li>
<li><p><strong>MacCormack Method</strong>: Another second-order method suitable for hyperbolic PDEs like the advection equation.</p></li>
<li><p><strong>Essentially Non-Oscillatory (ENO) Schemes</strong>: High-order schemes that handle sharp gradients without introducing significant diffusion.</p></li>
</ul>
</li>
<li><p><strong>Refining Discretization Parameters</strong></p>
<ul class="simple">
<li><p>Increase Spatial Resolution (<span class="math notranslate nohighlight">\(nx\)</span>): Finer spatial grids can capture gradients more accurately.</p></li>
<li><p>Decrease Time Step (<span class="math notranslate nohighlight">\(nt\)</span>): Smaller time steps reduce the Courant–Friedrichs–Lewy (CFL) number, potentially enhancing stability and accuracy.</p></li>
</ul>
</li>
<li><p><strong>Implementing Anti-Diffusion Techniques</strong></p>
<ul class="simple">
<li><p><strong>Flux Limiters</strong>: Modify the numerical flux to prevent excessive diffusion.</p></li>
<li><p><strong>Total Variation Diminishing (TVD) Schemes</strong>: Ensure that the total variation of the solution does not increase, preserving sharp fronts.</p></li>
</ul>
</li>
</ol>
</section>
<section id="implementing-a-higher-order-scheme-lax-wendroff-method">
<h2>Implementing a Higher-Order Scheme: Lax-Wendroff Method<a class="headerlink" href="#implementing-a-higher-order-scheme-lax-wendroff-method" title="Link to this heading">#</a></h2>
<p>To address the numerical diffusion observed with the Upwind scheme, let’s implement the Lax-Wendroff Method, which is second-order accurate in both space and time. This method provides a better approximation of the advection equation and preserves the shape of the Gaussian profile more effectively.</p>
<p><strong>Lax-Wendroff Scheme Overview</strong></p>
<p>The Lax-Wendroff scheme updates the density <span class="math notranslate nohighlight">\(\rho\)</span> using both first and second spatial derivatives, effectively capturing the wave propagation with reduced numerical diffusion.</p>
<p><strong>Update Formula</strong>:</p>
<div class="math notranslate nohighlight">
\[
\rho_i^{n+1} = \rho_i^n - \frac{u \Delta t}{2 \Delta x} (\rho_{i+1}^n - \rho_{i-1}^n) + \frac{u^2 \Delta t^2}{2 \Delta x^2} (\rho_{i+1}^n - 2 \rho_i^n + \rho_{i-1}^n)
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Parameters</span>
<span class="n">L</span> <span class="o">=</span> <span class="mf">10.0</span>          <span class="c1"># Length of the river (meters)</span>
<span class="n">T</span> <span class="o">=</span> <span class="mf">5.0</span>           <span class="c1"># Total simulation time (seconds)</span>
<span class="n">nx</span> <span class="o">=</span> <span class="mi">1000</span>          <span class="c1"># Number of spatial points</span>
<span class="n">nt</span> <span class="o">=</span> <span class="mi">1000</span>          <span class="c1"># Number of time steps</span>
<span class="n">u</span> <span class="o">=</span> <span class="mf">1.0</span>           <span class="c1"># Flow velocity (m/s)</span>

<span class="c1"># Spatial and temporal discretization</span>
<span class="n">dx</span> <span class="o">=</span> <span class="n">L</span> <span class="o">/</span> <span class="p">(</span><span class="n">nx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">dt</span> <span class="o">=</span> <span class="n">T</span> <span class="o">/</span> <span class="p">(</span><span class="n">nt</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">nx</span><span class="p">)</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">nt</span><span class="p">)</span>

<span class="c1"># CFL condition for stability</span>
<span class="n">CFL</span> <span class="o">=</span> <span class="n">u</span> <span class="o">*</span> <span class="n">dt</span> <span class="o">/</span> <span class="n">dx</span>
<span class="k">if</span> <span class="n">CFL</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning: CFL condition not met. The simulation may be unstable.&quot;</span><span class="p">)</span>

<span class="n">rho</span> <span class="o">=</span> <span class="n">initial_density</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="c1"># Store density profiles at selected time steps for visualization</span>
<span class="n">rho_history</span> <span class="o">=</span> <span class="p">[</span><span class="n">rho</span><span class="o">.</span><span class="n">copy</span><span class="p">()]</span>

<span class="n">time_steps</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># Lax-Wendroff Scheme</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nt</span><span class="p">):</span>
    <span class="n">rho_new</span> <span class="o">=</span> <span class="n">rho</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nx</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">rho_new</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> 
                      <span class="mf">0.5</span> <span class="o">*</span> <span class="n">CFL</span> <span class="o">*</span> <span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">rho</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> 
                      <span class="mf">0.5</span> <span class="o">*</span> <span class="n">CFL</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">rho</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">rho</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
    <span class="c1"># Boundary conditions (Periodic)</span>
    <span class="n">rho_new</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">rho_new</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">rho_new</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">rho_new</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    
    <span class="n">rho</span> <span class="o">=</span> <span class="n">rho_new</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    
    <span class="c1"># Store data every 100 time steps</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">100</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">rho_history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rho</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        <span class="n">time_steps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">n</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualization using Plotly</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">rho_snapshot</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">rho_history</span><span class="p">):</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="n">rho_snapshot</span><span class="p">,</span>
        <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;t = </span><span class="si">{</span><span class="n">time_steps</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> s&#39;</span>
    <span class="p">))</span>

<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Advection of Pollutant Concentration Over Time (Lax-Wendroff)&#39;</span><span class="p">,</span>
    <span class="n">xaxis_title</span><span class="o">=</span><span class="s1">&#39;Position along the River (m)&#39;</span><span class="p">,</span>
    <span class="n">yaxis_title</span><span class="o">=</span><span class="s1">&#39;Pollutant Concentration&#39;</span><span class="p">,</span>
    <span class="n">legend_title</span><span class="o">=</span><span class="s1">&#39;Time Steps&#39;</span><span class="p">,</span>
    <span class="n">autosize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="mi">500</span>
<span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p><strong>Explanation of the Updated Code</strong></p>
<ol class="arabic simple">
<li><p><strong>Lax-Wendroff Update</strong>: The core update loop implements the Lax-Wendroff scheme, incorporating both first and second spatial derivatives to improve accuracy.</p></li>
<li><p><strong>Boundary Conditions</strong>: Implemented <strong>periodic boundary conditions</strong> to allow the Gaussian to exit one end and enter the other, minimizing edge effects. You can adjust this based on your physical scenario.</p></li>
<li><p><strong>Visualization</strong>: The Plotly graph now reflects the reduced numerical diffusion, showing the Gaussian maintaining its shape as it advects downstream.</p></li>
</ol>
<hr class="docutils" />
<p><strong>Expected Results</strong></p>
<p>With the Lax-Wendroff scheme:</p>
<ul class="simple">
<li><p><strong>Shape Preservation</strong>: The Gaussian maintains its peak and width more accurately over time.</p></li>
<li><p><strong>Reduced Numerical Diffusion</strong>: Less artificial spreading and peak attenuation compared to the Upwind scheme.</p></li>
<li><p><strong>Mass Conservation</strong>: The total area under the Gaussian remains approximately constant, indicating better mass conservation.</p></li>
</ul>
<hr class="docutils" />
</section>
<section id="summary-of-the-shape-preservation-in-the-advection-equation">
<h2>Summary of the Shape Preservation in the Advection Equation<a class="headerlink" href="#summary-of-the-shape-preservation-in-the-advection-equation" title="Link to this heading">#</a></h2>
<p><strong>1. Analyzing the Advection Equation Itself</strong></p>
<p>The <strong>advection equation</strong> is a simplified form of the continuity equation, focusing solely on the transport of a conserved quantity without any sources, sinks, or diffusion. The equation is given by:</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial \rho}{\partial t} + u \frac{\partial \rho}{\partial x} = 0
\]</div>
<p>Where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\rho(x, t)\)</span> is the <strong>density</strong> or <strong>concentration</strong> of the conserved quantity at position <span class="math notranslate nohighlight">\(x\)</span> and time <span class="math notranslate nohighlight">\(t\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(u\)</span> is the <strong>constant flow velocity</strong>.</p></li>
</ul>
<p><strong>Key Characteristics of the Advection Equation:</strong></p>
<ol class="arabic simple">
<li><p><strong>Linearity</strong>:</p>
<ul class="simple">
<li><p>The equation is <strong>linear</strong> in <span class="math notranslate nohighlight">\(\rho\)</span>, meaning that if <span class="math notranslate nohighlight">\(\rho_1\)</span> and <span class="math notranslate nohighlight">\(\rho_2\)</span> are solutions, then any linear combination <span class="math notranslate nohighlight">\(a \rho_1 + b \rho_2\)</span> is also a solution.</p></li>
</ul>
</li>
<li><p><strong>First-Order Partial Differential Equation (PDE)</strong>:</p>
<ul class="simple">
<li><p>It involves first-order derivatives in both time and space.</p></li>
</ul>
</li>
<li><p><strong>Hyperbolic Nature</strong>:</p>
<ul class="simple">
<li><p>Being a hyperbolic PDE, it models wave propagation and transport phenomena where information travels along characteristic lines.</p></li>
</ul>
</li>
<li><p><strong>No Diffusion or Dispersion Terms</strong>:</p>
<ul class="simple">
<li><p>Unlike equations that include second-order spatial derivatives (e.g., diffusion equation), the advection equation lacks terms that cause spreading or smoothing of the solution.</p></li>
</ul>
</li>
</ol>
<p><strong>Implications of These Characteristics:</strong></p>
<ul class="simple">
<li><p><strong>Shape Preservation</strong>:</p>
<ul>
<li><p>Since there are no diffusion or dispersion terms to cause spreading, the <strong>shape</strong> of the initial density profile is preserved as it moves.</p></li>
</ul>
</li>
<li><p><strong>Translation of the Initial Profile</strong>:</p>
<ul>
<li><p>The entire profile translates downstream at a constant velocity <span class="math notranslate nohighlight">\(u\)</span> without any deformation.</p></li>
</ul>
</li>
</ul>
<hr class="docutils" />
<p><strong>2. Role of Initial Conditions</strong></p>
<p>While the <strong>advection equation</strong> dictates <strong>how</strong> the density profile moves, the <strong>initial conditions</strong> define <strong>what</strong> is being moved. The solution to the advection equation depends on both the equation itself and the initial profile provided.</p>
<p><strong>General Solution Using Method of Characteristics:</strong></p>
<p>The method of characteristics transforms the PDE into ordinary differential equations (ODEs) along characteristic lines where the solution is constant.</p>
<p><strong>Characteristic Lines</strong>:</p>
<div class="math notranslate nohighlight">
\[
\frac{dx}{dt} = u
\]</div>
<p><strong>Solution Along Characteristics</strong>:</p>
<div class="math notranslate nohighlight">
\[
\rho(x, t) = f(x - u t)
\]</div>
<p>Where <span class="math notranslate nohighlight">\(f\)</span> is the <strong>initial concentration profile</strong> at <span class="math notranslate nohighlight">\(t = 0\)</span>:</p>
<div class="math notranslate nohighlight">
\[
\rho(x, 0) = f(x)
\]</div>
<p><strong>Interpretation</strong>:</p>
<ul class="simple">
<li><p><strong>Translation Without Change</strong>:</p>
<ul>
<li><p>The function <span class="math notranslate nohighlight">\(f(x - u t)\)</span> represents the initial profile <span class="math notranslate nohighlight">\(f(x)\)</span> shifted by <span class="math notranslate nohighlight">\(u t\)</span> units to the right (assuming <span class="math notranslate nohighlight">\(u &gt; 0\)</span>).</p></li>
</ul>
</li>
<li><p><strong>No Change in Shape</strong>:</p>
<ul>
<li><p>Since <span class="math notranslate nohighlight">\(f\)</span> is merely shifted and not altered in form, the <strong>shape</strong> of the density profile remains unchanged over time.</p></li>
</ul>
</li>
</ul>
<hr class="docutils" />
<p><strong>3. Visual Confirmation</strong></p>
<p>Consider an initial Gaussian density profile:</p>
<div class="math notranslate nohighlight">
\[
\rho(x, 0) = e^{-\frac{(x - x_0)^2}{2\sigma^2}}
\]</div>
<p><strong>Solution at Time <span class="math notranslate nohighlight">\(t\)</span>:</strong></p>
<div class="math notranslate nohighlight">
\[
\rho(x, t) = e^{-\frac{(x - x_0 - u t)^2}{2\sigma^2}}
\]</div>
<p><strong>Observations:</strong></p>
<ul class="simple">
<li><p><strong>Mean Shift</strong>:</p>
<ul>
<li><p>The peak of the Gaussian moves to <span class="math notranslate nohighlight">\(x = x_0 + u t\)</span>.</p></li>
</ul>
</li>
<li><p><strong>Variance Remains Constant</strong>:</p>
<ul>
<li><p>The spread (<span class="math notranslate nohighlight">\(\sigma\)</span>) of the Gaussian remains unchanged, indicating no diffusion.</p></li>
</ul>
</li>
<li><p><strong>Shape Unaltered</strong>:</p>
<ul>
<li><p>The Gaussian retains its bell shape as it translates downstream.</p></li>
</ul>
</li>
</ul>
<hr class="docutils" />
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./physics"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="continuity-equation-01.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">The Continuity Equation</p>
      </div>
    </a>
    <a class="right-next"
       href="ensemble.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Statistical Ensembles and Liouville’s Theorem</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-shape-of-the-function-remains-unchanged-as-it-propagates">The shape of the function remains unchanged as it propagates</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#understanding-the-advection-example">Understanding the Advection Example</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#solutions-to-mitigate-numerical-diffusion">Solutions to Mitigate Numerical Diffusion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementing-a-higher-order-scheme-lax-wendroff-method">Implementing a Higher-Order Scheme: Lax-Wendroff Method</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary-of-the-shape-preservation-in-the-advection-equation">Summary of the Shape Preservation in the Advection Equation</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Vladyslav Yakovliev
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>