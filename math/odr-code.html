
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>ODR - Code Examples &#8212; Quantopia&#39;:&#39; Physics, Python and Pi</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'math/odr-code';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="The Continuity Equation" href="../physics/continuity-equation-01.html" />
    <link rel="prev" title="Orthogonal Distance Regression" href="orthogonal-distance-regression.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Quantopia':' Physics, Python and Pi - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Quantopia':' Physics, Python and Pi - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Quantopia: Physics, Python, and Pi (Alpha Version)
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">MATH</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="gradient-operator.html">Gradient</a></li>
<li class="toctree-l1"><a class="reference internal" href="gradient-directional-derivative.html">Directional Derivative</a></li>
<li class="toctree-l1"><a class="reference internal" href="divergence.html">Divergence</a></li>
<li class="toctree-l1"><a class="reference internal" href="fourier-transform-01.html">Fourier Transform</a></li>
<li class="toctree-l1"><a class="reference internal" href="uncertainties-introduction.html">Experimental Errors and Significant Figures</a></li>
<li class="toctree-l1"><a class="reference internal" href="least-squares-regression.html">Least Squares Regression, RSS, RMSE, R-squared</a></li>
<li class="toctree-l1"><a class="reference internal" href="least-squares-regression-code.html">Least Squares Regression - Code Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="ordinary-least-squares.html">Ordinary Least Squares (OLS) Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="ordinary-least-squares-code.html">Ordinary Least Squares (OLS) Regression - Code Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="variance-covariance.html">Variance and Covariance</a></li>
<li class="toctree-l1"><a class="reference internal" href="weighted-least-squares.html">Weighted Least Squares</a></li>
<li class="toctree-l1"><a class="reference internal" href="weighted-least-squares-code-1.html">WLS - Code Examples Part 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="weighted-least-squares-code-2.html">WLS - Code Examples Part 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="goodness-of-fit-and-chi-squared.html">Goodness of Fit and Chi-Squared Statistic</a></li>
<li class="toctree-l1"><a class="reference internal" href="aic-and-bic.html">Akaike Information Criterion (AIC) and Bayesian Information Criterion (BIC)</a></li>
<li class="toctree-l1"><a class="reference internal" href="weighted-least-squares-code-3.html">WLS - Code Examples Part 3</a></li>
<li class="toctree-l1"><a class="reference internal" href="orthogonal-distance-regression.html">Orthogonal Distance Regression</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">ODR - Code Examples</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">PHYSICS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../physics/continuity-equation-01.html">The Continuity Equation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../physics/continuity-equation-02.html">The Continuity Equation: One-Dimensional Advection of a Density Profile</a></li>
<li class="toctree-l1"><a class="reference internal" href="../physics/ensemble.html">Statistical Ensembles and Liouville’s Theorem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../physics/microcanonical-ensemble.html">Microcanonical Ensemble</a></li>
<li class="toctree-l1"><a class="reference internal" href="../physics/inertial_vs_gravitational_mass.html">Mass: Inertial vs. Gravitational</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/Yakovliev/quantopia/blob/main/book/math/odr-code.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/Yakovliev/quantopia" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/Yakovliev/quantopia/issues/new?title=Issue%20on%20page%20%2Fmath/odr-code.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/math/odr-code.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>ODR - Code Examples</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#general-investigation-of-odr">General Investigation of ODR</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inverse-condition-number">Inverse Condition Number</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reason-s-for-halting-sum-of-squares-convergence">Reason(s) for Halting: Sum of Squares Convergence</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#predicted-values-of-x-and-y">Predicted values of x and y</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#general-methods-for-odr-analysis">General Methods for ODR Analysis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#usage-of-methods-dataset-3">Usage of Methods. Dataset 3</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#usage-of-methods-dataset-1">Usage of Methods. Dataset 1</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#improved-model-function">Improved model function</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#more-than-2-parameters-in-the-non-linear-model">More than 2 parameters in the non-linear model</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#usage-of-methods-dataset-2">Usage of Methods. Dataset 2</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Improved model function</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">More than 2 parameters in the non-linear model</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="odr-code-examples">
<h1>ODR - Code Examples<a class="headerlink" href="#odr-code-examples" title="Link to this heading">#</a></h1>
<section id="general-investigation-of-odr">
<h2>General Investigation of ODR<a class="headerlink" href="#general-investigation-of-odr" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.odr</span><span class="w"> </span><span class="kn">import</span> <span class="n">ODR</span><span class="p">,</span> <span class="n">Model</span><span class="p">,</span> <span class="n">RealData</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">stats</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">model_function</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The custom function to approximate the data.</span>
<span class="sd">    f(x; A, B) = A * (np.exp(-B * x) - 1) + 100</span>
<span class="sd">    Note: The signature is now (beta, x) for scipy.odr.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="n">beta</span>
    <span class="k">return</span> <span class="n">A</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">B</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">100</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Dataset 3</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">196</span><span class="p">,</span> <span class="mi">292</span><span class="p">,</span> <span class="mi">401</span><span class="p">])</span>
<span class="n">y_obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mf">87.8</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mf">65.7</span><span class="p">,</span> <span class="mf">50.9</span><span class="p">,</span> <span class="mf">46.5</span><span class="p">,</span> <span class="mf">44.4</span><span class="p">])</span>
<span class="n">sigma_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">sigma_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">y_obs</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">initial_guess</span> <span class="o">=</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">]</span>

<span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the ODR model and data</span>
<span class="n">odr_model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">model_function</span><span class="p">)</span>
<span class="n">odr_data</span> <span class="o">=</span> <span class="n">RealData</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_obs</span><span class="p">,</span> <span class="n">sx</span><span class="o">=</span><span class="n">sigma_x</span><span class="p">,</span> <span class="n">sy</span><span class="o">=</span><span class="n">sigma_y</span><span class="p">)</span>

<span class="c1"># Instantiate and run the ODR fit</span>
<span class="n">odr_instance</span> <span class="o">=</span> <span class="n">ODR</span><span class="p">(</span><span class="n">odr_data</span><span class="p">,</span> <span class="n">odr_model</span><span class="p">,</span> <span class="n">beta0</span><span class="o">=</span><span class="n">initial_guess</span><span class="p">)</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">odr_instance</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">output</span><span class="o">.</span><span class="n">pprint</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Beta: [5.67694275e+01 9.88335260e-03]
Beta Std Error: [4.26741666e-01 2.63972932e-04]
Beta Covariance: [[ 2.41744445e-01 -1.18588964e-04]
 [-1.18588964e-04  9.25007382e-08]]
Residual Variance: 0.7533097575791786
Inverse Condition #: 0.17698951436366908
Reason(s) for Halting:
  Sum of squares convergence
</pre></div>
</div>
</div>
</div>
<section id="inverse-condition-number">
<h3>Inverse Condition Number<a class="headerlink" href="#inverse-condition-number" title="Link to this heading">#</a></h3>
<p>The “Inverse Condition #” is the reciprocal (1/x) of the condition number. The condition number itself is a measure of how sensitive the solution (the estimated parameters of your model) is to changes in the input data.</p>
<ul class="simple">
<li><p><strong>A large Inverse Condition Number (close to 1)</strong> indicates a well-conditioned problem. This is desirable and suggests that small changes in your input data will only cause small changes in the estimated parameters.</p>
<ul>
<li><p>Our result of approximately 0.177 is in a moderate range - it’s not ideal (e.g., &gt;0.5 would be better for high precision), but it’s far from problematic levels (e.g., &lt;0.01), especially for a small dataset like ours. No major numerical instability is indicated here, and the fit should be reliable for practical purposes (for practical purposes, as long as inverse condition number isn’t extremely close to zero, it’s generally acceptable).</p></li>
</ul>
</li>
<li><p><strong>A small Inverse Condition Number (close to 0)</strong> points to an ill-conditioned problem. In such cases, minor variations in the input data could lead to significant changes in the determined parameters, making the solution less reliable.</p></li>
</ul>
<p>In essence, this number helps you gauge the numerical stability and reliability of the parameter estimates provided by the Orthogonal Distance Regression (ODR) fit.</p>
</section>
<section id="reason-s-for-halting-sum-of-squares-convergence">
<h3>Reason(s) for Halting: Sum of Squares Convergence<a class="headerlink" href="#reason-s-for-halting-sum-of-squares-convergence" title="Link to this heading">#</a></h3>
<p>This indicates why the iterative fitting process stopped. The ODR algorithm works by iteratively adjusting the parameters (<code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">B</span></code> in your model) to minimize the sum of the squared weighted orthogonal distances from the data points to the fitted curve.</p>
<p>“Sum of squares convergence” means that the algorithm terminated because the improvements in the sum of squared residuals from one iteration to the next became negligibly small. This is a standard and successful stopping criterion for such optimization routines. It implies that the algorithm has found a stable solution where further adjustments to the parameters do not significantly improve the fit to the data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fit_params</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">beta</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fitted parameters (output.beta): </span><span class="si">{</span><span class="n">fit_params</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">sd_beta</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">sd_beta</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Standard deviations of the parameters (output.sd_beta): </span><span class="si">{</span><span class="n">sd_beta</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">sd_beta_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">cov_beta</span> <span class="o">*</span> <span class="n">output</span><span class="o">.</span><span class="n">res_var</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Standard deviations of the parameters (alternative calculation using cov_beta): </span><span class="si">{</span><span class="n">sd_beta_2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">inv_cond_num</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">inv_condnum</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Inverse condition number (output.inv_condnum): </span><span class="si">{</span><span class="n">inv_cond_num</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Fitted parameters (output.beta): [5.67694275e+01 9.88335260e-03]
Standard deviations of the parameters (output.sd_beta): [4.26741666e-01 2.63972932e-04]
Standard deviations of the parameters (alternative calculation using cov_beta): [4.26741666e-01 2.63972932e-04]
Inverse condition number (output.inv_condnum): 0.17698951436366908
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Store the original data in the results dictionary for plotting later</span>
<span class="n">results</span><span class="p">[</span><span class="s1">&#39;original_x&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>
<span class="n">results</span><span class="p">[</span><span class="s1">&#39;original_y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_obs</span>
<span class="n">results</span><span class="p">[</span><span class="s1">&#39;original_sigma_x&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sigma_x</span>
<span class="n">results</span><span class="p">[</span><span class="s1">&#39;original_sigma_y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sigma_y</span>
<span class="n">results</span><span class="p">[</span><span class="s1">&#39;original_weights_x&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">sigma_x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">results</span><span class="p">[</span><span class="s1">&#39;original_weights_y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">sigma_y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Store results from ODR&#39;s Output object</span>
<span class="n">results</span><span class="p">[</span><span class="s1">&#39;odr_output&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">output</span>
<span class="n">results</span><span class="p">[</span><span class="s1">&#39;fit_params&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">beta</span>
<span class="n">results</span><span class="p">[</span><span class="s1">&#39;std_errs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">sd_beta</span>
<span class="n">results</span><span class="p">[</span><span class="s1">&#39;cov_beta&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">cov_beta</span>
<span class="n">results</span><span class="p">[</span><span class="s1">&#39;number_of_observations&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">results</span><span class="p">[</span><span class="s1">&#39;number_of_parameters&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">beta</span><span class="p">)</span>
<span class="n">results</span><span class="p">[</span><span class="s1">&#39;degrees_of_freedom&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;number_of_observations&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;number_of_parameters&#39;</span><span class="p">]</span>
<span class="n">results</span><span class="p">[</span><span class="s1">&#39;inverse_condition_number&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">inv_condnum</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t_values</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;fit_params&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;std_errs&#39;</span><span class="p">]</span>
<span class="n">p_values</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">t_values</span><span class="p">),</span> <span class="n">df</span><span class="o">=</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;degrees_of_freedom&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="mi">2</span>
<span class="n">results</span><span class="p">[</span><span class="s1">&#39;t_values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t_values</span>
<span class="n">results</span><span class="p">[</span><span class="s1">&#39;p_values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">p_values</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;t-values: </span><span class="si">{</span><span class="n">t_values</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p-values: </span><span class="si">{</span><span class="n">p_values</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>t-values: [133.02996178  37.44078054]
p-values: [4.55295786e-10 2.56015184e-07]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">delta_x</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">delta</span>
<span class="n">results</span><span class="p">[</span><span class="s1">&#39;delta_x&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">delta_x</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Array of estimated errors in input variables, of same shape as x (output.delta):</span><span class="se">\n</span><span class="si">{</span><span class="n">delta_x</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">epsilon_y</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">eps</span>
<span class="n">results</span><span class="p">[</span><span class="s1">&#39;epsilon_y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">epsilon_y</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Array of estimated errors in response variables, of same shape as y (output.eps):</span><span class="se">\n</span><span class="si">{</span><span class="n">epsilon_y</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Array of estimated errors in input variables, of same shape as x (output.delta):
[ 0.          1.12128483  1.00051757 -1.82517415  0.59658578 -0.05011438
 -0.01544762]
Array of estimated errors in response variables, of same shape as y (output.eps):
[ 0.          0.15853071  0.18633185 -0.52598787  0.46385468 -0.09998956
 -0.09054455]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_pred</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">xplus</span>
<span class="n">results</span><span class="p">[</span><span class="s1">&#39;x_pred&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">xplus</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Array of predicted x values (output.xplus):</span><span class="se">\n</span><span class="si">{</span><span class="n">x_pred</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">x_pred_2</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">output</span><span class="o">.</span><span class="n">delta</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Array of predicted x values (x + output.delta):</span><span class="se">\n</span><span class="si">{</span><span class="n">x_pred_2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">y_pred</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">y</span>
<span class="n">results</span><span class="p">[</span><span class="s1">&#39;y_pred&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">y</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Array of predicted y values (output.y):</span><span class="se">\n</span><span class="si">{</span><span class="n">y_pred</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">y_pred_2</span> <span class="o">=</span> <span class="n">model_function</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;fit_params&#39;</span><span class="p">],</span> <span class="n">x</span> <span class="o">+</span> <span class="n">delta_x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Array of predicted y values (model_function with (x + delta_x) argument):</span><span class="se">\n</span><span class="si">{</span><span class="n">y_pred_2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Array of predicted x values (output.xplus):
[  0.          24.12128483  52.00051757  96.17482585 196.59658578
 291.94988562 400.98455238]
Array of predicted x values (x + output.delta):
[  0.          24.12128483  52.00051757  96.17482585 196.59658578
 291.94988562 400.98455238]

Array of predicted y values (output.y):
[100.          87.95853071  77.18633185  65.17401213  51.36385468
  46.40001044  44.30945545]
Array of predicted y values (model_function with (x + delta_x) argument):
[100.          87.95853071  77.18633185  65.17401213  51.36385468
  46.40001044  44.30945545]
</pre></div>
</div>
</div>
</div>
</section>
<section id="predicted-values-of-x-and-y">
<h3>Predicted values of x and y<a class="headerlink" href="#predicted-values-of-x-and-y" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">output.xplus</span></code> represents the “predicted” or adjusted x-values. These are computed as the original <code class="docutils literal notranslate"><span class="pre">x</span></code> plus the estimated errors/adjustments in the input variables (<code class="docutils literal notranslate"><span class="pre">output.delta</span></code>), i.e., <code class="docutils literal notranslate"><span class="pre">xplus</span> <span class="pre">=</span> <span class="pre">x</span> <span class="pre">+</span> <span class="pre">delta</span></code>. They correspond to the x-coordinates on the fitted curve that are closest (in an orthogonal sense) to each observed data point <code class="docutils literal notranslate"><span class="pre">(x[i],</span> <span class="pre">y_obs[i])</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">output.y</span></code> represents the predicted y-values, which are the model’s evaluations at those adjusted x-values: <code class="docutils literal notranslate"><span class="pre">y</span> <span class="pre">=</span> <span class="pre">model_function(beta,</span> <span class="pre">xplus)</span></code>. These are the y-coordinates on the fitted curve corresponding to the same closest points.</p></li>
</ul>
<p>Together, the pairs <code class="docutils literal notranslate"><span class="pre">(output.xplus[i],</span> <span class="pre">output.y[i])</span></code> are the projections (feet of the perpendiculars) of our observed data points onto the fitted curve. This differs from ordinary least squares regression (where errors are assumed only in y, and predictions are simply <code class="docutils literal notranslate"><span class="pre">model_function(beta,</span> <span class="pre">x)</span></code> at the original x-values). In ODR, since errors are considered in both x and y, these adjusted predictions account for uncertainties in both directions, minimizing the orthogonal distances.</p>
<p>Our code already demonstrates this equivalence with the alternative calculations:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">x_pred_2</span> <span class="pre">=</span> <span class="pre">x</span> <span class="pre">+</span> <span class="pre">output.delta</span></code> matches <code class="docutils literal notranslate"><span class="pre">output.xplus</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">y_pred_2</span> <span class="pre">=</span> <span class="pre">model_function(fit_params,</span> <span class="pre">x</span> <span class="pre">+</span> <span class="pre">delta_x)</span></code> matches <code class="docutils literal notranslate"><span class="pre">output.y</span></code>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sum_square_delta</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">sum_square_delta</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sum of squares of delta error (output.sum_square_delta): </span><span class="si">{</span><span class="n">sum_square_delta</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">delta_errors</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">delta</span>
<span class="n">manual_sum_square_delta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">delta_errors</span> <span class="o">/</span> <span class="n">sigma_x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Manually calculated sum_square_delta: </span><span class="si">{</span><span class="n">manual_sum_square_delta</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">sum_square_eps</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">sum_square_eps</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Sum of squares of epsilon error (output.sum_square_eps): </span><span class="si">{</span><span class="n">sum_square_eps</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">epsilon_errors</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">eps</span>
<span class="n">manual_sum_square_eps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">epsilon_errors</span> <span class="o">/</span> <span class="n">sigma_y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Manually calculated sum_square_eps: </span><span class="si">{</span><span class="n">manual_sum_square_eps</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sum of squares of delta error (output.sum_square_delta): 1.4871
Manually calculated sum_square_delta: 1.4871

Sum of squares of epsilon error (output.sum_square_eps): 2.2795
Manually calculated sum_square_eps: 2.2795
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sum_square</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">sum_square</span>
<span class="n">results</span><span class="p">[</span><span class="s1">&#39;chi_squared_odr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">sum_square</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Chi-squared (output.sum_square): </span><span class="si">{</span><span class="n">sum_square</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">res_var</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">res_var</span>
<span class="n">results</span><span class="p">[</span><span class="s1">&#39;reduced_chi_squared_odr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">res_var</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Reduced Chi-squared (output.res_var): </span><span class="si">{</span><span class="n">res_var</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Calculate Chi-Squared manually as per the formula</span>
<span class="c1"># ODR output provides delta (residuals in x) and eps (residuals in y)</span>
<span class="n">chi_squared_manual</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">output</span><span class="o">.</span><span class="n">delta</span> <span class="o">/</span> <span class="n">sigma_x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">eps</span> <span class="o">/</span> <span class="n">sigma_y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">results</span><span class="p">[</span><span class="s1">&#39;chi_squared_manual&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">chi_squared_manual</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Chi-squared (manual calculation): </span><span class="si">{</span><span class="n">chi_squared_manual</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Reduced Chi-Squared (manual calculation)</span>
<span class="n">reduced_chi_squared_manual</span> <span class="o">=</span> <span class="n">chi_squared_manual</span> <span class="o">/</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;degrees_of_freedom&#39;</span><span class="p">]</span>
<span class="n">results</span><span class="p">[</span><span class="s1">&#39;reduced_chi_squared_manual&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">reduced_chi_squared_manual</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Reduced Chi-squared (manual calculation): </span><span class="si">{</span><span class="n">reduced_chi_squared_manual</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chi-squared (output.sum_square): 3.7665
Reduced Chi-squared (output.res_var): 0.7533
Chi-squared (manual calculation): 3.7665
Reduced Chi-squared (manual calculation): 0.7533
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Information Criteria (using the log-likelihood for ODR, which is implicitly</span>
<span class="c1"># based on the chi-squared statistic, assuming a Gaussian error model).</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;number_of_observations&#39;</span><span class="p">]</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;number_of_parameters&#39;</span><span class="p">]</span>

<span class="c1"># A log-likelihood for ODR, based on the chi-squared value.</span>
<span class="n">llf</span> <span class="o">=</span> <span class="o">-</span> <span class="n">n</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">sigma_x</span><span class="p">))</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">sigma_y</span><span class="p">))</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;chi_squared_odr&#39;</span><span class="p">]</span>

<span class="n">aic</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">llf</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">p</span>
<span class="n">bic</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">llf</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">*</span> <span class="n">p</span>
<span class="n">aicc</span> <span class="o">=</span> <span class="n">aic</span> <span class="o">+</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">p</span> <span class="o">*</span> <span class="p">(</span><span class="n">p</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">results</span><span class="p">[</span><span class="s1">&#39;log_likelihood&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">llf</span>
<span class="n">results</span><span class="p">[</span><span class="s1">&#39;aic&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">aic</span>
<span class="n">results</span><span class="p">[</span><span class="s1">&#39;bic&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bic</span>
<span class="n">results</span><span class="p">[</span><span class="s1">&#39;aicc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">aicc</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Maximum Log-Likelihood:&#39;</span><span class="p">,</span> <span class="n">llf</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;AIC:&#39;</span><span class="p">,</span> <span class="n">aic</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;BIC:&#39;</span><span class="p">,</span> <span class="n">bic</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;AICC:&#39;</span><span class="p">,</span> <span class="n">aicc</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Maximum Log-Likelihood: -14.748413858813365
AIC: 33.49682771762673
BIC: 33.38864801573735
AICC: 36.49682771762673
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="general-methods-for-odr-analysis">
<h2>General Methods for ODR Analysis<a class="headerlink" href="#general-methods-for-odr-analysis" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.odr</span><span class="w"> </span><span class="kn">import</span> <span class="n">ODR</span><span class="p">,</span> <span class="n">Model</span><span class="p">,</span> <span class="n">RealData</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">stats</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tabulate</span><span class="w"> </span><span class="kn">import</span> <span class="n">tabulate</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="kn">import</span> <span class="n">fsolve</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">analyze_odr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_obs</span><span class="p">,</span> <span class="n">sigma_x</span><span class="p">,</span> <span class="n">sigma_y</span><span class="p">,</span> <span class="n">function</span><span class="p">,</span> <span class="n">initial_guess</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Performs an Orthogonal Distance Regression (ODR) curve fit and calculates</span>
<span class="sd">    various goodness-of-fit and error metrics.</span>

<span class="sd">    Args:</span>
<span class="sd">        x (np.array): The independent variable data.</span>
<span class="sd">        y_obs (np.array): The observed dependent variable data.</span>
<span class="sd">        sigma_x (np.array): The standard deviations of the x points.</span>
<span class="sd">        sigma_y (np.array): The standard deviations of the y_obs points.</span>
<span class="sd">        function (callable): The function to fit to the data.</span>
<span class="sd">        initial_guess (list): The initial guess for the function parameters.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A dictionary containing all the calculated results.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c1"># Define the ODR model and data</span>
    <span class="n">odr_model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">function</span><span class="p">)</span>
    <span class="n">odr_data</span> <span class="o">=</span> <span class="n">RealData</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_obs</span><span class="p">,</span> <span class="n">sx</span><span class="o">=</span><span class="n">sigma_x</span><span class="p">,</span> <span class="n">sy</span><span class="o">=</span><span class="n">sigma_y</span><span class="p">)</span>

    <span class="c1"># Instantiate and run the ODR fit</span>
    <span class="n">odr_instance</span> <span class="o">=</span> <span class="n">ODR</span><span class="p">(</span><span class="n">odr_data</span><span class="p">,</span> <span class="n">odr_model</span><span class="p">,</span> <span class="n">beta0</span><span class="o">=</span><span class="n">initial_guess</span><span class="p">)</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">odr_instance</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

    <span class="c1"># Store the original data in the results dictionary for plotting later</span>
    <span class="n">results</span><span class="p">[</span><span class="s1">&#39;original_x&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>
    <span class="n">results</span><span class="p">[</span><span class="s1">&#39;original_y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_obs</span>
    <span class="n">results</span><span class="p">[</span><span class="s1">&#39;original_sigma_x&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sigma_x</span>
    <span class="n">results</span><span class="p">[</span><span class="s1">&#39;original_sigma_y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sigma_y</span>
    <span class="n">results</span><span class="p">[</span><span class="s1">&#39;original_weights_x&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">sigma_x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">results</span><span class="p">[</span><span class="s1">&#39;original_weights_y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">sigma_y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    
    <span class="c1"># Store results from ODR&#39;s Output object</span>
    <span class="n">results</span><span class="p">[</span><span class="s1">&#39;odr_output&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">output</span>
    <span class="n">results</span><span class="p">[</span><span class="s1">&#39;fit_params&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">beta</span>
    <span class="n">results</span><span class="p">[</span><span class="s1">&#39;std_errs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">sd_beta</span>
    <span class="n">results</span><span class="p">[</span><span class="s1">&#39;cov_beta&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">cov_beta</span>
    <span class="n">results</span><span class="p">[</span><span class="s1">&#39;number_of_observations&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">results</span><span class="p">[</span><span class="s1">&#39;number_of_parameters&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">beta</span><span class="p">)</span>
    <span class="n">results</span><span class="p">[</span><span class="s1">&#39;degrees_of_freedom&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;number_of_observations&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;number_of_parameters&#39;</span><span class="p">]</span>
    <span class="n">results</span><span class="p">[</span><span class="s1">&#39;inverse_condition_number&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">inv_condnum</span>

    <span class="c1"># Calculate t-values and p-values</span>
    <span class="n">t_values</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;fit_params&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;std_errs&#39;</span><span class="p">]</span>
    <span class="n">p_values</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">t_values</span><span class="p">),</span> <span class="n">df</span><span class="o">=</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;degrees_of_freedom&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="mi">2</span>
    <span class="n">results</span><span class="p">[</span><span class="s1">&#39;t_values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t_values</span>
    <span class="n">results</span><span class="p">[</span><span class="s1">&#39;p_values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">p_values</span>

    <span class="n">results</span><span class="p">[</span><span class="s1">&#39;delta_x&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">delta</span>
    <span class="n">results</span><span class="p">[</span><span class="s1">&#39;epsilon_y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">eps</span>
    <span class="n">results</span><span class="p">[</span><span class="s1">&#39;x_pred&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">xplus</span>
    <span class="n">results</span><span class="p">[</span><span class="s1">&#39;y_pred&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">y</span>

    <span class="c1"># Chi-Squared and Reduced Chi-Squared from ODR output</span>
    <span class="n">results</span><span class="p">[</span><span class="s1">&#39;chi_squared_odr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">sum_square</span>
    <span class="n">results</span><span class="p">[</span><span class="s1">&#39;reduced_chi_squared_odr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">res_var</span>

    <span class="c1"># Information Criteria (using the log-likelihood for ODR, which is implicitly</span>
    <span class="c1"># based on the chi-squared statistic, assuming a Gaussian error model).</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;number_of_observations&#39;</span><span class="p">]</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;number_of_parameters&#39;</span><span class="p">]</span>

    <span class="c1"># A log-likelihood for ODR, based on the chi-squared value.</span>
    <span class="n">llf</span> <span class="o">=</span> <span class="o">-</span> <span class="n">n</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">sigma_x</span><span class="p">))</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">sigma_y</span><span class="p">))</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;chi_squared_odr&#39;</span><span class="p">]</span>

    <span class="n">aic</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">llf</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">p</span>
    <span class="n">bic</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">llf</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">*</span> <span class="n">p</span>
    <span class="n">aicc</span> <span class="o">=</span> <span class="n">aic</span> <span class="o">+</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">p</span> <span class="o">*</span> <span class="p">(</span><span class="n">p</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">results</span><span class="p">[</span><span class="s1">&#39;log_likelihood&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">llf</span>
    <span class="n">results</span><span class="p">[</span><span class="s1">&#39;aic&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">aic</span>
    <span class="n">results</span><span class="p">[</span><span class="s1">&#39;bic&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bic</span>
    <span class="n">results</span><span class="p">[</span><span class="s1">&#39;aicc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">aicc</span>

    <span class="k">return</span> <span class="n">results</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">print_metrics</span><span class="p">(</span><span class="n">results</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Prints the calculated metrics from the results dictionary for ODR.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;odr_output&#39;</span><span class="p">]</span>
    <span class="n">fit_params</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;fit_params&#39;</span><span class="p">]</span>
    <span class="n">std_errs</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;std_errs&#39;</span><span class="p">]</span>
    <span class="n">t_values</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;t_values&#39;</span><span class="p">]</span>
    <span class="n">p_values</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;p_values&#39;</span><span class="p">]</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;number_of_observations&#39;</span><span class="p">]</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;number_of_parameters&#39;</span><span class="p">]</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--- ODR Fit Results ---&quot;</span><span class="p">)</span>
    <span class="n">output</span><span class="o">.</span><span class="n">pprint</span><span class="p">()</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- Summary of Results ---&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">fit_params</span><span class="p">,</span> <span class="n">std_errs</span><span class="p">)):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Parameter </span><span class="si">{</span><span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">param</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2"> +/- </span><span class="si">{</span><span class="n">err</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  T-value: </span><span class="si">{</span><span class="n">t_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.8f</span><span class="si">}</span><span class="s2">, P-value: </span><span class="si">{</span><span class="n">p_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.8f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- Model Fit Statistics ---&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Number of Observations (n): </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of Parameters (p): </span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Degrees of Freedom (n-p): </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;degrees_of_freedom&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- Goodness-of-Fit &amp; Error Metrics ---&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Chi-Squared (from ODR): </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;chi_squared_odr&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Reduced Chi-Squared (from ODR): </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;reduced_chi_squared_odr&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- Information Criteria ---&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Maximum Log-Likelihood: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;log_likelihood&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;AIC (Akaike Information Criterion): </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;aic&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;BIC (Bayesian Information Criterion): </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;bic&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;AICc (Corrected AIC): </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;aicc&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- Comparison of Original and Predicted Data Points ---&quot;</span><span class="p">)</span>
    
    <span class="c1"># Unpack data points</span>
    <span class="n">x_orig</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;original_x&#39;</span><span class="p">]</span>
    <span class="n">y_orig</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;original_y&#39;</span><span class="p">]</span>
    <span class="n">x_pred</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;x_pred&#39;</span><span class="p">]</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;y_pred&#39;</span><span class="p">]</span>

    <span class="c1"># Prepare data for the table</span>
    <span class="n">comparison_data</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x_orig</span><span class="p">,</span> <span class="n">x_pred</span><span class="p">,</span> <span class="n">y_orig</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">comp_headers</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Original X&quot;</span><span class="p">,</span> <span class="s2">&quot;Predicted X (x_plus)&quot;</span><span class="p">,</span> <span class="s2">&quot;Original Y&quot;</span><span class="p">,</span> <span class="s2">&quot;Predicted Y (fit)&quot;</span><span class="p">]</span>

    <span class="c1"># Print the formatted table</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">comparison_data</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">comp_headers</span><span class="p">,</span> <span class="n">floatfmt</span><span class="o">=</span><span class="s2">&quot;.4f&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">draw_curve_fit</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">model_function</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Visualizes the ODR fit with a 95% confidence band.</span>

<span class="sd">    Args:</span>
<span class="sd">        results (dict): The dictionary returned by the analyze_odr function.</span>
<span class="sd">        model_function (callable): The model function used for the fit.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># --- 1. Unpack data from the results dictionary ---</span>
    <span class="n">x_data</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;original_x&quot;</span><span class="p">]</span>
    <span class="n">y_data</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;original_y&quot;</span><span class="p">]</span>
    <span class="n">sigma_x</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;original_sigma_x&quot;</span><span class="p">]</span>
    <span class="n">sigma_y</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;original_sigma_y&quot;</span><span class="p">]</span>
    <span class="n">popt</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;fit_params&#39;</span><span class="p">]</span>
    <span class="n">perr</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;std_errs&#39;</span><span class="p">]</span>
    <span class="n">cov_beta</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;cov_beta&#39;</span><span class="p">]</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;degrees_of_freedom&#39;</span><span class="p">]</span>
    
    <span class="c1"># --- 2. Set up the plot ---</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">set_theme</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">)</span>

    <span class="c1"># --- 3. Plot the curve fit ---</span>
    
    <span class="c1"># Plot original data with error bars</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span>
        <span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">,</span> 
        <span class="n">xerr</span><span class="o">=</span><span class="n">sigma_x</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">sigma_y</span><span class="p">,</span> 
        <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;royalblue&#39;</span><span class="p">,</span> <span class="n">ecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Original Data&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">5</span>
    <span class="p">)</span>

    <span class="c1"># Generate points for the fitted curve and confidence band</span>
    <span class="n">x_plot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">x_data</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">x_data</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.05</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>
    <span class="n">y_plot</span> <span class="o">=</span> <span class="n">model_function</span><span class="p">(</span><span class="n">popt</span><span class="p">,</span> <span class="n">x_plot</span><span class="p">)</span>
    
    <span class="c1"># --- 4. Calculate and plot the 95% confidence band ---</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">jacobian</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="n">beta</span>
        <span class="c1"># Partial derivatives of the model function w.r.t. parameters A and B</span>
        <span class="n">d_dA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">B</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">d_dB</span> <span class="o">=</span> <span class="o">-</span><span class="n">A</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">B</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">d_dA</span><span class="p">,</span> <span class="n">d_dB</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
        
    <span class="n">J</span> <span class="o">=</span> <span class="n">jacobian</span><span class="p">(</span><span class="n">popt</span><span class="p">,</span> <span class="n">x_plot</span><span class="p">)</span>
    <span class="c1"># Variance of the predicted y values</span>
    <span class="n">var_y_plot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">J</span> <span class="o">@</span> <span class="n">cov_beta</span> <span class="o">*</span> <span class="n">J</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="c1"># Standard error of the predicted y values</span>
    <span class="n">se_y_plot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">var_y_plot</span><span class="p">)</span>
    
    <span class="c1"># Get the critical t-value for 95% confidence</span>
    <span class="n">t_val</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.975</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span>
    
    <span class="c1"># Confidence interval half-width</span>
    <span class="n">ci</span> <span class="o">=</span> <span class="n">t_val</span> <span class="o">*</span> <span class="n">se_y_plot</span>
    
    <span class="c1"># Plot the confidence band</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
        <span class="n">x_plot</span><span class="p">,</span> <span class="n">y_plot</span> <span class="o">-</span> <span class="n">ci</span><span class="p">,</span> <span class="n">y_plot</span> <span class="o">+</span> <span class="n">ci</span><span class="p">,</span> 
        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;95% Confidence Band&quot;</span>
    <span class="p">)</span>

    <span class="c1"># Plot the fitted curve</span>
    <span class="n">label_text</span> <span class="o">=</span> <span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;ODR Fitted Curve</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;A=</span><span class="si">{</span><span class="n">popt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> ± </span><span class="si">{</span><span class="n">perr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;B=</span><span class="si">{</span><span class="n">popt</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2"> ± </span><span class="si">{</span><span class="n">perr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_plot</span><span class="p">,</span> <span class="n">y_plot</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label_text</span><span class="p">)</span>

    <span class="c1"># --- 5. Configure title, labels, and final layout ---</span>
    <span class="n">title</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Orthogonal Distance Regression (ODR) Fit</span><span class="se">\n</span><span class="s2">Reduced $</span><span class="se">\\</span><span class="s2">chi^2$ = </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;reduced_chi_squared_odr&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;X-Value&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Y-Value&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">xmin</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">x_data</span><span class="p">)</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ymin</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">y_data</span><span class="p">)</span> <span class="o">-</span> <span class="mi">10</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">y_data</span><span class="p">)</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_predicted_vs_observed</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">show_errors</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates scatter plots to compare observed vs. predicted values for x and y,</span>
<span class="sd">    with an option to display error bars for both observed and predicted values.</span>

<span class="sd">    Args:</span>
<span class="sd">        results (dict): The dictionary returned by the analyze_odr function.</span>
<span class="sd">        show_errors (bool): If True, displays error bars on the plots. </span>
<span class="sd">                            The results dict must contain &#39;sd_xplus&#39; and &#39;sd_y&#39;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># --- 1. Unpack the required data from the results dictionary ---</span>
    <span class="n">x_obs</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;original_x&#39;</span><span class="p">]</span>
    <span class="n">y_obs</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;original_y&#39;</span><span class="p">]</span>
    <span class="n">x_pred</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;x_pred&#39;</span><span class="p">]</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;y_pred&#39;</span><span class="p">]</span>

    <span class="c1"># --- 2. Set up the figure with two subplots ---</span>
    <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">set_theme</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">)</span>
    
    <span class="c1"># --- 3. First subplot: Observed X vs. Predicted X ---</span>
    <span class="k">if</span> <span class="n">show_errors</span><span class="p">:</span>
        <span class="n">sigma_x</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;original_sigma_x&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">sigma_x</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning: &#39;original_sigma_x&#39; not in results. Cannot plot predicted X errors.&quot;</span><span class="p">)</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_obs</span><span class="p">,</span> <span class="n">x_pred</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;royalblue&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Data Points&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span>
                <span class="n">x_obs</span><span class="p">,</span> <span class="n">x_pred</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">sigma_x</span><span class="p">,</span>
                <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">ecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;royalblue&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Data Points&#39;</span>
            <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_obs</span><span class="p">,</span> <span class="n">x_pred</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;royalblue&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Data Points&#39;</span><span class="p">)</span>

    <span class="c1"># Create the line of identity (y=x)</span>
    <span class="n">lims_x</span> <span class="o">=</span> <span class="p">[</span>
        <span class="nb">min</span><span class="p">(</span><span class="n">ax1</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ax1</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">min</span><span class="p">(</span><span class="n">x_obs</span><span class="p">),</span> <span class="nb">min</span><span class="p">(</span><span class="n">x_pred</span><span class="p">)),</span>
        <span class="nb">max</span><span class="p">(</span><span class="n">ax1</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ax1</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">max</span><span class="p">(</span><span class="n">x_obs</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">x_pred</span><span class="p">)),</span>
    <span class="p">]</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lims_x</span><span class="p">,</span> <span class="n">lims_x</span><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Identity Line&#39;</span><span class="p">)</span>
    
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Predicted X vs. Observed X&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Observed X Values (with measurement error)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Predicted X Values (with prediction error)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="c1"># --- 4. Second subplot: Observed Y vs. Predicted Y ---</span>
    <span class="k">if</span> <span class="n">show_errors</span><span class="p">:</span>
        <span class="n">sigma_y</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;original_sigma_y&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">sigma_y</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning: &#39;original_sigma_y&#39; not in results. Cannot plot predicted Y errors.&quot;</span><span class="p">)</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">y_obs</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Data Points&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span>
                <span class="n">y_obs</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">sigma_y</span><span class="p">,</span>
                <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">ecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Data Points&#39;</span>
            <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">y_obs</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Data Points&#39;</span><span class="p">)</span>
    
    <span class="c1"># Create the line of identity</span>
    <span class="n">lims_y</span> <span class="o">=</span> <span class="p">[</span>
        <span class="nb">min</span><span class="p">(</span><span class="n">ax2</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ax2</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">min</span><span class="p">(</span><span class="n">y_obs</span><span class="p">),</span> <span class="nb">min</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)),</span>
        <span class="nb">max</span><span class="p">(</span><span class="n">ax2</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ax2</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">max</span><span class="p">(</span><span class="n">y_obs</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)),</span>
    <span class="p">]</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lims_y</span><span class="p">,</span> <span class="n">lims_y</span><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Identity Line&#39;</span><span class="p">)</span>
    
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Predicted Y vs. Observed Y&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Observed Y Values (with measurement error)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Predicted Y Values (with prediction error)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    
    <span class="c1"># --- 5. Final adjustments and display ---</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Comparison of Observed and ODR-Predicted Values&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.02</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">find_y_intercept</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">model_function</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Finds the x-value where the fitted model function intersects the y=0 line.</span>

<span class="sd">    Args:</span>
<span class="sd">        results (dict): The dictionary returned by the analyze_odr function.</span>
<span class="sd">        model_function (callable): The model function used for the fit.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Extract the fitted parameters</span>
    <span class="n">fit_params</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fit_params&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">fit_params</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: &#39;fit_params&#39; not found in the results dictionary.&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="c1"># Define the function for which we want to find the root (i.e., where model_function(x) = 0)</span>
    <span class="n">func_to_solve</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">model_function</span><span class="p">(</span><span class="n">fit_params</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

    <span class="c1"># Provide an initial guess for the root-finding algorithm.</span>
    <span class="n">initial_guess_x</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;original_x&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">])[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># Use fsolve to find the root</span>
    <span class="n">x_intercept</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">ier</span><span class="p">,</span> <span class="n">msg</span> <span class="o">=</span> <span class="n">fsolve</span><span class="p">(</span><span class="n">func_to_solve</span><span class="p">,</span> <span class="n">initial_guess_x</span><span class="p">,</span> <span class="n">full_output</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Check if a solution was found (ier=1 indicates success)</span>
    <span class="k">if</span> <span class="n">ier</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">y_at_intercept</span> <span class="o">=</span> <span class="n">func_to_solve</span><span class="p">(</span><span class="n">x_intercept</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">y_at_intercept</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- Y=0 Intercept Analysis ---&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The model function intersects the y=0 line at x = </span><span class="si">{</span><span class="n">x_intercept</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">x_intercept</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- Y=0 Intercept Analysis ---&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;A solution was found, but the y-value at this x is not close to 0.&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;x = </span><span class="si">{</span><span class="n">x_intercept</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, y = </span><span class="si">{</span><span class="n">y_at_intercept</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- Y=0 Intercept Analysis ---&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The root-finding algorithm did not converge to a solution.&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Message from fsolve: </span><span class="si">{</span><span class="n">msg</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="usage-of-methods-dataset-3">
<h2>Usage of Methods. Dataset 3<a class="headerlink" href="#usage-of-methods-dataset-3" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">model_function</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The custom function to approximate the data.</span>
<span class="sd">    f(x; A, B) = A * (np.exp(-B * x) - 1) + 100</span>
<span class="sd">    Note: The signature is now (beta, x) for scipy.odr.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="n">beta</span>
    <span class="k">return</span> <span class="n">A</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">B</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">100</span>

<span class="c1"># Dataset 3</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">196</span><span class="p">,</span> <span class="mi">292</span><span class="p">,</span> <span class="mi">401</span><span class="p">])</span>
<span class="n">y_obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mf">87.8</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mf">65.7</span><span class="p">,</span> <span class="mf">50.9</span><span class="p">,</span> <span class="mf">46.5</span><span class="p">,</span> <span class="mf">44.4</span><span class="p">])</span>
<span class="n">sigma_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">y_obs</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">sigma_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">sigma_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">initial_guess</span> <span class="o">=</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">]</span>

<span class="c1"># Analyze the curve fit and get results using ODR</span>
<span class="n">odr_results</span> <span class="o">=</span> <span class="n">analyze_odr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_obs</span><span class="p">,</span> <span class="n">sigma_x</span><span class="p">,</span> <span class="n">sigma_y</span><span class="p">,</span> <span class="n">model_function</span><span class="p">,</span> <span class="n">initial_guess</span><span class="p">)</span>

<span class="c1"># Print the metrics</span>
<span class="n">print_metrics</span><span class="p">(</span><span class="n">odr_results</span><span class="p">)</span>

<span class="c1"># Draw the curve fit plot</span>
<span class="n">draw_curve_fit</span><span class="p">(</span><span class="n">odr_results</span><span class="p">,</span> <span class="n">model_function</span><span class="p">)</span>

<span class="c1"># Plot predicted vs observed values</span>
<span class="n">plot_predicted_vs_observed</span><span class="p">(</span><span class="n">odr_results</span><span class="p">,</span> <span class="n">show_errors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Find the y=0 intercept</span>
<span class="n">find_y_intercept</span><span class="p">(</span><span class="n">odr_results</span><span class="p">,</span> <span class="n">model_function</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- ODR Fit Results ---
Beta: [5.67694275e+01 9.88335260e-03]
Beta Std Error: [4.26741666e-01 2.63972932e-04]
Beta Covariance: [[ 2.41744445e-01 -1.18588964e-04]
 [-1.18588964e-04  9.25007382e-08]]
Residual Variance: 0.7533097575791786
Inverse Condition #: 0.17698951436366908
Reason(s) for Halting:
  Sum of squares convergence

--- Summary of Results ---
Parameter A: 56.76943 +/- 0.42674
  T-value: 133.02996178, P-value: 0.00000000
Parameter B: 0.00988 +/- 0.00026
  T-value: 37.44078054, P-value: 0.00000026

--- Model Fit Statistics ---

Number of Observations (n): 7
Number of Parameters (p): 2
Degrees of Freedom (n-p): 5

--- Goodness-of-Fit &amp; Error Metrics ---
Chi-Squared (from ODR): 3.7665
Reduced Chi-Squared (from ODR): 0.7533

--- Information Criteria ---
Maximum Log-Likelihood: -14.7484
AIC (Akaike Information Criterion): 33.4968
BIC (Bayesian Information Criterion): 33.3886
AICc (Corrected AIC): 36.4968

--- Comparison of Original and Predicted Data Points ---
  Original X    Predicted X (x_plus)    Original Y    Predicted Y (fit)
------------  ----------------------  ------------  -------------------
      0.0000                  0.0000      100.0000             100.0000
     23.0000                 24.1213       87.8000              87.9585
     51.0000                 52.0005       77.0000              77.1863
     98.0000                 96.1748       65.7000              65.1740
    196.0000                196.5966       50.9000              51.3639
    292.0000                291.9499       46.5000              46.4000
    401.0000                400.9846       44.4000              44.3095
</pre></div>
</div>
<img alt="../_images/cf409d832dfb4f790be76427367f8e0d9f90b3c2a4e9a5ec375218a6e622824a.png" src="../_images/cf409d832dfb4f790be76427367f8e0d9f90b3c2a4e9a5ec375218a6e622824a.png" />
<img alt="../_images/b4b344a680859e9af19998aae9c7761a51b7270acf95d50796402059ceb53490.png" src="../_images/b4b344a680859e9af19998aae9c7761a51b7270acf95d50796402059ceb53490.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Y=0 Intercept Analysis ---
The root-finding algorithm did not converge to a solution.
Message from fsolve: The iteration is not making good progress, as measured by the 
 improvement from the last ten iterations.
</pre></div>
</div>
</div>
</div>
</section>
<section id="usage-of-methods-dataset-1">
<h2>Usage of Methods. Dataset 1<a class="headerlink" href="#usage-of-methods-dataset-1" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">model_function</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The custom function to approximate the data.</span>
<span class="sd">    f(x; A, B) = A * (np.exp(-B * x) - 1) + 100</span>
<span class="sd">    Note: The signature is now (beta, x) for scipy.odr.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="n">beta</span>
    <span class="k">return</span> <span class="n">A</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">B</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">100</span>

<span class="c1"># Dataset 1</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">97</span><span class="p">])</span>
<span class="n">y_obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mf">79.7</span><span class="p">,</span> <span class="mf">51.3</span><span class="p">,</span> <span class="mf">44.6</span><span class="p">,</span> <span class="mf">39.8</span><span class="p">,</span> <span class="mf">29.9</span><span class="p">,</span> <span class="mf">10.3</span><span class="p">])</span>
<span class="n">sigma_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">y_obs</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">sigma_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">initial_guess</span> <span class="o">=</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">]</span>

<span class="c1"># Analyze the curve fit and get results using ODR</span>
<span class="n">odr_results</span> <span class="o">=</span> <span class="n">analyze_odr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_obs</span><span class="p">,</span> <span class="n">sigma_x</span><span class="p">,</span> <span class="n">sigma_y</span><span class="p">,</span> <span class="n">model_function</span><span class="p">,</span> <span class="n">initial_guess</span><span class="p">)</span>

<span class="c1"># Print the metrics</span>
<span class="n">print_metrics</span><span class="p">(</span><span class="n">odr_results</span><span class="p">)</span>

<span class="c1"># Draw the curve fit plot</span>
<span class="n">draw_curve_fit</span><span class="p">(</span><span class="n">odr_results</span><span class="p">,</span> <span class="n">model_function</span><span class="p">)</span>

<span class="c1"># Plot predicted vs observed values</span>
<span class="n">plot_predicted_vs_observed</span><span class="p">(</span><span class="n">odr_results</span><span class="p">,</span> <span class="n">show_errors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Find the y=0 intercept</span>
<span class="n">find_y_intercept</span><span class="p">(</span><span class="n">odr_results</span><span class="p">,</span> <span class="n">model_function</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- ODR Fit Results ---
Beta: [1.00575020e+02 2.26572259e-02]
Beta Std Error: [3.44395956e+00 2.13548845e-03]
Beta Covariance: [[ 3.79384260e+00 -2.19447013e-03]
 [-2.19447013e-03  1.45867210e-06]]
Residual Variance: 3.126344114120784
Inverse Condition #: 0.09653487400105343
Reason(s) for Halting:
  Sum of squares convergence

--- Summary of Results ---
Parameter A: 100.57502 +/- 3.44396
  T-value: 29.20331044, P-value: 0.00000088
Parameter B: 0.02266 +/- 0.00214
  T-value: 10.60985645, P-value: 0.00012861

--- Model Fit Statistics ---

Number of Observations (n): 7
Number of Parameters (p): 2
Degrees of Freedom (n-p): 5

--- Goodness-of-Fit &amp; Error Metrics ---
Chi-Squared (from ODR): 15.6317
Reduced Chi-Squared (from ODR): 3.1263

--- Information Criteria ---
Maximum Log-Likelihood: -20.6810
AIC (Akaike Information Criterion): 45.3620
BIC (Bayesian Information Criterion): 45.2538
AICc (Corrected AIC): 48.3620

--- Comparison of Original and Predicted Data Points ---
  Original X    Predicted X (x_plus)    Original Y    Predicted Y (fit)
------------  ----------------------  ------------  -------------------
      0.0000                  0.0000      100.0000             100.0000
      5.0000                  9.8588       79.7000              79.8666
     25.0000                 29.0394       51.3000              51.5139
     34.0000                 35.2503       44.6000              44.6762
     42.0000                 40.4024       39.8000              39.6906
     57.0000                 53.2045       29.9000              29.5525
     97.0000                 97.5863       10.3000              10.4467
</pre></div>
</div>
<img alt="../_images/6517a316da2ca14b0ea5598cc1450269fa1ba0ee00880196e435620b85122723.png" src="../_images/6517a316da2ca14b0ea5598cc1450269fa1ba0ee00880196e435620b85122723.png" />
<img alt="../_images/aeb2999b2e4f6b8a6f145480f8d772e2c0680833acd410e4cb70e2286ace3463.png" src="../_images/aeb2999b2e4f6b8a6f145480f8d772e2c0680833acd410e4cb70e2286ace3463.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Y=0 Intercept Analysis ---
The model function intersects the y=0 line at x = 227.9297
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.float64(227.92966183998524)
</pre></div>
</div>
</div>
</div>
<p>NOTE: Second point in the dataset 1 looks like an outlier. Let’s try to get rid of it and see what happends</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">model_function</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The custom function to approximate the data.</span>
<span class="sd">    f(x; A, B) = A * (np.exp(-B * x) - 1) + 100</span>
<span class="sd">    Note: The signature is now (beta, x) for scipy.odr.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="n">beta</span>
    <span class="k">return</span> <span class="n">A</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">B</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">100</span>

<span class="c1"># Dataset 1</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">97</span><span class="p">])</span>
<span class="n">y_obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mf">51.3</span><span class="p">,</span> <span class="mf">44.6</span><span class="p">,</span> <span class="mf">39.8</span><span class="p">,</span> <span class="mf">29.9</span><span class="p">,</span> <span class="mf">10.3</span><span class="p">])</span>
<span class="n">sigma_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">y_obs</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">sigma_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">initial_guess</span> <span class="o">=</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">]</span>

<span class="c1"># Analyze the curve fit and get results using ODR</span>
<span class="n">odr_results</span> <span class="o">=</span> <span class="n">analyze_odr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_obs</span><span class="p">,</span> <span class="n">sigma_x</span><span class="p">,</span> <span class="n">sigma_y</span><span class="p">,</span> <span class="n">model_function</span><span class="p">,</span> <span class="n">initial_guess</span><span class="p">)</span>

<span class="c1"># Print the metrics</span>
<span class="n">print_metrics</span><span class="p">(</span><span class="n">odr_results</span><span class="p">)</span>

<span class="c1"># Draw the curve fit plot</span>
<span class="n">draw_curve_fit</span><span class="p">(</span><span class="n">odr_results</span><span class="p">,</span> <span class="n">model_function</span><span class="p">)</span>

<span class="c1"># Plot predicted vs observed values</span>
<span class="n">plot_predicted_vs_observed</span><span class="p">(</span><span class="n">odr_results</span><span class="p">,</span> <span class="n">show_errors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Find the y=0 intercept</span>
<span class="n">find_y_intercept</span><span class="p">(</span><span class="n">odr_results</span><span class="p">,</span> <span class="n">model_function</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- ODR Fit Results ---
Beta: [1.01238423e+02 2.21835073e-02]
Beta Std Error: [3.17336235e+00 1.87352093e-03]
Beta Covariance: [[ 4.26076480e+00 -2.35925733e-03]
 [-2.35925733e-03  1.48513294e-06]]
Residual Variance: 2.3634791135669273
Inverse Condition #: 0.09638301867431867
Reason(s) for Halting:
  Sum of squares convergence

--- Summary of Results ---
Parameter A: 101.23842 +/- 3.17336
  T-value: 31.90257270, P-value: 0.00000575
Parameter B: 0.02218 +/- 0.00187
  T-value: 11.84054418, P-value: 0.00029127

--- Model Fit Statistics ---

Number of Observations (n): 6
Number of Parameters (p): 2
Degrees of Freedom (n-p): 4

--- Goodness-of-Fit &amp; Error Metrics ---
Chi-Squared (from ODR): 9.4539
Reduced Chi-Squared (from ODR): 2.3635

--- Information Criteria ---
Maximum Log-Likelihood: -15.7542
AIC (Akaike Information Criterion): 35.5084
BIC (Bayesian Information Criterion): 35.0920
AICc (Corrected AIC): 39.5084

--- Comparison of Original and Predicted Data Points ---
  Original X    Predicted X (x_plus)    Original Y    Predicted Y (fit)
------------  ----------------------  ------------  -------------------
      0.0000                  0.0000      100.0000             100.0000
     25.0000                 29.3688       51.3000              51.5332
     34.0000                 35.6206       44.6000              44.6994
     42.0000                 40.7956       39.8000              39.7171
     57.0000                 53.6012       29.9000              29.5894
     97.0000                 97.4646       10.3000              10.4123
</pre></div>
</div>
<img alt="../_images/a229565e2916a61160644a43472bf6c67d99d55553b1aadc94b0e327fcd15257.png" src="../_images/a229565e2916a61160644a43472bf6c67d99d55553b1aadc94b0e327fcd15257.png" />
<img alt="../_images/7fd0660f65aaf63781e271568bf2375b473c83b5d3bd3006ae626db48ba14dbb.png" src="../_images/7fd0660f65aaf63781e271568bf2375b473c83b5d3bd3006ae626db48ba14dbb.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Y=0 Intercept Analysis ---
The model function intersects the y=0 line at x = 198.5096
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.float64(198.50961230212994)
</pre></div>
</div>
</div>
</div>
<p>This is an interesting result. Reduced <span class="math notranslate nohighlight">\(\chi^2\)</span> is lower than before. Also, <code class="docutils literal notranslate"><span class="pre">A</span></code> value is greater than 100, which means that at some specific x-value, the function can reach zero y-value, which will be an important result for us.</p>
<p>Let’s increase <code class="docutils literal notranslate"><span class="pre">sigma_x</span></code> from 2.0 to 3.0</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">model_function</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The custom function to approximate the data.</span>
<span class="sd">    f(x; A, B) = A * (np.exp(-B * x) - 1) + 100</span>
<span class="sd">    Note: The signature is now (beta, x) for scipy.odr.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="n">beta</span>
    <span class="k">return</span> <span class="n">A</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">B</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">100</span>

<span class="c1"># Dataset 1</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">97</span><span class="p">])</span>
<span class="n">y_obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mf">51.3</span><span class="p">,</span> <span class="mf">44.6</span><span class="p">,</span> <span class="mf">39.8</span><span class="p">,</span> <span class="mf">29.9</span><span class="p">,</span> <span class="mf">10.3</span><span class="p">])</span>
<span class="n">sigma_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">y_obs</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">sigma_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">initial_guess</span> <span class="o">=</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">]</span>

<span class="c1"># Analyze the curve fit and get results using ODR</span>
<span class="n">odr_results</span> <span class="o">=</span> <span class="n">analyze_odr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_obs</span><span class="p">,</span> <span class="n">sigma_x</span><span class="p">,</span> <span class="n">sigma_y</span><span class="p">,</span> <span class="n">model_function</span><span class="p">,</span> <span class="n">initial_guess</span><span class="p">)</span>

<span class="c1"># Print the metrics</span>
<span class="n">print_metrics</span><span class="p">(</span><span class="n">odr_results</span><span class="p">)</span>

<span class="c1"># Draw the curve fit plot</span>
<span class="n">draw_curve_fit</span><span class="p">(</span><span class="n">odr_results</span><span class="p">,</span> <span class="n">model_function</span><span class="p">)</span>

<span class="c1"># Plot predicted vs observed values</span>
<span class="n">plot_predicted_vs_observed</span><span class="p">(</span><span class="n">odr_results</span><span class="p">,</span> <span class="n">show_errors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Find the y=0 intercept</span>
<span class="n">find_y_intercept</span><span class="p">(</span><span class="n">odr_results</span><span class="p">,</span> <span class="n">model_function</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- ODR Fit Results ---
Beta: [1.01416469e+02 2.20950319e-02]
Beta Std Error: [2.98965533e+00 1.82309451e-03]
Beta Covariance: [[ 8.14786441e+00 -4.68628407e-03]
 [-4.68628407e-03  3.02984153e-06]]
Residual Variance: 1.0969793452965853
Inverse Condition #: 0.08953668330298414
Reason(s) for Halting:
  Sum of squares convergence

--- Summary of Results ---
Parameter A: 101.41647 +/- 2.98966
  T-value: 33.92246188, P-value: 0.00000450
Parameter B: 0.02210 +/- 0.00182
  T-value: 12.11952087, P-value: 0.00026592

--- Model Fit Statistics ---

Number of Observations (n): 6
Number of Parameters (p): 2
Degrees of Freedom (n-p): 4

--- Goodness-of-Fit &amp; Error Metrics ---
Chi-Squared (from ODR): 4.3879
Reduced Chi-Squared (from ODR): 1.0970

--- Information Criteria ---
Maximum Log-Likelihood: -15.6540
AIC (Akaike Information Criterion): 35.3080
BIC (Bayesian Information Criterion): 34.8915
AICc (Corrected AIC): 39.3080

--- Comparison of Original and Predicted Data Points ---
  Original X    Predicted X (x_plus)    Original Y    Predicted Y (fit)
------------  ----------------------  ------------  -------------------
      0.0000                  0.0000      100.0000             100.0000
     25.0000                 29.5211       51.3000              51.4076
     34.0000                 35.7192       44.6000              44.6469
     42.0000                 40.7917       39.8000              39.7631
     57.0000                 53.3942       29.9000              29.7546
     97.0000                 97.4816       10.3000              10.3514
</pre></div>
</div>
<img alt="../_images/f9fb8f7db779cbada4a9bca05ca34142d182d071ac5ef19380920ed1beae89a7.png" src="../_images/f9fb8f7db779cbada4a9bca05ca34142d182d071ac5ef19380920ed1beae89a7.png" />
<img alt="../_images/f79cd7199536752d05398c894ef76c07003e02e38b9248931f450ba148cef187.png" src="../_images/f79cd7199536752d05398c894ef76c07003e02e38b9248931f450ba148cef187.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Y=0 Intercept Analysis ---
The model function intersects the y=0 line at x = 193.3045
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.float64(193.30447235609964)
</pre></div>
</div>
</div>
</div>
<p>This is also an interesting result. Reduced <span class="math notranslate nohighlight">\(\chi^2\)</span> is lower and close to 1.0 which is very good. <code class="docutils literal notranslate"><span class="pre">A</span></code> value remains to be greater than 100, which means that at some specific x-value, the function can reach zero y-value, which will be an important result for us.</p>
<section id="improved-model-function">
<h3>Improved model function<a class="headerlink" href="#improved-model-function" title="Link to this heading">#</a></h3>
<p>Let’s start from scratch and try to connect to the results from Dataset 3, so our function will be</p>
<div class="math notranslate nohighlight">
\[f(x, A, B) = A_1 (\exp (-B_1 x) - 1) + A (\exp(-B x) - 1) + 100 \]</div>
<p>where A_1 and B_1 are defined from the ODR of Dataset 3 using a function <span class="math notranslate nohighlight">\(f(x, A, B) = A (\exp(-B x) - 1) + 100 \)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">model_function</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The custom function to approximate the data.</span>
<span class="sd">    f(x, A, B) = A_1 * (np.exp(-B_1 * x) - 1) + A * (np.exp(-B * x) - 1) + 100</span>
<span class="sd">    Note: The signature is now (beta, x) for scipy.odr.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">A_1</span> <span class="o">=</span> <span class="mf">56.769</span> <span class="c1"># obtained from Dataset 3 with sigma_x = 2.0, sigma_y = 0.5</span>
    <span class="n">B_1</span> <span class="o">=</span> <span class="mf">0.00988</span> <span class="c1"># obtained from Dataset 3 with sigma_x = 2.0, sigma_y = 0.5</span>

    <span class="c1"># A_1 = 56.747 # obtained from Dataset 3 with sigma_x = 3.0, sigma_y = 0.5</span>
    <span class="c1"># B_1 = 0.00991 # obtained from Dataset 3 with sigma_x = 3.0, sigma_y = 0.5</span>

    <span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="n">beta</span>
    
    <span class="k">return</span> <span class="n">A_1</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">B_1</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">A</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">B</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">100</span>

<span class="c1"># Dataset 1</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">97</span><span class="p">])</span>
<span class="n">y_obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mf">79.7</span><span class="p">,</span> <span class="mf">51.3</span><span class="p">,</span> <span class="mf">44.6</span><span class="p">,</span> <span class="mf">39.8</span><span class="p">,</span> <span class="mf">29.9</span><span class="p">,</span> <span class="mf">10.3</span><span class="p">])</span>
<span class="n">sigma_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">y_obs</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">sigma_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">initial_guess</span> <span class="o">=</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">]</span>

<span class="c1"># Analyze the curve fit and get results using ODR</span>
<span class="n">odr_results</span> <span class="o">=</span> <span class="n">analyze_odr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_obs</span><span class="p">,</span> <span class="n">sigma_x</span><span class="p">,</span> <span class="n">sigma_y</span><span class="p">,</span> <span class="n">model_function</span><span class="p">,</span> <span class="n">initial_guess</span><span class="p">)</span>

<span class="c1"># Print the metrics</span>
<span class="n">print_metrics</span><span class="p">(</span><span class="n">odr_results</span><span class="p">)</span>

<span class="c1"># Draw the curve fit plot</span>
<span class="n">draw_curve_fit</span><span class="p">(</span><span class="n">odr_results</span><span class="p">,</span> <span class="n">model_function</span><span class="p">)</span>

<span class="c1"># Plot predicted vs observed values</span>
<span class="n">plot_predicted_vs_observed</span><span class="p">(</span><span class="n">odr_results</span><span class="p">,</span> <span class="n">show_errors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Find the y=0 intercept</span>
<span class="n">find_y_intercept</span><span class="p">(</span><span class="n">odr_results</span><span class="p">,</span> <span class="n">model_function</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- ODR Fit Results ---
Beta: [5.64837483e+01 3.34000206e-02]
Beta Std Error: [1.85220408 0.00404159]
Beta Covariance: [[ 1.37387692e+00 -2.48458954e-03]
 [-2.48458954e-03  6.54144342e-06]]
Residual Variance: 2.497064990325722
Inverse Condition #: 0.04982581594705908
Reason(s) for Halting:
  Sum of squares convergence

--- Summary of Results ---
Parameter A: 56.48375 +/- 1.85220
  T-value: 30.49542373, P-value: 0.00000071
Parameter B: 0.03340 +/- 0.00404
  T-value: 8.26408960, P-value: 0.00042316

--- Model Fit Statistics ---

Number of Observations (n): 7
Number of Parameters (p): 2
Degrees of Freedom (n-p): 5

--- Goodness-of-Fit &amp; Error Metrics ---
Chi-Squared (from ODR): 12.4853
Reduced Chi-Squared (from ODR): 2.4971

--- Information Criteria ---
Maximum Log-Likelihood: -19.1078
AIC (Akaike Information Criterion): 42.2156
BIC (Bayesian Information Criterion): 42.1074
AICc (Corrected AIC): 45.2156

--- Comparison of Original and Predicted Data Points ---
  Original X    Predicted X (x_plus)    Original Y    Predicted Y (fit)
------------  ----------------------  ------------  -------------------
      0.0000                  0.0000      100.0000             100.0000
      5.0000                  9.3481       79.7000              79.8436
     25.0000                 28.4156       51.3000              51.4850
     34.0000                 34.8140       44.6000              44.6515
     42.0000                 40.1873       39.8000              39.6698
     57.0000                 53.6460       29.9000              29.5748
     97.0000                 97.8532       10.3000              10.4870
</pre></div>
</div>
<img alt="../_images/8a819174c93580380886aaac2b38a24d6740d01b14838f39a062148f83dcf9b3.png" src="../_images/8a819174c93580380886aaac2b38a24d6740d01b14838f39a062148f83dcf9b3.png" />
<img alt="../_images/e6bae6820b511f32b716245c61e8f18fc673ee53800122cee73b54471ff52440.png" src="../_images/e6bae6820b511f32b716245c61e8f18fc673ee53800122cee73b54471ff52440.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Y=0 Intercept Analysis ---
The model function intersects the y=0 line at x = 150.1501
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.float64(150.15007331599014)
</pre></div>
</div>
</div>
</div>
<p>After changing the model function, we obtained reduced <span class="math notranslate nohighlight">\(\chi^2\)</span> value which is close to the case where we used previous model function and excluded second point as outlier.</p>
<p>Let’s increase the value of <code class="docutils literal notranslate"><span class="pre">sigma_x</span></code> from 2.0 to 3.0.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">model_function</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The custom function to approximate the data.</span>
<span class="sd">    f(x, A, B) = A_1 * (np.exp(-B_1 * x) - 1) + A * (np.exp(-B * x) - 1) + 100</span>
<span class="sd">    Note: The signature is now (beta, x) for scipy.odr.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">A_1</span> <span class="o">=</span> <span class="mf">56.769</span> <span class="c1"># obtained from Dataset 3 with sigma_x = 2.0, sigma_y = 0.5</span>
    <span class="n">B_1</span> <span class="o">=</span> <span class="mf">0.00988</span> <span class="c1"># obtained from Dataset 3 with sigma_x = 2.0, sigma_y = 0.5</span>

    <span class="c1"># A_1 = 56.747 # obtained from Dataset 3 with sigma_x = 3.0, sigma_y = 0.5</span>
    <span class="c1"># B_1 = 0.00991 # obtained from Dataset 3 with sigma_x = 3.0, sigma_y = 0.5</span>

    <span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="n">beta</span>
    
    <span class="k">return</span> <span class="n">A_1</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">B_1</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">A</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">B</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">100</span>

<span class="c1"># Dataset 1</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">97</span><span class="p">])</span>
<span class="n">y_obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mf">79.7</span><span class="p">,</span> <span class="mf">51.3</span><span class="p">,</span> <span class="mf">44.6</span><span class="p">,</span> <span class="mf">39.8</span><span class="p">,</span> <span class="mf">29.9</span><span class="p">,</span> <span class="mf">10.3</span><span class="p">])</span>
<span class="n">sigma_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">y_obs</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">sigma_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">initial_guess</span> <span class="o">=</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">]</span>

<span class="c1"># Analyze the curve fit and get results using ODR</span>
<span class="n">odr_results</span> <span class="o">=</span> <span class="n">analyze_odr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_obs</span><span class="p">,</span> <span class="n">sigma_x</span><span class="p">,</span> <span class="n">sigma_y</span><span class="p">,</span> <span class="n">model_function</span><span class="p">,</span> <span class="n">initial_guess</span><span class="p">)</span>

<span class="c1"># Print the metrics</span>
<span class="n">print_metrics</span><span class="p">(</span><span class="n">odr_results</span><span class="p">)</span>

<span class="c1"># Draw the curve fit plot</span>
<span class="n">draw_curve_fit</span><span class="p">(</span><span class="n">odr_results</span><span class="p">,</span> <span class="n">model_function</span><span class="p">)</span>

<span class="c1"># Plot predicted vs observed values</span>
<span class="n">plot_predicted_vs_observed</span><span class="p">(</span><span class="n">odr_results</span><span class="p">,</span> <span class="n">show_errors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Find the y=0 intercept</span>
<span class="n">find_y_intercept</span><span class="p">(</span><span class="n">odr_results</span><span class="p">,</span> <span class="n">model_function</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- ODR Fit Results ---
Beta: [5.66455646e+01 3.31064937e-02]
Beta Std Error: [1.70869523 0.00388607]
Beta Covariance: [[ 2.52930312e+00 -4.76804323e-03]
 [-4.76804323e-03  1.30825979e-05]]
Residual Variance: 1.1543256178977583
Inverse Condition #: 0.04785494385177525
Reason(s) for Halting:
  Sum of squares convergence

--- Summary of Results ---
Parameter A: 56.64556 +/- 1.70870
  T-value: 33.15135640, P-value: 0.00000047
Parameter B: 0.03311 +/- 0.00389
  T-value: 8.51926296, P-value: 0.00036663

--- Model Fit Statistics ---

Number of Observations (n): 7
Number of Parameters (p): 2
Degrees of Freedom (n-p): 5

--- Goodness-of-Fit &amp; Error Metrics ---
Chi-Squared (from ODR): 5.7716
Reduced Chi-Squared (from ODR): 1.1543

--- Information Criteria ---
Maximum Log-Likelihood: -18.5892
AIC (Akaike Information Criterion): 41.1784
BIC (Bayesian Information Criterion): 41.0702
AICc (Corrected AIC): 44.1784

--- Comparison of Original and Predicted Data Points ---
  Original X    Predicted X (x_plus)    Original Y    Predicted Y (fit)
------------  ----------------------  ------------  -------------------
      0.0000                  0.0000      100.0000             100.0000
      5.0000                  9.4270       79.7000              79.7653
     25.0000                 28.5745       51.3000              51.3863
     34.0000                 34.9116       44.6000              44.6256
     42.0000                 40.1690       39.8000              39.7418
     57.0000                 53.4045       29.9000              29.7466
     97.0000                 97.8832       10.3000              10.3856
</pre></div>
</div>
<img alt="../_images/ebfbddafe63fe3a6ad8498548955c066252892a3f7f1cad5f4dd43bd59b53a4c.png" src="../_images/ebfbddafe63fe3a6ad8498548955c066252892a3f7f1cad5f4dd43bd59b53a4c.png" />
<img alt="../_images/1014d4468c2aef14ebfb6e6668550405d96848c56fdce05f6971a63d9989d746.png" src="../_images/1014d4468c2aef14ebfb6e6668550405d96848c56fdce05f6971a63d9989d746.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Y=0 Intercept Analysis ---
The model function intersects the y=0 line at x = 149.1310
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.float64(149.13097676212672)
</pre></div>
</div>
</div>
</div>
<p>Let’s increase the value of <code class="docutils literal notranslate"><span class="pre">sigma_y</span></code> from 0.5 to 1.0 and test this with <code class="docutils literal notranslate"><span class="pre">sigma_x</span></code> = 2.0 and 3.0.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">model_function</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The custom function to approximate the data.</span>
<span class="sd">    f(x, A, B) = A_1 * (np.exp(-B_1 * x) - 1) + A * (np.exp(-B * x) - 1) + 100</span>
<span class="sd">    Note: The signature is now (beta, x) for scipy.odr.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">A_1</span> <span class="o">=</span> <span class="mf">56.769</span> <span class="c1"># obtained from Dataset 3 with sigma_x = 2.0, sigma_y = 0.5</span>
    <span class="n">B_1</span> <span class="o">=</span> <span class="mf">0.00988</span> <span class="c1"># obtained from Dataset 3 with sigma_x = 2.0, sigma_y = 0.5</span>

    <span class="c1"># A_1 = 56.747 # obtained from Dataset 3 with sigma_x = 3.0, sigma_y = 0.5</span>
    <span class="c1"># B_1 = 0.00991 # obtained from Dataset 3 with sigma_x = 3.0, sigma_y = 0.5</span>

    <span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="n">beta</span>
    
    <span class="k">return</span> <span class="n">A_1</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">B_1</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">A</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">B</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">100</span>

<span class="c1"># Dataset 1</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">97</span><span class="p">])</span>
<span class="n">y_obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mf">79.7</span><span class="p">,</span> <span class="mf">51.3</span><span class="p">,</span> <span class="mf">44.6</span><span class="p">,</span> <span class="mf">39.8</span><span class="p">,</span> <span class="mf">29.9</span><span class="p">,</span> <span class="mf">10.3</span><span class="p">])</span>
<span class="n">sigma_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">y_obs</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">sigma_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">initial_guess</span> <span class="o">=</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">]</span>

<span class="c1"># Analyze the curve fit and get results using ODR</span>
<span class="n">odr_results</span> <span class="o">=</span> <span class="n">analyze_odr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_obs</span><span class="p">,</span> <span class="n">sigma_x</span><span class="p">,</span> <span class="n">sigma_y</span><span class="p">,</span> <span class="n">model_function</span><span class="p">,</span> <span class="n">initial_guess</span><span class="p">)</span>

<span class="c1"># Print the metrics</span>
<span class="n">print_metrics</span><span class="p">(</span><span class="n">odr_results</span><span class="p">)</span>

<span class="c1"># Draw the curve fit plot</span>
<span class="n">draw_curve_fit</span><span class="p">(</span><span class="n">odr_results</span><span class="p">,</span> <span class="n">model_function</span><span class="p">)</span>

<span class="c1"># Plot predicted vs observed values</span>
<span class="n">plot_predicted_vs_observed</span><span class="p">(</span><span class="n">odr_results</span><span class="p">,</span> <span class="n">show_errors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Find the y=0 intercept</span>
<span class="n">find_y_intercept</span><span class="p">(</span><span class="n">odr_results</span><span class="p">,</span> <span class="n">model_function</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- ODR Fit Results ---
Beta: [5.57800408e+01 3.47428213e-02]
Beta Std Error: [2.31846495 0.00469935]
Beta Covariance: [[ 2.58198910e+00 -4.39032812e-03]
 [-4.39032812e-03  1.06078745e-05]]
Residual Variance: 2.081836717937271
Inverse Condition #: 0.05193375915222127
Reason(s) for Halting:
  Sum of squares convergence

--- Summary of Results ---
Parameter A: 55.78004 +/- 2.31846
  T-value: 24.05903997, P-value: 0.00000231
Parameter B: 0.03474 +/- 0.00470
  T-value: 7.39311677, P-value: 0.00071218

--- Model Fit Statistics ---

Number of Observations (n): 7
Number of Parameters (p): 2
Degrees of Freedom (n-p): 5

--- Goodness-of-Fit &amp; Error Metrics ---
Chi-Squared (from ODR): 10.4092
Reduced Chi-Squared (from ODR): 2.0818

--- Information Criteria ---
Maximum Log-Likelihood: -22.9218
AIC (Akaike Information Criterion): 49.8435
BIC (Bayesian Information Criterion): 49.7353
AICc (Corrected AIC): 52.8435

--- Comparison of Original and Predicted Data Points ---
  Original X    Predicted X (x_plus)    Original Y    Predicted Y (fit)
------------  ----------------------  ------------  -------------------
      0.0000                  0.0000      100.0000             100.0000
      5.0000                  8.9875       79.7000              80.2161
     25.0000                 27.7407       51.3000              51.8878
     34.0000                 34.4350       44.6000              44.7104
     42.0000                 40.3220       39.8000              39.3088
     57.0000                 54.5909       29.9000              28.9253
     97.0000                 97.7144       10.3000              10.9411
</pre></div>
</div>
<img alt="../_images/b7327b6c058615b0a88715f358b6663ef6c25817af49e6f67c1dfd8a2722cc20.png" src="../_images/b7327b6c058615b0a88715f358b6663ef6c25817af49e6f67c1dfd8a2722cc20.png" />
<img alt="../_images/b151c65f153fdf52d60f4635be8f9c062159c695d0ab18894e035ed580a63997.png" src="../_images/b151c65f153fdf52d60f4635be8f9c062159c695d0ab18894e035ed580a63997.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Y=0 Intercept Analysis ---
The model function intersects the y=0 line at x = 154.8617
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.float64(154.86168906836295)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">model_function</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The custom function to approximate the data.</span>
<span class="sd">    f(x, A, B) = A_1 * (np.exp(-B_1 * x) - 1) + A * (np.exp(-B * x) - 1) + 100</span>
<span class="sd">    Note: The signature is now (beta, x) for scipy.odr.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">A_1</span> <span class="o">=</span> <span class="mf">56.769</span> <span class="c1"># obtained from Dataset 3 with sigma_x = 2.0, sigma_y = 0.5</span>
    <span class="n">B_1</span> <span class="o">=</span> <span class="mf">0.00988</span> <span class="c1"># obtained from Dataset 3 with sigma_x = 2.0, sigma_y = 0.5</span>

    <span class="c1"># A_1 = 56.747 # obtained from Dataset 3 with sigma_x = 3.0, sigma_y = 0.5</span>
    <span class="c1"># B_1 = 0.00991 # obtained from Dataset 3 with sigma_x = 3.0, sigma_y = 0.5</span>

    <span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="n">beta</span>
    
    <span class="k">return</span> <span class="n">A_1</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">B_1</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">A</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">B</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">100</span>

<span class="c1"># Dataset 1</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">97</span><span class="p">])</span>
<span class="n">y_obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mf">79.7</span><span class="p">,</span> <span class="mf">51.3</span><span class="p">,</span> <span class="mf">44.6</span><span class="p">,</span> <span class="mf">39.8</span><span class="p">,</span> <span class="mf">29.9</span><span class="p">,</span> <span class="mf">10.3</span><span class="p">])</span>
<span class="n">sigma_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">y_obs</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">sigma_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">initial_guess</span> <span class="o">=</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">]</span>

<span class="c1"># Analyze the curve fit and get results using ODR</span>
<span class="n">odr_results</span> <span class="o">=</span> <span class="n">analyze_odr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_obs</span><span class="p">,</span> <span class="n">sigma_x</span><span class="p">,</span> <span class="n">sigma_y</span><span class="p">,</span> <span class="n">model_function</span><span class="p">,</span> <span class="n">initial_guess</span><span class="p">)</span>

<span class="c1"># Print the metrics</span>
<span class="n">print_metrics</span><span class="p">(</span><span class="n">odr_results</span><span class="p">)</span>

<span class="c1"># Draw the curve fit plot</span>
<span class="n">draw_curve_fit</span><span class="p">(</span><span class="n">odr_results</span><span class="p">,</span> <span class="n">model_function</span><span class="p">)</span>

<span class="c1"># Plot predicted vs observed values</span>
<span class="n">plot_predicted_vs_observed</span><span class="p">(</span><span class="n">odr_results</span><span class="p">,</span> <span class="n">show_errors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Find the y=0 intercept</span>
<span class="n">find_y_intercept</span><span class="p">(</span><span class="n">odr_results</span><span class="p">,</span> <span class="n">model_function</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- ODR Fit Results ---
Beta: [5.62756354e+01 3.37856894e-02]
Beta Std Error: [2.01225938 0.00423834]
Beta Covariance: [[ 3.84235651e+00 -6.72589726e-03]
 [-6.72589726e-03  1.70459194e-05]]
Residual Variance: 1.0538292845024835
Inverse Condition #: 0.05122048290906237
Reason(s) for Halting:
  Sum of squares convergence

--- Summary of Results ---
Parameter A: 56.27564 +/- 2.01226
  T-value: 27.96639236, P-value: 0.00000109
Parameter B: 0.03379 +/- 0.00424
  T-value: 7.97145206, P-value: 0.00050124

--- Model Fit Statistics ---

Number of Observations (n): 7
Number of Parameters (p): 2
Degrees of Freedom (n-p): 5

--- Goodness-of-Fit &amp; Error Metrics ---
Chi-Squared (from ODR): 5.2691
Reduced Chi-Squared (from ODR): 1.0538

--- Information Criteria ---
Maximum Log-Likelihood: -23.1900
AIC (Akaike Information Criterion): 50.3800
BIC (Bayesian Information Criterion): 50.2718
AICc (Corrected AIC): 53.3800

--- Comparison of Original and Predicted Data Points ---
  Original X    Predicted X (x_plus)    Original Y    Predicted Y (fit)
------------  ----------------------  ------------  -------------------
      0.0000                  0.0000      100.0000             100.0000
      5.0000                  9.2447       79.7000              79.9478
     25.0000                 28.2134       51.3000              51.6085
     34.0000                 34.6941       44.6000              44.6781
     42.0000                 40.2175       39.8000              39.5712
     57.0000                 53.9433       29.9000              29.3664
     97.0000                 97.8134       10.3000              10.6191
</pre></div>
</div>
<img alt="../_images/dfa9903eb9f23d8d3cd86e32dcc2aea702702a60d423ed1e33e98e05d22d7635.png" src="../_images/dfa9903eb9f23d8d3cd86e32dcc2aea702702a60d423ed1e33e98e05d22d7635.png" />
<img alt="../_images/26ac67fbd1e84ea3ab2a68468b830d990f91f92e46669ec3c9d4f499d7f9a257.png" src="../_images/26ac67fbd1e84ea3ab2a68468b830d990f91f92e46669ec3c9d4f499d7f9a257.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Y=0 Intercept Analysis ---
The model function intersects the y=0 line at x = 151.4955
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.float64(151.4955015859515)
</pre></div>
</div>
</div>
</div>
<p>Reduced <span class="math notranslate nohighlight">\(\chi^2\)</span> is close to 1 which is pretty good.</p>
<p>Let’s exclude the second point from the dataset as outlier and validate the results with <code class="docutils literal notranslate"><span class="pre">sigma_x</span></code> = 2.0 and 3.0 with <code class="docutils literal notranslate"><span class="pre">sigma_y</span></code> = 0.5.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">model_function</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The custom function to approximate the data.</span>
<span class="sd">    f(x, A, B) = A_1 * (np.exp(-B_1 * x) - 1) + A * (np.exp(-B * x) - 1) + 100</span>
<span class="sd">    Note: The signature is now (beta, x) for scipy.odr.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">A_1</span> <span class="o">=</span> <span class="mf">56.769</span> <span class="c1"># obtained from Dataset 3 with sigma_x = 2.0, sigma_y = 0.5</span>
    <span class="n">B_1</span> <span class="o">=</span> <span class="mf">0.00988</span> <span class="c1"># obtained from Dataset 3 with sigma_x = 2.0, sigma_y = 0.5</span>

    <span class="c1"># A_1 = 56.747 # obtained from Dataset 3 with sigma_x = 3.0, sigma_y = 0.5</span>
    <span class="c1"># B_1 = 0.00991 # obtained from Dataset 3 with sigma_x = 3.0, sigma_y = 0.5</span>

    <span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="n">beta</span>
    
    <span class="k">return</span> <span class="n">A_1</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">B_1</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">A</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">B</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">100</span>

<span class="c1"># Dataset 1</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">97</span><span class="p">])</span>
<span class="n">y_obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mf">51.3</span><span class="p">,</span> <span class="mf">44.6</span><span class="p">,</span> <span class="mf">39.8</span><span class="p">,</span> <span class="mf">29.9</span><span class="p">,</span> <span class="mf">10.3</span><span class="p">])</span>
<span class="n">sigma_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">y_obs</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">sigma_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">initial_guess</span> <span class="o">=</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">]</span>

<span class="c1"># Analyze the curve fit and get results using ODR</span>
<span class="n">odr_results</span> <span class="o">=</span> <span class="n">analyze_odr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_obs</span><span class="p">,</span> <span class="n">sigma_x</span><span class="p">,</span> <span class="n">sigma_y</span><span class="p">,</span> <span class="n">model_function</span><span class="p">,</span> <span class="n">initial_guess</span><span class="p">)</span>

<span class="c1"># Print the metrics</span>
<span class="n">print_metrics</span><span class="p">(</span><span class="n">odr_results</span><span class="p">)</span>

<span class="c1"># Draw the curve fit plot</span>
<span class="n">draw_curve_fit</span><span class="p">(</span><span class="n">odr_results</span><span class="p">,</span> <span class="n">model_function</span><span class="p">)</span>

<span class="c1"># Plot predicted vs observed values</span>
<span class="n">plot_predicted_vs_observed</span><span class="p">(</span><span class="n">odr_results</span><span class="p">,</span> <span class="n">show_errors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Find the y=0 intercept</span>
<span class="n">find_y_intercept</span><span class="p">(</span><span class="n">odr_results</span><span class="p">,</span> <span class="n">model_function</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- ODR Fit Results ---
Beta: [5.68529058e+01 3.23008191e-02]
Beta Std Error: [1.70828296 0.00349095]
Beta Covariance: [[ 1.55965136e+00 -2.69324851e-03]
 [-2.69324851e-03  6.51321145e-06]]
Residual Variance: 1.8710788466796813
Inverse Condition #: 0.05055547164742644
Reason(s) for Halting:
  Sum of squares convergence

--- Summary of Results ---
Parameter A: 56.85291 +/- 1.70828
  T-value: 33.28073104, P-value: 0.00000486
Parameter B: 0.03230 +/- 0.00349
  T-value: 9.25273028, P-value: 0.00075856

--- Model Fit Statistics ---

Number of Observations (n): 6
Number of Parameters (p): 2
Degrees of Freedom (n-p): 4

--- Goodness-of-Fit &amp; Error Metrics ---
Chi-Squared (from ODR): 7.4843
Reduced Chi-Squared (from ODR): 1.8711

--- Information Criteria ---
Maximum Log-Likelihood: -14.7694
AIC (Akaike Information Criterion): 33.5388
BIC (Bayesian Information Criterion): 33.1224
AICc (Corrected AIC): 37.5388

--- Comparison of Original and Predicted Data Points ---
  Original X    Predicted X (x_plus)    Original Y    Predicted Y (fit)
------------  ----------------------  ------------  -------------------
      0.0000                  0.0000      100.0000             100.0000
     25.0000                 28.8059       51.3000              51.5075
     34.0000                 35.2314       44.6000              44.6782
     42.0000                 40.6080       39.8000              39.7000
     57.0000                 54.0004       29.9000              29.6115
     97.0000                 97.6458       10.3000              10.4382
</pre></div>
</div>
<img alt="../_images/8351f5fe91211fb8c40426f8ecbccf72fc6aa28e36560c2ada0fd11830f33d90.png" src="../_images/8351f5fe91211fb8c40426f8ecbccf72fc6aa28e36560c2ada0fd11830f33d90.png" />
<img alt="../_images/52b5c841f168f81e8f0e9b7fce0b9064d500f6964abe480ad910dd8b0823aff7.png" src="../_images/52b5c841f168f81e8f0e9b7fce0b9064d500f6964abe480ad910dd8b0823aff7.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Y=0 Intercept Analysis ---
The model function intersects the y=0 line at x = 148.0654
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.float64(148.0654075694521)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">model_function</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The custom function to approximate the data.</span>
<span class="sd">    f(x, A, B) = A_1 * (np.exp(-B_1 * x) - 1) + A * (np.exp(-B * x) - 1) + 100</span>
<span class="sd">    Note: The signature is now (beta, x) for scipy.odr.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">A_1</span> <span class="o">=</span> <span class="mf">56.769</span> <span class="c1"># obtained from Dataset 3 with sigma_x = 2.0, sigma_y = 0.5</span>
    <span class="n">B_1</span> <span class="o">=</span> <span class="mf">0.00988</span> <span class="c1"># obtained from Dataset 3 with sigma_x = 2.0, sigma_y = 0.5</span>

    <span class="c1"># A_1 = 56.747 # obtained from Dataset 3 with sigma_x = 3.0, sigma_y = 0.5</span>
    <span class="c1"># B_1 = 0.00991 # obtained from Dataset 3 with sigma_x = 3.0, sigma_y = 0.5</span>

    <span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="n">beta</span>
    
    <span class="k">return</span> <span class="n">A_1</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">B_1</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">A</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">B</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">100</span>

<span class="c1"># Dataset 1</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">97</span><span class="p">])</span>
<span class="n">y_obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mf">51.3</span><span class="p">,</span> <span class="mf">44.6</span><span class="p">,</span> <span class="mf">39.8</span><span class="p">,</span> <span class="mf">29.9</span><span class="p">,</span> <span class="mf">10.3</span><span class="p">])</span>
<span class="n">sigma_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">y_obs</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">sigma_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">initial_guess</span> <span class="o">=</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">]</span>

<span class="c1"># Analyze the curve fit and get results using ODR</span>
<span class="n">odr_results</span> <span class="o">=</span> <span class="n">analyze_odr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_obs</span><span class="p">,</span> <span class="n">sigma_x</span><span class="p">,</span> <span class="n">sigma_y</span><span class="p">,</span> <span class="n">model_function</span><span class="p">,</span> <span class="n">initial_guess</span><span class="p">)</span>

<span class="c1"># Print the metrics</span>
<span class="n">print_metrics</span><span class="p">(</span><span class="n">odr_results</span><span class="p">)</span>

<span class="c1"># Draw the curve fit plot</span>
<span class="n">draw_curve_fit</span><span class="p">(</span><span class="n">odr_results</span><span class="p">,</span> <span class="n">model_function</span><span class="p">)</span>

<span class="c1"># Plot predicted vs observed values</span>
<span class="n">plot_predicted_vs_observed</span><span class="p">(</span><span class="n">odr_results</span><span class="p">,</span> <span class="n">show_errors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Find the y=0 intercept</span>
<span class="n">find_y_intercept</span><span class="p">(</span><span class="n">odr_results</span><span class="p">,</span> <span class="n">model_function</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- ODR Fit Results ---
Beta: [5.69770308e+01 3.20851523e-02]
Beta Std Error: [1.58710399 0.00338037]
Beta Covariance: [[ 2.88367706e+00 -5.19099807e-03]
 [-5.19099807e-03  1.30817316e-05]]
Residual Variance: 0.8735024809232925
Inverse Condition #: 0.04855655628987679
Reason(s) for Halting:
  Sum of squares convergence

--- Summary of Results ---
Parameter A: 56.97703 +/- 1.58710
  T-value: 35.89999855, P-value: 0.00000359
Parameter B: 0.03209 +/- 0.00338
  T-value: 9.49159977, P-value: 0.00068758

--- Model Fit Statistics ---

Number of Observations (n): 6
Number of Parameters (p): 2
Degrees of Freedom (n-p): 4

--- Goodness-of-Fit &amp; Error Metrics ---
Chi-Squared (from ODR): 3.4940
Reduced Chi-Squared (from ODR): 0.8735

--- Information Criteria ---
Maximum Log-Likelihood: -15.2071
AIC (Akaike Information Criterion): 34.4141
BIC (Bayesian Information Criterion): 33.9976
AICc (Corrected AIC): 38.4141

--- Comparison of Original and Predicted Data Points ---
  Original X    Predicted X (x_plus)    Original Y    Predicted Y (fit)
------------  ----------------------  ------------  -------------------
      0.0000                  0.0000      100.0000             100.0000
     25.0000                 28.9597       51.3000              51.3962
     34.0000                 35.3284       44.6000              44.6375
     42.0000                 40.5954       39.8000              39.7553
     57.0000                 53.7891       29.9000              29.7639
     97.0000                 97.6715       10.3000              10.3636
</pre></div>
</div>
<img alt="../_images/125d936a2b276555b6cab2bb449b35b4320a3a88fb7147c515d41c9122fcbeda.png" src="../_images/125d936a2b276555b6cab2bb449b35b4320a3a88fb7147c515d41c9122fcbeda.png" />
<img alt="../_images/a26a7f4ee0ddd3581befbebe6f09e9d0e84ea5b09b66e989b2fd492a83ce2cb0.png" src="../_images/a26a7f4ee0ddd3581befbebe6f09e9d0e84ea5b09b66e989b2fd492a83ce2cb0.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Y=0 Intercept Analysis ---
The model function intersects the y=0 line at x = 147.3301
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.float64(147.33014035453778)
</pre></div>
</div>
</div>
</div>
</section>
<section id="more-than-2-parameters-in-the-non-linear-model">
<h3>More than 2 parameters in the non-linear model<a class="headerlink" href="#more-than-2-parameters-in-the-non-linear-model" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">draw_curve_fit_simple</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">model_function</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Visualizes the ODR fit with a 95% confidence band.</span>

<span class="sd">    Args:</span>
<span class="sd">        results (dict): The dictionary returned by the analyze_odr function.</span>
<span class="sd">        model_function (callable): The model function used for the fit.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># --- 1. Unpack data from the results dictionary ---</span>
    <span class="n">x_data</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;original_x&quot;</span><span class="p">]</span>
    <span class="n">y_data</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;original_y&quot;</span><span class="p">]</span>
    <span class="n">sigma_x</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;original_sigma_x&quot;</span><span class="p">]</span>
    <span class="n">sigma_y</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;original_sigma_y&quot;</span><span class="p">]</span>
    <span class="n">popt</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;fit_params&#39;</span><span class="p">]</span>
    <span class="n">perr</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;std_errs&#39;</span><span class="p">]</span>
    
    <span class="c1"># --- 2. Set up the plot ---</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">set_theme</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">)</span>

    <span class="c1"># --- 3. Plot the curve fit ---</span>
    
    <span class="c1"># Plot original data with error bars</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span>
        <span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">,</span> 
        <span class="n">xerr</span><span class="o">=</span><span class="n">sigma_x</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">sigma_y</span><span class="p">,</span> 
        <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;royalblue&#39;</span><span class="p">,</span> <span class="n">ecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Original Data&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">5</span>
    <span class="p">)</span>

    <span class="c1"># Generate points for the fitted curve and confidence band</span>
    <span class="n">x_plot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">x_data</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">x_data</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.05</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>
    <span class="n">y_plot</span> <span class="o">=</span> <span class="n">model_function</span><span class="p">(</span><span class="n">popt</span><span class="p">,</span> <span class="n">x_plot</span><span class="p">)</span>

    <span class="c1"># Plot the fitted curve</span>
    <span class="n">label_text</span> <span class="o">=</span> <span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;ODR Fitted Curve</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;$A_1$=</span><span class="si">{</span><span class="n">popt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2"> ± </span><span class="si">{</span><span class="n">perr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;A=</span><span class="si">{</span><span class="n">popt</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2"> ± </span><span class="si">{</span><span class="n">perr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;B=</span><span class="si">{</span><span class="n">popt</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2"> ± </span><span class="si">{</span><span class="n">perr</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_plot</span><span class="p">,</span> <span class="n">y_plot</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label_text</span><span class="p">)</span>

    <span class="c1"># --- 5. Configure title, labels, and final layout ---</span>
    <span class="n">title</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Orthogonal Distance Regression (ODR) Fit</span><span class="se">\n</span><span class="s2">Reduced $</span><span class="se">\\</span><span class="s2">chi^2$ = </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;reduced_chi_squared_odr&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;X-Value&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Y-Value&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">xmin</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">x_data</span><span class="p">)</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ymin</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">y_data</span><span class="p">)</span> <span class="o">-</span> <span class="mi">10</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">y_data</span><span class="p">)</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">model_function</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The custom function to approximate the data.</span>
<span class="sd">    f(x; A, B) = A * (np.exp(-B * x) - 1) + 100</span>
<span class="sd">    Note: The signature is now (beta, x) for scipy.odr.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># A_1 = 56.769 # obtained from Dataset 3 with sigma_x = 2.0, sigma_y = 0.5</span>
    <span class="n">B_1</span> <span class="o">=</span> <span class="mf">0.00988</span> <span class="c1"># obtained from Dataset 3 with sigma_x = 2.0, sigma_y = 0.5</span>

    <span class="c1"># A_1 = 56.747 # obtained from Dataset 3 with sigma_x = 3.0, sigma_y = 0.5</span>
    <span class="c1"># B_1 = 0.00991 # obtained from Dataset 3 with sigma_x = 3.0, sigma_y = 0.5</span>

    <span class="n">A_1</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="n">beta</span>
    
    <span class="k">return</span> <span class="n">A_1</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">B_1</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">A</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">B</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">100</span>

<span class="c1"># Dataset 1</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">97</span><span class="p">])</span>
<span class="n">y_obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mf">79.7</span><span class="p">,</span> <span class="mf">51.3</span><span class="p">,</span> <span class="mf">44.6</span><span class="p">,</span> <span class="mf">39.8</span><span class="p">,</span> <span class="mf">29.9</span><span class="p">,</span> <span class="mf">10.3</span><span class="p">])</span>
<span class="n">sigma_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">y_obs</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">sigma_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">initial_guess</span> <span class="o">=</span> <span class="p">[</span><span class="mf">56.769</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">]</span>

<span class="c1"># Analyze the curve fit and get results using ODR</span>
<span class="n">odr_results</span> <span class="o">=</span> <span class="n">analyze_odr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_obs</span><span class="p">,</span> <span class="n">sigma_x</span><span class="p">,</span> <span class="n">sigma_y</span><span class="p">,</span> <span class="n">model_function</span><span class="p">,</span> <span class="n">initial_guess</span><span class="p">)</span>

<span class="c1"># Print the metrics</span>
<span class="n">print_metrics</span><span class="p">(</span><span class="n">odr_results</span><span class="p">)</span>

<span class="c1"># Draw the curve fit plot</span>
<span class="n">draw_curve_fit_simple</span><span class="p">(</span><span class="n">odr_results</span><span class="p">,</span> <span class="n">model_function</span><span class="p">)</span>

<span class="c1"># Plot predicted vs observed values</span>
<span class="n">plot_predicted_vs_observed</span><span class="p">(</span><span class="n">odr_results</span><span class="p">,</span> <span class="n">show_errors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Find the y=0 intercept</span>
<span class="n">find_y_intercept</span><span class="p">(</span><span class="n">odr_results</span><span class="p">,</span> <span class="n">model_function</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- ODR Fit Results ---
Beta: [103.88824637  25.55010799   0.19522905]
Beta Std Error: [1.24956011 0.59488983 0.03870533]
Beta Covariance: [[ 1.65731942e+01 -7.51580025e+00  1.67335878e-01]
 [-7.51580025e+00  3.75634090e+00 -8.96855502e-02]
 [ 1.67335878e-01 -8.96855502e-02  1.59013315e-02]]
Residual Variance: 0.09421240332040559
Inverse Condition #: 0.0009228447241251511
Reason(s) for Halting:
  Sum of squares convergence

--- Summary of Results ---
Parameter A: 103.88825 +/- 1.24956
  T-value: 83.13985531, P-value: 0.00000013
Parameter B: 25.55011 +/- 0.59489
  T-value: 42.94931078, P-value: 0.00000176
Parameter C: 0.19523 +/- 0.03871
  T-value: 5.04398357, P-value: 0.00726171

--- Model Fit Statistics ---

Number of Observations (n): 7
Number of Parameters (p): 3
Degrees of Freedom (n-p): 4

--- Goodness-of-Fit &amp; Error Metrics ---
Chi-Squared (from ODR): 0.3768
Reduced Chi-Squared (from ODR): 0.0942

--- Information Criteria ---
Maximum Log-Likelihood: -13.0536
AIC (Akaike Information Criterion): 32.1071
BIC (Bayesian Information Criterion): 31.9449
AICc (Corrected AIC): 40.1071

--- Comparison of Original and Predicted Data Points ---
  Original X    Predicted X (x_plus)    Original Y    Predicted Y (fit)
------------  ----------------------  ------------  -------------------
      0.0000                  0.0000      100.0000             100.0000
      5.0000                  4.7837       79.7000              79.6954
     25.0000                 25.6670       51.3000              51.3502
     34.0000                 34.2938       44.6000              44.6249
     42.0000                 41.1892       39.8000              39.7260
     57.0000                 56.7351       29.9000              29.8717
     97.0000                 97.1901       10.3000              10.3302
</pre></div>
</div>
<img alt="../_images/1c18555f3219288ea5f0025e72ef5b4b2a189a7abfb570161e739b6dc1a460a9.png" src="../_images/1c18555f3219288ea5f0025e72ef5b4b2a189a7abfb570161e739b6dc1a460a9.png" />
<img alt="../_images/4bf64bc14a87c7483ad0cb2bda4d95008d4254ca43c9019caec7963988a8bff6.png" src="../_images/4bf64bc14a87c7483ad0cb2bda4d95008d4254ca43c9019caec7963988a8bff6.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Y=0 Intercept Analysis ---
The model function intersects the y=0 line at x = 127.6333
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.float64(127.63333736206178)
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="usage-of-methods-dataset-2">
<h2>Usage of Methods. Dataset 2<a class="headerlink" href="#usage-of-methods-dataset-2" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">model_function</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The custom function to approximate the data.</span>
<span class="sd">    f(x; A, B) = A * (np.exp(-B * x) - 1) + 100</span>
<span class="sd">    Note: The signature is now (beta, x) for scipy.odr.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="n">beta</span>
    <span class="k">return</span> <span class="n">A</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">B</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">100</span>

<span class="c1"># Dataset 2</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">191</span><span class="p">,</span> <span class="mi">294</span><span class="p">,</span> <span class="mi">391</span><span class="p">])</span>
<span class="n">y_obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mf">80.4</span><span class="p">,</span> <span class="mf">66.4</span><span class="p">,</span> <span class="mf">50.1</span><span class="p">,</span> <span class="mf">41.2</span><span class="p">,</span> <span class="mf">28.5</span><span class="p">,</span> <span class="mf">20.1</span><span class="p">])</span>
<span class="n">sigma_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">y_obs</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">sigma_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">initial_guess</span> <span class="o">=</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">]</span>

<span class="c1"># Analyze the curve fit and get results using ODR</span>
<span class="n">odr_results</span> <span class="o">=</span> <span class="n">analyze_odr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_obs</span><span class="p">,</span> <span class="n">sigma_x</span><span class="p">,</span> <span class="n">sigma_y</span><span class="p">,</span> <span class="n">model_function</span><span class="p">,</span> <span class="n">initial_guess</span><span class="p">)</span>

<span class="c1"># Print the metrics</span>
<span class="n">print_metrics</span><span class="p">(</span><span class="n">odr_results</span><span class="p">)</span>

<span class="c1"># Draw the curve fit plot</span>
<span class="n">draw_curve_fit</span><span class="p">(</span><span class="n">odr_results</span><span class="p">,</span> <span class="n">model_function</span><span class="p">)</span>

<span class="c1"># Plot predicted vs observed values</span>
<span class="n">plot_predicted_vs_observed</span><span class="p">(</span><span class="n">odr_results</span><span class="p">,</span> <span class="n">show_errors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Find the y=0 intercept</span>
<span class="n">find_y_intercept</span><span class="p">(</span><span class="n">odr_results</span><span class="p">,</span> <span class="n">model_function</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- ODR Fit Results ---
Beta: [7.95124870e+01 8.64914311e-03]
Beta Std Error: [4.26174841e+00 1.51681192e-03]
Beta Covariance: [[ 3.55227784e-01 -1.06585631e-04]
 [-1.06585631e-04  4.49981620e-08]]
Residual Variance: 51.1291636600781
Inverse Condition #: 0.2371672057368133
Reason(s) for Halting:
  Sum of squares convergence

--- Summary of Results ---
Parameter A: 79.51249 +/- 4.26175
  T-value: 18.65724565, P-value: 0.00000814
Parameter B: 0.00865 +/- 0.00152
  T-value: 5.70218563, P-value: 0.00231566

--- Model Fit Statistics ---

Number of Observations (n): 7
Number of Parameters (p): 2
Degrees of Freedom (n-p): 5

--- Goodness-of-Fit &amp; Error Metrics ---
Chi-Squared (from ODR): 255.6458
Reduced Chi-Squared (from ODR): 51.1292

--- Information Criteria ---
Maximum Log-Likelihood: -140.6880
AIC (Akaike Information Criterion): 285.3761
BIC (Bayesian Information Criterion): 285.2679
AICc (Corrected AIC): 288.3761

--- Comparison of Original and Predicted Data Points ---
  Original X    Predicted X (x_plus)    Original Y    Predicted Y (fit)
------------  ----------------------  ------------  -------------------
      0.0000                  0.0000      100.0000             100.0000
     19.0000                 30.2004       80.4000              81.7217
     45.0000                 58.4864       66.4000              68.4326
    104.0000                109.3818       50.1000              51.3597
    191.0000                181.4667       41.2000              37.0375
    294.0000                292.5282       28.5000              26.8207
    391.0000                392.1344       20.1000              23.1634
</pre></div>
</div>
<img alt="../_images/5e16a097ddf0da66963ae168b138c6201d5b5655d7eaaf7678a71d58b9383a77.png" src="../_images/5e16a097ddf0da66963ae168b138c6201d5b5655d7eaaf7678a71d58b9383a77.png" />
<img alt="../_images/d54b07498fd6a9b2412020dc1af9acb734c6a7ea54b2813b96a650aab1702d79.png" src="../_images/d54b07498fd6a9b2412020dc1af9acb734c6a7ea54b2813b96a650aab1702d79.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Y=0 Intercept Analysis ---
The root-finding algorithm did not converge to a solution.
Message from fsolve: The iteration is not making good progress, as measured by the 
 improvement from the last ten iterations.
</pre></div>
</div>
</div>
</div>
<p>Let’s change <code class="docutils literal notranslate"><span class="pre">sigma_x</span></code> to 3.0.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">model_function</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The custom function to approximate the data.</span>
<span class="sd">    f(x; A, B) = A * (np.exp(-B * x) - 1) + 100</span>
<span class="sd">    Note: The signature is now (beta, x) for scipy.odr.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="n">beta</span>
    <span class="k">return</span> <span class="n">A</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">B</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">100</span>

<span class="c1"># Dataset 2</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">191</span><span class="p">,</span> <span class="mi">294</span><span class="p">,</span> <span class="mi">391</span><span class="p">])</span>
<span class="n">y_obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mf">80.4</span><span class="p">,</span> <span class="mf">66.4</span><span class="p">,</span> <span class="mf">50.1</span><span class="p">,</span> <span class="mf">41.2</span><span class="p">,</span> <span class="mf">28.5</span><span class="p">,</span> <span class="mf">20.1</span><span class="p">])</span>
<span class="n">sigma_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">y_obs</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">sigma_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">initial_guess</span> <span class="o">=</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">]</span>

<span class="c1"># Analyze the curve fit and get results using ODR</span>
<span class="n">odr_results</span> <span class="o">=</span> <span class="n">analyze_odr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_obs</span><span class="p">,</span> <span class="n">sigma_x</span><span class="p">,</span> <span class="n">sigma_y</span><span class="p">,</span> <span class="n">model_function</span><span class="p">,</span> <span class="n">initial_guess</span><span class="p">)</span>

<span class="c1"># Print the metrics</span>
<span class="n">print_metrics</span><span class="p">(</span><span class="n">odr_results</span><span class="p">)</span>

<span class="c1"># Draw the curve fit plot</span>
<span class="n">draw_curve_fit</span><span class="p">(</span><span class="n">odr_results</span><span class="p">,</span> <span class="n">model_function</span><span class="p">)</span>

<span class="c1"># Plot predicted vs observed values</span>
<span class="n">plot_predicted_vs_observed</span><span class="p">(</span><span class="n">odr_results</span><span class="p">,</span> <span class="n">show_errors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Find the y=0 intercept</span>
<span class="n">find_y_intercept</span><span class="p">(</span><span class="n">odr_results</span><span class="p">,</span> <span class="n">model_function</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- ODR Fit Results ---
Beta: [8.12148883e+01 7.99130328e-03]
Beta Std Error: [4.12285499e+00 1.35133333e-03]
Beta Covariance: [[ 4.98607625e-01 -1.41854982e-04]
 [-1.41854982e-04  5.35658219e-08]]
Residual Variance: 34.090800993631014
Inverse Condition #: 0.22835848075085202
Reason(s) for Halting:
  Sum of squares convergence

--- Summary of Results ---
Parameter A: 81.21489 +/- 4.12285
  T-value: 19.69870111, P-value: 0.00000623
Parameter B: 0.00799 +/- 0.00135
  T-value: 5.91364328, P-value: 0.00196969

--- Model Fit Statistics ---

Number of Observations (n): 7
Number of Parameters (p): 2
Degrees of Freedom (n-p): 5

--- Goodness-of-Fit &amp; Error Metrics ---
Chi-Squared (from ODR): 170.4540
Reduced Chi-Squared (from ODR): 34.0908

--- Information Criteria ---
Maximum Log-Likelihood: -100.9304
AIC (Akaike Information Criterion): 205.8608
BIC (Bayesian Information Criterion): 205.7526
AICc (Corrected AIC): 208.8608

--- Comparison of Original and Predicted Data Points ---
  Original X    Predicted X (x_plus)    Original Y    Predicted Y (fit)
------------  ----------------------  ------------  -------------------
      0.0000                  0.0000      100.0000             100.0000
     19.0000                 32.9891       80.4000              81.1793
     45.0000                 63.4232       66.4000              67.7090
    104.0000                114.7417       50.1000              51.2501
    191.0000                176.3312       41.2000              38.6307
    294.0000                290.0500       28.5000              26.7833
    391.0000                393.2120       20.1000              22.2923
</pre></div>
</div>
<img alt="../_images/aadc2b83ea0ee83167587a67adb23660f76e70243d450de720f8b4981ab85132.png" src="../_images/aadc2b83ea0ee83167587a67adb23660f76e70243d450de720f8b4981ab85132.png" />
<img alt="../_images/1cfb3474025a662bf65570417f96faac821dd8377cba287a7f8319b8b2227b46.png" src="../_images/1cfb3474025a662bf65570417f96faac821dd8377cba287a7f8319b8b2227b46.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Y=0 Intercept Analysis ---
The root-finding algorithm did not converge to a solution.
Message from fsolve: The iteration is not making good progress, as measured by the 
 improvement from the last ten iterations.
</pre></div>
</div>
</div>
</div>
<p>Let’s exclude Point 5 as a potential outlier and change <code class="docutils literal notranslate"><span class="pre">sigma_y</span></code> to 1.0.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">model_function</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The custom function to approximate the data.</span>
<span class="sd">    f(x; A, B) = A * (np.exp(-B * x) - 1) + 100</span>
<span class="sd">    Note: The signature is now (beta, x) for scipy.odr.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="n">beta</span>
    <span class="k">return</span> <span class="n">A</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">B</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">100</span>

<span class="c1"># Dataset 2</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">294</span><span class="p">,</span> <span class="mi">391</span><span class="p">])</span>
<span class="n">y_obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mf">80.4</span><span class="p">,</span> <span class="mf">66.4</span><span class="p">,</span> <span class="mf">50.1</span><span class="p">,</span> <span class="mf">28.5</span><span class="p">,</span> <span class="mf">20.1</span><span class="p">])</span>
<span class="n">sigma_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">y_obs</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">sigma_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">initial_guess</span> <span class="o">=</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">]</span>

<span class="c1"># Analyze the curve fit and get results using ODR</span>
<span class="n">odr_results</span> <span class="o">=</span> <span class="n">analyze_odr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_obs</span><span class="p">,</span> <span class="n">sigma_x</span><span class="p">,</span> <span class="n">sigma_y</span><span class="p">,</span> <span class="n">model_function</span><span class="p">,</span> <span class="n">initial_guess</span><span class="p">)</span>

<span class="c1"># Print the metrics</span>
<span class="n">print_metrics</span><span class="p">(</span><span class="n">odr_results</span><span class="p">)</span>

<span class="c1"># Draw the curve fit plot</span>
<span class="n">draw_curve_fit</span><span class="p">(</span><span class="n">odr_results</span><span class="p">,</span> <span class="n">model_function</span><span class="p">)</span>

<span class="c1"># Plot predicted vs observed values</span>
<span class="n">plot_predicted_vs_observed</span><span class="p">(</span><span class="n">odr_results</span><span class="p">,</span> <span class="n">show_errors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Find the y=0 intercept</span>
<span class="n">find_y_intercept</span><span class="p">(</span><span class="n">odr_results</span><span class="p">,</span> <span class="n">model_function</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- ODR Fit Results ---
Beta: [7.82911417e+01 1.04406955e-02]
Beta Std Error: [2.72313737e+00 1.41079854e-03]
Beta Covariance: [[ 9.08962511e-01 -3.31014186e-04]
 [-3.31014186e-04  2.43970252e-07]]
Residual Variance: 8.158177098793473
Inverse Condition #: 0.2509151293805631
Reason(s) for Halting:
  Sum of squares convergence

--- Summary of Results ---
Parameter A: 78.29114 +/- 2.72314
  T-value: 28.75034604, P-value: 0.00000871
Parameter B: 0.01044 +/- 0.00141
  T-value: 7.40055735, P-value: 0.00177826

--- Model Fit Statistics ---

Number of Observations (n): 6
Number of Parameters (p): 2
Degrees of Freedom (n-p): 4

--- Goodness-of-Fit &amp; Error Metrics ---
Chi-Squared (from ODR): 32.6327
Reduced Chi-Squared (from ODR): 8.1582

--- Information Criteria ---
Maximum Log-Likelihood: -33.9353
AIC (Akaike Information Criterion): 71.8706
BIC (Bayesian Information Criterion): 71.4541
AICc (Corrected AIC): 75.8706

--- Comparison of Original and Predicted Data Points ---
  Original X    Predicted X (x_plus)    Original Y    Predicted Y (fit)
------------  ----------------------  ------------  -------------------
      0.0000                  0.0000      100.0000             100.0000
     19.0000                 25.6802       80.4000              81.5873
     45.0000                 50.8463       66.4000              67.7513
    104.0000                101.0802       50.1000              48.9598
    294.0000                292.9240       28.5000              25.3859
    391.0000                391.3616       20.1000              23.0245
</pre></div>
</div>
<img alt="../_images/e8ea97620c8aa7c838f11b78ee19e61a03c24c127179bbadb91eb0c7c9a3f768.png" src="../_images/e8ea97620c8aa7c838f11b78ee19e61a03c24c127179bbadb91eb0c7c9a3f768.png" />
<img alt="../_images/e7e5159e167eab2041dcdb2e4973cf9afcba464cdb682b7badcc49c205705a34.png" src="../_images/e7e5159e167eab2041dcdb2e4973cf9afcba464cdb682b7badcc49c205705a34.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Y=0 Intercept Analysis ---
The root-finding algorithm did not converge to a solution.
Message from fsolve: The iteration is not making good progress, as measured by the 
 improvement from the last ten iterations.
</pre></div>
</div>
</div>
</div>
<section id="id1">
<h3>Improved model function<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<p>Let’s start from scratch and try to connect to the results from Dataset 3, so our function will be</p>
<div class="math notranslate nohighlight">
\[f(x, A, B) = A_1 (\exp (-B_1 x) - 1) + A (\exp(-B x) - 1) + 100 \]</div>
<p>where A_1 and B_1 are defined from the ODR of Dataset 3 using a function <span class="math notranslate nohighlight">\(f(x, A, B) = A (\exp(-B x) - 1) + 100 \)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">model_function</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The custom function to approximate the data.</span>
<span class="sd">    f(x, A, B) = A_1 * (np.exp(-B_1 * x) - 1) + A * (np.exp(-B * x) - 1) + 100</span>
<span class="sd">    Note: The signature is now (beta, x) for scipy.odr.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">A_1</span> <span class="o">=</span> <span class="mf">56.769</span> <span class="c1"># obtained from Dataset 3 with sigma_x = 2.0, sigma_y = 0.5</span>
    <span class="n">B_1</span> <span class="o">=</span> <span class="mf">0.00988</span> <span class="c1"># obtained from Dataset 3 with sigma_x = 2.0, sigma_y = 0.5</span>

    <span class="c1"># A_1 = 56.747 # obtained from Dataset 3 with sigma_x = 3.0, sigma_y = 0.5</span>
    <span class="c1"># B_1 = 0.00991 # obtained from Dataset 3 with sigma_x = 3.0, sigma_y = 0.5</span>

    <span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="n">beta</span>
    
    <span class="k">return</span> <span class="n">A_1</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">B_1</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">A</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">B</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">100</span>

<span class="c1"># Dataset 2</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">191</span><span class="p">,</span> <span class="mi">294</span><span class="p">,</span> <span class="mi">391</span><span class="p">])</span>
<span class="n">y_obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mf">80.4</span><span class="p">,</span> <span class="mf">66.4</span><span class="p">,</span> <span class="mf">50.1</span><span class="p">,</span> <span class="mf">41.2</span><span class="p">,</span> <span class="mf">28.5</span><span class="p">,</span> <span class="mf">20.1</span><span class="p">])</span>
<span class="n">sigma_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">y_obs</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">sigma_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">initial_guess</span> <span class="o">=</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">]</span>

<span class="c1"># Analyze the curve fit and get results using ODR</span>
<span class="n">odr_results</span> <span class="o">=</span> <span class="n">analyze_odr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_obs</span><span class="p">,</span> <span class="n">sigma_x</span><span class="p">,</span> <span class="n">sigma_y</span><span class="p">,</span> <span class="n">model_function</span><span class="p">,</span> <span class="n">initial_guess</span><span class="p">)</span>

<span class="c1"># Print the metrics</span>
<span class="n">print_metrics</span><span class="p">(</span><span class="n">odr_results</span><span class="p">)</span>

<span class="c1"># Draw the curve fit plot</span>
<span class="n">draw_curve_fit</span><span class="p">(</span><span class="n">odr_results</span><span class="p">,</span> <span class="n">model_function</span><span class="p">)</span>

<span class="c1"># Plot predicted vs observed values</span>
<span class="n">plot_predicted_vs_observed</span><span class="p">(</span><span class="n">odr_results</span><span class="p">,</span> <span class="n">show_errors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Find the y=0 intercept</span>
<span class="n">find_y_intercept</span><span class="p">(</span><span class="n">odr_results</span><span class="p">,</span> <span class="n">model_function</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- ODR Fit Results ---
Beta: [2.90793948e+01 3.79005344e-03]
Beta Std Error: [1.43819054e+01 3.44593578e-03]
Beta Covariance: [[ 4.45754736e+00 -1.04404457e-03]
 [-1.04404457e-03  2.55904233e-07]]
Residual Variance: 46.40202017290558
Inverse Condition #: 0.10528095243077833
Reason(s) for Halting:
  Sum of squares convergence

--- Summary of Results ---
Parameter A: 29.07939 +/- 14.38191
  T-value: 2.02194313, P-value: 0.09912431
Parameter B: 0.00379 +/- 0.00345
  T-value: 1.09986189, P-value: 0.32150555

--- Model Fit Statistics ---

Number of Observations (n): 7
Number of Parameters (p): 2
Degrees of Freedom (n-p): 5

--- Goodness-of-Fit &amp; Error Metrics ---
Chi-Squared (from ODR): 232.0101
Reduced Chi-Squared (from ODR): 46.4020

--- Information Criteria ---
Maximum Log-Likelihood: -128.8702
AIC (Akaike Information Criterion): 261.7404
BIC (Bayesian Information Criterion): 261.6322
AICc (Corrected AIC): 264.7404

--- Comparison of Original and Predicted Data Points ---
  Original X    Predicted X (x_plus)    Original Y    Predicted Y (fit)
------------  ----------------------  ------------  -------------------
      0.0000                  0.0000      100.0000             100.0000
     19.0000                 30.8944       80.4000              81.8537
     45.0000                 59.8963       66.4000              68.7381
    104.0000                111.8151       50.1000              51.9935
    191.0000                183.3544       41.2000              37.9417
    294.0000                292.2881       28.5000              26.9181
    391.0000                392.0609       20.1000              21.9119
</pre></div>
</div>
<img alt="../_images/92e834811005b4f0eb32e81ded609903d5bdc0d7a187f069ad4af9af77058c5e.png" src="../_images/92e834811005b4f0eb32e81ded609903d5bdc0d7a187f069ad4af9af77058c5e.png" />
<img alt="../_images/13028c51f419ae764780964c339a6323e6f33bd67e9705dab4412933cf619620.png" src="../_images/13028c51f419ae764780964c339a6323e6f33bd67e9705dab4412933cf619620.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Y=0 Intercept Analysis ---
The root-finding algorithm did not converge to a solution.
Message from fsolve: The iteration is not making good progress, as measured by the 
 improvement from the last ten iterations.
</pre></div>
</div>
</div>
</div>
<p>Let’s change <code class="docutils literal notranslate"><span class="pre">sigma_x</span></code> to 3.0.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">model_function</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The custom function to approximate the data.</span>
<span class="sd">    f(x, A, B) = A_1 * (np.exp(-B_1 * x) - 1) + A * (np.exp(-B * x) - 1) + 100</span>
<span class="sd">    Note: The signature is now (beta, x) for scipy.odr.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">A_1</span> <span class="o">=</span> <span class="mf">56.769</span> <span class="c1"># obtained from Dataset 3 with sigma_x = 2.0, sigma_y = 0.5</span>
    <span class="n">B_1</span> <span class="o">=</span> <span class="mf">0.00988</span> <span class="c1"># obtained from Dataset 3 with sigma_x = 2.0, sigma_y = 0.5</span>

    <span class="c1"># A_1 = 56.747 # obtained from Dataset 3 with sigma_x = 3.0, sigma_y = 0.5</span>
    <span class="c1"># B_1 = 0.00991 # obtained from Dataset 3 with sigma_x = 3.0, sigma_y = 0.5</span>

    <span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="n">beta</span>
    
    <span class="k">return</span> <span class="n">A_1</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">B_1</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">A</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">B</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">100</span>

<span class="c1"># Dataset 2</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">191</span><span class="p">,</span> <span class="mi">294</span><span class="p">,</span> <span class="mi">391</span><span class="p">])</span>
<span class="n">y_obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mf">80.4</span><span class="p">,</span> <span class="mf">66.4</span><span class="p">,</span> <span class="mf">50.1</span><span class="p">,</span> <span class="mf">41.2</span><span class="p">,</span> <span class="mf">28.5</span><span class="p">,</span> <span class="mf">20.1</span><span class="p">])</span>
<span class="n">sigma_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">y_obs</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">sigma_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">initial_guess</span> <span class="o">=</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">]</span>

<span class="c1"># Analyze the curve fit and get results using ODR</span>
<span class="n">odr_results</span> <span class="o">=</span> <span class="n">analyze_odr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_obs</span><span class="p">,</span> <span class="n">sigma_x</span><span class="p">,</span> <span class="n">sigma_y</span><span class="p">,</span> <span class="n">model_function</span><span class="p">,</span> <span class="n">initial_guess</span><span class="p">)</span>

<span class="c1"># Print the metrics</span>
<span class="n">print_metrics</span><span class="p">(</span><span class="n">odr_results</span><span class="p">)</span>

<span class="c1"># Draw the curve fit plot</span>
<span class="n">draw_curve_fit</span><span class="p">(</span><span class="n">odr_results</span><span class="p">,</span> <span class="n">model_function</span><span class="p">)</span>

<span class="c1"># Plot predicted vs observed values</span>
<span class="n">plot_predicted_vs_observed</span><span class="p">(</span><span class="n">odr_results</span><span class="p">,</span> <span class="n">show_errors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Find the y=0 intercept</span>
<span class="n">find_y_intercept</span><span class="p">(</span><span class="n">odr_results</span><span class="p">,</span> <span class="n">model_function</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- ODR Fit Results ---
Beta: [3.73843185e+01 2.47485436e-03]
Beta Std Error: [2.72441362e+01 2.74418152e-03]
Beta Covariance: [[ 2.61587979e+01 -2.61599997e-03]
 [-2.61599997e-03  2.65397831e-07]]
Residual Variance: 28.374505629249352
Inverse Condition #: 0.04164089938749358
Reason(s) for Halting:
  Sum of squares convergence

--- Summary of Results ---
Parameter A: 37.38432 +/- 27.24414
  T-value: 1.37219687, P-value: 0.22836227
Parameter B: 0.00247 +/- 0.00274
  T-value: 0.90185519, P-value: 0.40847427

--- Model Fit Statistics ---

Number of Observations (n): 7
Number of Parameters (p): 2
Degrees of Freedom (n-p): 5

--- Goodness-of-Fit &amp; Error Metrics ---
Chi-Squared (from ODR): 141.8725
Reduced Chi-Squared (from ODR): 28.3745

--- Information Criteria ---
Maximum Log-Likelihood: -86.6397
AIC (Akaike Information Criterion): 177.2793
BIC (Bayesian Information Criterion): 177.1711
AICc (Corrected AIC): 180.2793

--- Comparison of Original and Predicted Data Points ---
  Original X    Predicted X (x_plus)    Original Y    Predicted Y (fit)
------------  ----------------------  ------------  -------------------
      0.0000                  0.0000      100.0000             100.0000
     19.0000                 33.1449       80.4000              81.2027
     45.0000                 64.2586       66.4000              67.8221
    104.0000                117.3554       50.1000              51.6135
    191.0000                180.5144       41.2000              39.3018
    294.0000                290.6060       28.5000              27.2729
    391.0000                392.7784       20.1000              21.1607
</pre></div>
</div>
<img alt="../_images/aa2f887779e513b8935ef8f319d95c177adf07d9fe67043b861660e2ee60ebad.png" src="../_images/aa2f887779e513b8935ef8f319d95c177adf07d9fe67043b861660e2ee60ebad.png" />
<img alt="../_images/699bd175eb89620a61a58b59411d6bcf80482e70adb11d49cff4034a7061a9e7.png" src="../_images/699bd175eb89620a61a58b59411d6bcf80482e70adb11d49cff4034a7061a9e7.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Y=0 Intercept Analysis ---
The root-finding algorithm did not converge to a solution.
Message from fsolve: The iteration is not making good progress, as measured by the 
 improvement from the last ten iterations.
</pre></div>
</div>
</div>
</div>
<p>Let’s change <code class="docutils literal notranslate"><span class="pre">sigma_y</span></code> to 1.0.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">model_function</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The custom function to approximate the data.</span>
<span class="sd">    f(x, A, B) = A_1 * (np.exp(-B_1 * x) - 1) + A * (np.exp(-B * x) - 1) + 100</span>
<span class="sd">    Note: The signature is now (beta, x) for scipy.odr.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">A_1</span> <span class="o">=</span> <span class="mf">56.769</span> <span class="c1"># obtained from Dataset 3 with sigma_x = 2.0, sigma_y = 0.5</span>
    <span class="n">B_1</span> <span class="o">=</span> <span class="mf">0.00988</span> <span class="c1"># obtained from Dataset 3 with sigma_x = 2.0, sigma_y = 0.5</span>

    <span class="c1"># A_1 = 56.747 # obtained from Dataset 3 with sigma_x = 3.0, sigma_y = 0.5</span>
    <span class="c1"># B_1 = 0.00991 # obtained from Dataset 3 with sigma_x = 3.0, sigma_y = 0.5</span>

    <span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="n">beta</span>
    
    <span class="k">return</span> <span class="n">A_1</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">B_1</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">A</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">B</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">100</span>

<span class="c1"># Dataset 2</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">191</span><span class="p">,</span> <span class="mi">294</span><span class="p">,</span> <span class="mi">391</span><span class="p">])</span>
<span class="n">y_obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mf">80.4</span><span class="p">,</span> <span class="mf">66.4</span><span class="p">,</span> <span class="mf">50.1</span><span class="p">,</span> <span class="mf">41.2</span><span class="p">,</span> <span class="mf">28.5</span><span class="p">,</span> <span class="mf">20.1</span><span class="p">])</span>
<span class="n">sigma_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">y_obs</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">sigma_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">initial_guess</span> <span class="o">=</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">]</span>

<span class="c1"># Analyze the curve fit and get results using ODR</span>
<span class="n">odr_results</span> <span class="o">=</span> <span class="n">analyze_odr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_obs</span><span class="p">,</span> <span class="n">sigma_x</span><span class="p">,</span> <span class="n">sigma_y</span><span class="p">,</span> <span class="n">model_function</span><span class="p">,</span> <span class="n">initial_guess</span><span class="p">)</span>

<span class="c1"># Print the metrics</span>
<span class="n">print_metrics</span><span class="p">(</span><span class="n">odr_results</span><span class="p">)</span>

<span class="c1"># Draw the curve fit plot</span>
<span class="n">draw_curve_fit</span><span class="p">(</span><span class="n">odr_results</span><span class="p">,</span> <span class="n">model_function</span><span class="p">)</span>

<span class="c1"># Plot predicted vs observed values</span>
<span class="n">plot_predicted_vs_observed</span><span class="p">(</span><span class="n">odr_results</span><span class="p">,</span> <span class="n">show_errors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Find the y=0 intercept</span>
<span class="n">find_y_intercept</span><span class="p">(</span><span class="n">odr_results</span><span class="p">,</span> <span class="n">model_function</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- ODR Fit Results ---
Beta: [2.49623811e+01 5.23264236e-03]
Beta Std Error: [9.07480094e+00 4.18366301e-03]
Beta Covariance: [[ 5.43573560e+00 -2.37618944e-03]
 [-2.37618944e-03  1.15530725e-06]]
Residual Variance: 15.150113669551942
Inverse Condition #: 0.10616159038968023
Reason(s) for Halting:
  Sum of squares convergence

--- Summary of Results ---
Parameter A: 24.96238 +/- 9.07480
  T-value: 2.75073594, P-value: 0.04027501
Parameter B: 0.00523 +/- 0.00418
  T-value: 1.25073228, P-value: 0.26637044

--- Model Fit Statistics ---

Number of Observations (n): 7
Number of Parameters (p): 2
Degrees of Freedom (n-p): 5

--- Goodness-of-Fit &amp; Error Metrics ---
Chi-Squared (from ODR): 75.7506
Reduced Chi-Squared (from ODR): 15.1501

--- Information Criteria ---
Maximum Log-Likelihood: -58.4307
AIC (Akaike Information Criterion): 120.8614
BIC (Bayesian Information Criterion): 120.7532
AICc (Corrected AIC): 123.8614

--- Comparison of Original and Predicted Data Points ---
  Original X    Predicted X (x_plus)    Original Y    Predicted Y (fit)
------------  ----------------------  ------------  -------------------
      0.0000                  0.0000      100.0000             100.0000
     19.0000                 28.8153       80.4000              82.4413
     45.0000                 56.3182       66.4000              69.4027
    104.0000                108.3166       50.1000              51.9000
    191.0000                185.4964       41.2000              36.8073
    294.0000                293.0900       28.5000              26.7912
    391.0000                391.6595       20.1000              22.6686
</pre></div>
</div>
<img alt="../_images/ddd851a0945cb07dabd313847d4a4539eb67152db115d9536f44e2225e51734c.png" src="../_images/ddd851a0945cb07dabd313847d4a4539eb67152db115d9536f44e2225e51734c.png" />
<img alt="../_images/6d7b7ba66ed0d1ac7a80479d14bc5082661ce88f936ec89a012aef3e26af910f.png" src="../_images/6d7b7ba66ed0d1ac7a80479d14bc5082661ce88f936ec89a012aef3e26af910f.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Y=0 Intercept Analysis ---
The root-finding algorithm did not converge to a solution.
Message from fsolve: The iteration is not making good progress, as measured by the 
 improvement from the last ten iterations.
</pre></div>
</div>
</div>
</div>
<p>Let’s exclude Point 5 as a potential outlier.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">model_function</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The custom function to approximate the data.</span>
<span class="sd">    f(x, A, B) = A_1 * (np.exp(-B_1 * x) - 1) + A * (np.exp(-B * x) - 1) + 100</span>
<span class="sd">    Note: The signature is now (beta, x) for scipy.odr.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">A_1</span> <span class="o">=</span> <span class="mf">56.769</span> <span class="c1"># obtained from Dataset 3 with sigma_x = 2.0, sigma_y = 0.5</span>
    <span class="n">B_1</span> <span class="o">=</span> <span class="mf">0.00988</span> <span class="c1"># obtained from Dataset 3 with sigma_x = 2.0, sigma_y = 0.5</span>

    <span class="c1"># A_1 = 56.747 # obtained from Dataset 3 with sigma_x = 3.0, sigma_y = 0.5</span>
    <span class="c1"># B_1 = 0.00991 # obtained from Dataset 3 with sigma_x = 3.0, sigma_y = 0.5</span>

    <span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="n">beta</span>
    
    <span class="k">return</span> <span class="n">A_1</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">B_1</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">A</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">B</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">100</span>

<span class="c1"># Dataset 2</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">294</span><span class="p">,</span> <span class="mi">391</span><span class="p">])</span>
<span class="n">y_obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mf">80.4</span><span class="p">,</span> <span class="mf">66.4</span><span class="p">,</span> <span class="mf">50.1</span><span class="p">,</span> <span class="mf">28.5</span><span class="p">,</span> <span class="mf">20.1</span><span class="p">])</span>
<span class="n">sigma_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">y_obs</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">sigma_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">initial_guess</span> <span class="o">=</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">]</span>

<span class="c1"># Analyze the curve fit and get results using ODR</span>
<span class="n">odr_results</span> <span class="o">=</span> <span class="n">analyze_odr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_obs</span><span class="p">,</span> <span class="n">sigma_x</span><span class="p">,</span> <span class="n">sigma_y</span><span class="p">,</span> <span class="n">model_function</span><span class="p">,</span> <span class="n">initial_guess</span><span class="p">)</span>

<span class="c1"># Print the metrics</span>
<span class="n">print_metrics</span><span class="p">(</span><span class="n">odr_results</span><span class="p">)</span>

<span class="c1"># Draw the curve fit plot</span>
<span class="n">draw_curve_fit</span><span class="p">(</span><span class="n">odr_results</span><span class="p">,</span> <span class="n">model_function</span><span class="p">)</span>

<span class="c1"># Plot predicted vs observed values</span>
<span class="n">plot_predicted_vs_observed</span><span class="p">(</span><span class="n">odr_results</span><span class="p">,</span> <span class="n">show_errors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Find the y=0 intercept</span>
<span class="n">find_y_intercept</span><span class="p">(</span><span class="n">odr_results</span><span class="p">,</span> <span class="n">model_function</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- ODR Fit Results ---
Beta: [2.16951689e+01 1.15330887e-02]
Beta Std Error: [2.34886926 0.00567341]
Beta Covariance: [[ 2.02484421e-01 -3.18387590e-04]
 [-3.18387590e-04  1.18130626e-06]]
Residual Variance: 27.247463231985694
Inverse Condition #: 0.06297193338287788
Reason(s) for Halting:
  Sum of squares convergence

--- Summary of Results ---
Parameter A: 21.69517 +/- 2.34887
  T-value: 9.23643103, P-value: 0.00076372
Parameter B: 0.01153 +/- 0.00567
  T-value: 2.03283131, P-value: 0.11185177

--- Model Fit Statistics ---

Number of Observations (n): 6
Number of Parameters (p): 2
Degrees of Freedom (n-p): 4

--- Goodness-of-Fit &amp; Error Metrics ---
Chi-Squared (from ODR): 108.9899
Reduced Chi-Squared (from ODR): 27.2475

--- Information Criteria ---
Maximum Log-Likelihood: -65.5222
AIC (Akaike Information Criterion): 135.0444
BIC (Bayesian Information Criterion): 134.6279
AICc (Corrected AIC): 139.0444

--- Comparison of Original and Predicted Data Points ---
  Original X    Predicted X (x_plus)    Original Y    Predicted Y (fit)
------------  ----------------------  ------------  -------------------
      0.0000                  0.0000      100.0000             100.0000
     19.0000                 26.5677       80.4000              81.1684
     45.0000                 52.1337       66.4000              67.3441
    104.0000                100.5793       50.1000              49.3527
    294.0000                292.0528       28.5000              25.4525
    391.0000                391.6600       20.1000              22.9573
</pre></div>
</div>
<img alt="../_images/2050ecfe6e8cefa65742ab5b3ab135e12a2ba3f89b3c567bba097ba4c1a6859e.png" src="../_images/2050ecfe6e8cefa65742ab5b3ab135e12a2ba3f89b3c567bba097ba4c1a6859e.png" />
<img alt="../_images/5e50a57f50c73ea0a1b105af199076626ea19c2ed42bf786d4f90e8a11e57eba.png" src="../_images/5e50a57f50c73ea0a1b105af199076626ea19c2ed42bf786d4f90e8a11e57eba.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Y=0 Intercept Analysis ---
The root-finding algorithm did not converge to a solution.
Message from fsolve: The iteration is not making good progress, as measured by the 
 improvement from the last ten iterations.
</pre></div>
</div>
</div>
</div>
<p>Let’s change <code class="docutils literal notranslate"><span class="pre">sigma_x</span></code> to 3.0 and <code class="docutils literal notranslate"><span class="pre">sigma_y</span></code> to 1.0</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">model_function</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The custom function to approximate the data.</span>
<span class="sd">    f(x, A, B) = A_1 * (np.exp(-B_1 * x) - 1) + A * (np.exp(-B * x) - 1) + 100</span>
<span class="sd">    Note: The signature is now (beta, x) for scipy.odr.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">A_1</span> <span class="o">=</span> <span class="mf">56.769</span> <span class="c1"># obtained from Dataset 3 with sigma_x = 2.0, sigma_y = 0.5</span>
    <span class="n">B_1</span> <span class="o">=</span> <span class="mf">0.00988</span> <span class="c1"># obtained from Dataset 3 with sigma_x = 2.0, sigma_y = 0.5</span>

    <span class="c1"># A_1 = 56.747 # obtained from Dataset 3 with sigma_x = 3.0, sigma_y = 0.5</span>
    <span class="c1"># B_1 = 0.00991 # obtained from Dataset 3 with sigma_x = 3.0, sigma_y = 0.5</span>

    <span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="n">beta</span>
    
    <span class="k">return</span> <span class="n">A_1</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">B_1</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">A</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">B</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">100</span>

<span class="c1"># Dataset 2</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">294</span><span class="p">,</span> <span class="mi">391</span><span class="p">])</span>
<span class="n">y_obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mf">80.4</span><span class="p">,</span> <span class="mf">66.4</span><span class="p">,</span> <span class="mf">50.1</span><span class="p">,</span> <span class="mf">28.5</span><span class="p">,</span> <span class="mf">20.1</span><span class="p">])</span>
<span class="n">sigma_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">y_obs</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">sigma_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">initial_guess</span> <span class="o">=</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">]</span>

<span class="c1"># Analyze the curve fit and get results using ODR</span>
<span class="n">odr_results</span> <span class="o">=</span> <span class="n">analyze_odr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_obs</span><span class="p">,</span> <span class="n">sigma_x</span><span class="p">,</span> <span class="n">sigma_y</span><span class="p">,</span> <span class="n">model_function</span><span class="p">,</span> <span class="n">initial_guess</span><span class="p">)</span>

<span class="c1"># Print the metrics</span>
<span class="n">print_metrics</span><span class="p">(</span><span class="n">odr_results</span><span class="p">)</span>

<span class="c1"># Draw the curve fit plot</span>
<span class="n">draw_curve_fit</span><span class="p">(</span><span class="n">odr_results</span><span class="p">,</span> <span class="n">model_function</span><span class="p">)</span>

<span class="c1"># Plot predicted vs observed values</span>
<span class="n">plot_predicted_vs_observed</span><span class="p">(</span><span class="n">odr_results</span><span class="p">,</span> <span class="n">show_errors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Find the y=0 intercept</span>
<span class="n">find_y_intercept</span><span class="p">(</span><span class="n">odr_results</span><span class="p">,</span> <span class="n">model_function</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- ODR Fit Results ---
Beta: [2.13210676e+01 1.31203682e-02]
Beta Std Error: [2.30224116 0.0060255 ]
Beta Covariance: [[ 6.62232423e-01 -1.03028283e-03]
 [-1.03028283e-03  4.53622235e-06]]
Residual Variance: 8.003707104987365
Inverse Condition #: 0.06202072835778165
Reason(s) for Halting:
  Sum of squares convergence

--- Summary of Results ---
Parameter A: 21.32107 +/- 2.30224
  T-value: 9.26100530, P-value: 0.00075595
Parameter B: 0.01312 +/- 0.00603
  T-value: 2.17747542, P-value: 0.09501228

--- Model Fit Statistics ---

Number of Observations (n): 6
Number of Parameters (p): 2
Degrees of Freedom (n-p): 4

--- Goodness-of-Fit &amp; Error Metrics ---
Chi-Squared (from ODR): 32.0148
Reduced Chi-Squared (from ODR): 8.0037

--- Information Criteria ---
Maximum Log-Likelihood: -33.6264
AIC (Akaike Information Criterion): 71.2527
BIC (Bayesian Information Criterion): 70.8362
AICc (Corrected AIC): 75.2527

--- Comparison of Original and Predicted Data Points ---
  Original X    Predicted X (x_plus)    Original Y    Predicted Y (fit)
------------  ----------------------  ------------  -------------------
      0.0000                  0.0000      100.0000             100.0000
     19.0000                 25.2074       80.4000              81.4807
     45.0000                 50.1006       66.4000              67.5641
    104.0000                100.3813       50.1000              48.6792
    294.0000                293.0027       28.5000              25.5059
    391.0000                391.3762       20.1000              23.2234
</pre></div>
</div>
<img alt="../_images/c5f132056314702acbcbd2fc3201473ebb4de71896bc2f73f14c9a2bd55bed0c.png" src="../_images/c5f132056314702acbcbd2fc3201473ebb4de71896bc2f73f14c9a2bd55bed0c.png" />
<img alt="../_images/bdb68ddb381df93f9be5fec9c9f6eba1a9b2ef1032fe68a3eaadffd5d7c3709f.png" src="../_images/bdb68ddb381df93f9be5fec9c9f6eba1a9b2ef1032fe68a3eaadffd5d7c3709f.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Y=0 Intercept Analysis ---
The root-finding algorithm did not converge to a solution.
Message from fsolve: The iteration is not making good progress, as measured by the 
 improvement from the last ten iterations.
</pre></div>
</div>
</div>
</div>
</section>
<section id="id2">
<h3>More than 2 parameters in the non-linear model<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<p>The standard deviations are too large, this result cannot be used:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">model_function</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The custom function to approximate the data.</span>
<span class="sd">    f(x; A, B) = A_1 * (np.exp(-B_1 * x) - 1) + A * (np.exp(-B * x) - 1) + 100</span>
<span class="sd">    Note: The signature is now (beta, x) for scipy.odr.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># A_1 = 56.769 # obtained from Dataset 3 with sigma_x = 2.0, sigma_y = 0.5</span>
    <span class="n">B_1</span> <span class="o">=</span> <span class="mf">0.00988</span> <span class="c1"># obtained from Dataset 3 with sigma_x = 2.0, sigma_y = 0.5</span>

    <span class="c1"># A_1 = 56.747 # obtained from Dataset 3 with sigma_x = 3.0, sigma_y = 0.5</span>
    <span class="c1"># B_1 = 0.00991 # obtained from Dataset 3 with sigma_x = 3.0, sigma_y = 0.5</span>

    <span class="n">A_1</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="n">beta</span>
    
    <span class="k">return</span> <span class="n">A_1</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">B_1</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">A</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">B</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">100</span>

<span class="c1"># Dataset 2</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">191</span><span class="p">,</span> <span class="mi">294</span><span class="p">,</span> <span class="mi">391</span><span class="p">])</span>
<span class="n">y_obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mf">80.4</span><span class="p">,</span> <span class="mf">66.4</span><span class="p">,</span> <span class="mf">50.1</span><span class="p">,</span> <span class="mf">41.2</span><span class="p">,</span> <span class="mf">28.5</span><span class="p">,</span> <span class="mf">20.1</span><span class="p">])</span>
<span class="n">sigma_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">y_obs</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">sigma_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">initial_guess</span> <span class="o">=</span> <span class="p">[</span><span class="mf">56.769</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">]</span>

<span class="c1"># Analyze the curve fit and get results using ODR</span>
<span class="n">odr_results</span> <span class="o">=</span> <span class="n">analyze_odr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_obs</span><span class="p">,</span> <span class="n">sigma_x</span><span class="p">,</span> <span class="n">sigma_y</span><span class="p">,</span> <span class="n">model_function</span><span class="p">,</span> <span class="n">initial_guess</span><span class="p">)</span>

<span class="c1"># Print the metrics</span>
<span class="n">print_metrics</span><span class="p">(</span><span class="n">odr_results</span><span class="p">)</span>

<span class="c1"># Draw the curve fit plot</span>
<span class="n">draw_curve_fit_simple</span><span class="p">(</span><span class="n">odr_results</span><span class="p">,</span> <span class="n">model_function</span><span class="p">)</span>

<span class="c1"># Plot predicted vs observed values</span>
<span class="n">plot_predicted_vs_observed</span><span class="p">(</span><span class="n">odr_results</span><span class="p">,</span> <span class="n">show_errors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Find the y=0 intercept</span>
<span class="n">find_y_intercept</span><span class="p">(</span><span class="n">odr_results</span><span class="p">,</span> <span class="n">model_function</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- ODR Fit Results ---
Beta: [ 7.30962166e+03 -7.23159984e+03  9.88632018e-03]
Beta Std Error: [1.01313162e+08 1.01313146e+08 8.85098695e-02]
Beta Covariance: [[ 5.16200872e+14 -5.16200794e+14 -4.50966782e+05]
 [-5.16200794e+14  5.16200717e+14  4.50966715e+05]
 [-4.50966782e+05  4.50966715e+05  3.93976572e-04]]
Residual Variance: 19.884423452995758
Inverse Condition #: 3.294825903501306e-10
Reason(s) for Halting:
  Sum of squares convergence

--- Summary of Results ---
Parameter A: 7309.62166 +/- 101313161.65532
  T-value: 0.00007215, P-value: 0.99994589
Parameter B: -7231.59984 +/- 101313146.44955
  T-value: -0.00007138, P-value: 0.99994647
Parameter C: 0.00989 +/- 0.08851
  T-value: 0.11169738, P-value: 0.91644400

--- Model Fit Statistics ---

Number of Observations (n): 7
Number of Parameters (p): 3
Degrees of Freedom (n-p): 4

--- Goodness-of-Fit &amp; Error Metrics ---
Chi-Squared (from ODR): 79.5377
Reduced Chi-Squared (from ODR): 19.8844

--- Information Criteria ---
Maximum Log-Likelihood: -60.3243
AIC (Akaike Information Criterion): 126.6485
BIC (Bayesian Information Criterion): 126.4863
AICc (Corrected AIC): 134.6485

--- Comparison of Original and Predicted Data Points ---
  Original X    Predicted X (x_plus)    Original Y    Predicted Y (fit)
------------  ----------------------  ------------  -------------------
      0.0000                  0.0000      100.0000             100.0000
     19.0000                 27.9061       80.4000              82.1672
     45.0000                 54.7196       66.4000              68.8729
    104.0000                106.1967       50.1000              51.0015
    191.0000                184.7947       41.2000              35.9069
    294.0000                293.3688       28.5000              27.0159
    391.0000                391.6571       20.1000              23.9793
</pre></div>
</div>
<img alt="../_images/7eb10eee9686c471d12258bb89ddf2f876fe597d56f666af11a2190db9e24288.png" src="../_images/7eb10eee9686c471d12258bb89ddf2f876fe597d56f666af11a2190db9e24288.png" />
<img alt="../_images/5f37d91721285de70e9a5065bb3cea58db8cde8e5b2410155bffb0cfeda454ad.png" src="../_images/5f37d91721285de70e9a5065bb3cea58db8cde8e5b2410155bffb0cfeda454ad.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Y=0 Intercept Analysis ---
The root-finding algorithm did not converge to a solution.
Message from fsolve: The iteration is not making good progress, as measured by the 
 improvement from the last ten iterations.
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./math"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="orthogonal-distance-regression.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Orthogonal Distance Regression</p>
      </div>
    </a>
    <a class="right-next"
       href="../physics/continuity-equation-01.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">The Continuity Equation</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#general-investigation-of-odr">General Investigation of ODR</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inverse-condition-number">Inverse Condition Number</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reason-s-for-halting-sum-of-squares-convergence">Reason(s) for Halting: Sum of Squares Convergence</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#predicted-values-of-x-and-y">Predicted values of x and y</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#general-methods-for-odr-analysis">General Methods for ODR Analysis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#usage-of-methods-dataset-3">Usage of Methods. Dataset 3</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#usage-of-methods-dataset-1">Usage of Methods. Dataset 1</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#improved-model-function">Improved model function</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#more-than-2-parameters-in-the-non-linear-model">More than 2 parameters in the non-linear model</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#usage-of-methods-dataset-2">Usage of Methods. Dataset 2</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Improved model function</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">More than 2 parameters in the non-linear model</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Vladyslav Yakovliev (Ukraine)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>